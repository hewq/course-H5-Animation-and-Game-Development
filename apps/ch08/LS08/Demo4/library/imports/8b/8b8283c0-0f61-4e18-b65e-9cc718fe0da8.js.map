{"version":3,"sources":["../../../../../../../../assets/frameworks/cocos2d-html5/extensions/gui/control-extension/assets/frameworks/cocos2d-html5/extensions/gui/control-extension/CCControl.js"],"names":["cc","CONTROL_EVENT_TOTAL_NUMBER","CONTROL_EVENT_TOUCH_DOWN","CONTROL_EVENT_TOUCH_DRAG_INSIDE","CONTROL_EVENT_TOUCH_DRAG_OUTSIDE","CONTROL_EVENT_TOUCH_DRAG_ENTER","CONTROL_EVENT_TOUCH_DRAG_EXIT","CONTROL_EVENT_TOUCH_UP_INSIDE","CONTROL_EVENT_TOUCH_UP_OUTSIDE","CONTROL_EVENT_TOUCH_CANCEL","CONTROL_EVENT_VALUECHANGED","CONTROL_STATE_NORMAL","CONTROL_STATE_HIGHLIGHTED","CONTROL_STATE_DISABLED","CONTROL_STATE_SELECTED","CONTROL_STATE_INITIAL","Control","Layer","extend","_isOpacityModifyRGB","_hasVisibleParents","_touchListener","_className","isOpacityModifyRGB","setOpacityModifyRGB","opacityModifyRGB","children","getChildren","i","len","length","selNode","_state","getState","_enabled","_selected","_highlighted","_dispatchTable","setEnabled","enabled","needsLayout","isEnabled","setSelected","selected","isSelected","setHighlighted","highlighted","isHighlighted","hasVisibleParents","parent","getParent","c","isVisible","ctor","prototype","call","_color","color","WHITE","init","listener","EventListener","create","event","TOUCH_ONE_BY_ONE","swallowTouches","onTouchBegan","bind","onTouchMoved","onTouchEnded","onTouchCancelled","onEnter","locListener","_isRegistered","eventManager","addListener","Node","sendActionsForControlEvents","controlEvents","invocationList","_dispatchListforControlEvent","j","inLen","invoke","addTargetWithActionForControlEvents","target","action","_addTargetWithActionForControlEvent","removeTargetWithActionForControlEvents","_removeTargetWithActionForControlEvent","getTouchLocation","touch","touchLocation","getLocation","convertToNodeSpace","isTouchInside","rectContainsPoint","getBoundingBox","_invocationWithTargetAndActionForControlEvent","controlEvent","toString","invocation","Invocation","eventInvocationList","push","bDeleteObjects","shouldBeRemoved","getTarget","getAction","arrayRemoveObject","_p","state","defineGetterSetter","retControl"],"mappings":"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","file":"CCControl.js","sourceRoot":"../../../../../../../../assets/frameworks/cocos2d-html5/extensions/gui/control-extension","sourcesContent":["/**\n * Copyright (c) 2008-2010 Ricardo Quesada\n * Copyright (c) 2011-2012 cocos2d-x.org\n * Copyright (c) 2013-2014 Chukong Technologies Inc.\n * Copyright 2011 Yannick Loriot.\n * http://yannickloriot.com\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n */\n\n/** Number of kinds of control event. */\ncc.CONTROL_EVENT_TOTAL_NUMBER = 9;\n\n/** Kinds of possible events for the control objects. */\ncc.CONTROL_EVENT_TOUCH_DOWN = 1 << 0;    // A touch-down event in the control.\ncc.CONTROL_EVENT_TOUCH_DRAG_INSIDE = 1 << 1;    // An event where a finger is dragged inside the bounds of the control.\ncc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE = 1 << 2;    // An event where a finger is dragged just outside the bounds of the control.\ncc.CONTROL_EVENT_TOUCH_DRAG_ENTER = 1 << 3;    // An event where a finger is dragged into the bounds of the control.\ncc.CONTROL_EVENT_TOUCH_DRAG_EXIT = 1 << 4;    // An event where a finger is dragged from within a control to outside its bounds.\ncc.CONTROL_EVENT_TOUCH_UP_INSIDE = 1 << 5;    // A touch-up event in the control where the finger is inside the bounds of the control.\ncc.CONTROL_EVENT_TOUCH_UP_OUTSIDE = 1 << 6;    // A touch-up event in the control where the finger is outside the bounds of the control.\ncc.CONTROL_EVENT_TOUCH_CANCEL = 1 << 7;    // A system event canceling the current touches for the control.\ncc.CONTROL_EVENT_VALUECHANGED = 1 << 8;    // A touch dragging or otherwise manipulating a control; causing it to emit a series of different values.\n\n/** The possible state for a control.  */\ncc.CONTROL_STATE_NORMAL = 1 << 0; // The normal; or default state of a controlæ¢©hat is; enabled but neither selected nor highlighted.\ncc.CONTROL_STATE_HIGHLIGHTED = 1 << 1; // Highlighted state of a control. A control enters this state when a touch down; drag inside or drag enter is performed. You can retrieve and set this value through the highlighted property.\ncc.CONTROL_STATE_DISABLED = 1 << 2; // Disabled state of a control. This state indicates that the control is currently disabled. You can retrieve and set this value through the enabled property.\ncc.CONTROL_STATE_SELECTED = 1 << 3;  // Selected state of a control. This state indicates that the control is currently selected. You can retrieve and set this value through the selected property.\ncc.CONTROL_STATE_INITIAL = 1 << 3;\n\n/**\n * CCControl is inspired by the UIControl API class from the UIKit library of\n * CocoaTouch. It provides a base class for control CCSprites such as CCButton\n * or CCSlider that convey user intent to the application.\n * The goal of CCControl is to define an interface and base implementation for\n * preparing action messages and initially dispatching them to their targets when\n * certain events occur.\n * To use the CCControl you have to subclass it.\n * @class\n * @extends cc.Layer\n *\n * @property {Number}   state       - <@readonly> The current control state: cc.CONTROL_STATE_NORMAL | cc.CONTROL_STATE_HIGHLIGHTED | cc.CONTROL_STATE_DISABLED | cc.CONTROL_STATE_SELECTED | cc.CONTROL_STATE_INITIAL\n * @property {Boolean}  enabled     - Indicate whether the control node is enbaled\n * @property {Boolean}  selected    - Indicate whether the control node is selected\n * @property {Boolean}  highlighted - Indicate whether the control node is highlighted\n */\ncc.Control = cc.Layer.extend(/** @lends cc.Control# */{\n    _isOpacityModifyRGB: false,\n    _hasVisibleParents: false,\n    _touchListener: null,\n    _className: \"Control\",\n\n    isOpacityModifyRGB: function () {\n        return this._isOpacityModifyRGB;\n    },\n    setOpacityModifyRGB: function (opacityModifyRGB) {\n        this._isOpacityModifyRGB = opacityModifyRGB;\n\n        var children = this.getChildren();\n        for (var i = 0, len = children.length; i < len; i++) {\n            var selNode = children[i];\n            if (selNode)\n                selNode.setOpacityModifyRGB(opacityModifyRGB);\n        }\n    },\n\n    /** The current control state constant. */\n    _state: cc.CONTROL_STATE_NORMAL,\n    getState: function () {\n        return this._state;\n    },\n\n    _enabled: false,\n    _selected: false,\n    _highlighted: false,\n\n    _dispatchTable: null,\n\n    /**\n     * Tells whether the control is enabled\n     * @param {Boolean} enabled\n     */\n    setEnabled: function (enabled) {\n        this._enabled = enabled;\n        this._state = enabled ? cc.CONTROL_STATE_NORMAL : cc.CONTROL_STATE_DISABLED;\n\n        this.needsLayout();\n    },\n    isEnabled: function () {\n        return this._enabled;\n    },\n\n    /**\n     * A Boolean value that determines the control selected state.\n     * @param {Boolean} selected\n     */\n    setSelected: function (selected) {\n        this._selected = selected;\n        this.needsLayout();\n    },\n    isSelected: function () {\n        return this._selected;\n    },\n\n    /**\n     *  A Boolean value that determines whether the control is highlighted.\n     * @param {Boolean} highlighted\n     */\n    setHighlighted: function (highlighted) {\n        this._highlighted = highlighted;\n        this.needsLayout();\n    },\n    isHighlighted: function () {\n        return this._highlighted;\n    },\n\n    hasVisibleParents: function () {\n        var parent = this.getParent();\n        for (var c = parent; c != null; c = c.getParent()) {\n            if (!c.isVisible())\n                return false;\n        }\n        return true;\n    },\n\n    ctor: function () {\n        cc.Layer.prototype.ctor.call(this);\n        this._dispatchTable = {};\n        this._color = cc.color.WHITE;\n    },\n\n    init: function () {\n        // Initialise instance variables\n        this._state = cc.CONTROL_STATE_NORMAL;\n        this._enabled = true;\n        this._selected = false;\n        this._highlighted = false;\n\n        var listener = cc.EventListener.create({\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\n            swallowTouches: true\n        });\n        if (this.onTouchBegan)\n            listener.onTouchBegan = this.onTouchBegan.bind(this);\n        if (this.onTouchMoved)\n            listener.onTouchMoved = this.onTouchMoved.bind(this);\n        if (this.onTouchEnded)\n            listener.onTouchEnded = this.onTouchEnded.bind(this);\n        if (this.onTouchCancelled)\n            listener.onTouchCancelled = this.onTouchCancelled.bind(this);\n        this._touchListener = listener;\n        return true;\n    },\n\n    onEnter: function () {\n        var locListener = this._touchListener;\n        if (!locListener._isRegistered())\n            cc.eventManager.addListener(locListener, this);\n        cc.Node.prototype.onEnter.call(this);\n    },\n\n    /**\n     * Sends action messages for the given control events.\n     * which action messages are sent. See \"CCControlEvent\" for bitmask constants.\n     * @param {Number} controlEvents A bitmask whose set flags specify the control events for\n     */\n    sendActionsForControlEvents: function (controlEvents) {\n        // For each control events\n        for (var i = 0, len = cc.CONTROL_EVENT_TOTAL_NUMBER; i < len; i++) {\n            // If the given controlEvents bitmask contains the curent event\n            if ((controlEvents & (1 << i))) {\n                // Call invocations\n                // <CCInvocation*>\n                var invocationList = this._dispatchListforControlEvent(1 << i);\n                for (var j = 0, inLen = invocationList.length; j < inLen; j++) {\n                    invocationList[j].invoke(this);\n                }\n            }\n        }\n    },\n\n    /**\n     * <p>\n     * Adds a target and action for a particular event (or events) to an internal                         <br/>\n     * dispatch table.                                                                                    <br/>\n     * The action message may optionally include the sender and the event as                              <br/>\n     * parameters, in that order.                                                                         <br/>\n     * When you call this method, target is not retained.\n     * </p>\n     * @param {Object} target The target object that is, the object to which the action message is sent. It cannot be nil. The target is not retained.\n     * @param {function} action A selector identifying an action message. It cannot be NULL.\n     * @param {Number} controlEvents A bitmask specifying the control events for which the action message is sent. See \"CCControlEvent\" for bitmask constants.\n     */\n    addTargetWithActionForControlEvents: function (target, action, controlEvents) {\n        // For each control events\n        for (var i = 0, len = cc.CONTROL_EVENT_TOTAL_NUMBER; i < len; i++) {\n            // If the given controlEvents bit mask contains the current event\n            if ((controlEvents & (1 << i)))\n                this._addTargetWithActionForControlEvent(target, action, 1 << i);\n        }\n    },\n\n    /**\n     * Removes a target and action for a particular event (or events) from an internal dispatch table.\n     *\n     * @param {Object} target The target object that is, the object to which the action message is sent. Pass nil to remove all targets paired with action and the specified control events.\n     * @param {function} action A selector identifying an action message. Pass NULL to remove all action messages paired with target.\n     * @param {Number} controlEvents A bitmask specifying the control events associated with target and action. See \"CCControlEvent\" for bitmask constants.\n     */\n    removeTargetWithActionForControlEvents: function (target, action, controlEvents) {\n        // For each control events\n        for (var i = 0, len = cc.CONTROL_EVENT_TOTAL_NUMBER; i < len; i++) {\n            // If the given controlEvents bitmask contains the current event\n            if ((controlEvents & (1 << i)))\n                this._removeTargetWithActionForControlEvent(target, action, 1 << i);\n        }\n    },\n\n    /**\n     * Returns a point corresponding to the touh location converted into the\n     * control space coordinates.\n     * @param {cc.Touch} touch A CCTouch object that represents a touch.\n     */\n    getTouchLocation: function (touch) {\n        var touchLocation = touch.getLocation();                      // Get the touch position\n        return this.convertToNodeSpace(touchLocation);  // Convert to the node space of this class\n    },\n\n    /**\n     * Returns a boolean value that indicates whether a touch is inside the bounds of the receiver. The given touch must be relative to the world.\n     *\n     * @param {cc.Touch} touch A cc.Touch object that represents a touch.\n     * @return {Boolean} YES whether a touch is inside the receiver's rect.\n     */\n    isTouchInside: function (touch) {\n        var touchLocation = touch.getLocation(); // Get the touch position\n        touchLocation = this.getParent().convertToNodeSpace(touchLocation);\n        return cc.rectContainsPoint(this.getBoundingBox(), touchLocation);\n    },\n\n    /**\n     * <p>\n     * Returns an cc.Invocation object able to construct messages using a given                             <br/>\n     * target-action pair. (The invocation may optionally include the sender and                            <br/>\n     * the event as parameters, in that order)\n     * </p>\n     * @param {Object} target The target object.\n     * @param {function} action A selector identifying an action message.\n     * @param {Number} controlEvent A control events for which the action message is sent. See \"CCControlEvent\" for constants.\n     *\n     * @return {cc.Invocation} an CCInvocation object able to construct messages using a given target-action pair.\n     */\n    _invocationWithTargetAndActionForControlEvent: function (target, action, controlEvent) {\n        return null;\n    },\n\n    /**\n     * Returns the cc.Invocation list for the given control event. If the list does not exist, it'll create an empty array before returning it.\n     *\n     * @param {Number} controlEvent A control events for which the action message is sent. See \"CCControlEvent\" for constants.\n     * @return {cc.Invocation} the cc.Invocation list for the given control event.\n     */\n    _dispatchListforControlEvent: function (controlEvent) {\n        controlEvent = controlEvent.toString();\n        // If the invocation list does not exist for the  dispatch table, we create it\n        if (!this._dispatchTable[controlEvent])\n            this._dispatchTable[controlEvent] = [];\n        return this._dispatchTable[controlEvent];\n    },\n\n    /**\n     * Adds a target and action for a particular event to an internal dispatch\n     * table.\n     * The action message may optionally include the sender and the event as\n     * parameters, in that order.\n     * When you call this method, target is not retained.\n     *\n     * @param target The target object that is, the object to which the action\n     * message is sent. It cannot be nil. The target is not retained.\n     * @param action A selector identifying an action message. It cannot be NULL.\n     * @param controlEvent A control event for which the action message is sent.\n     * See \"CCControlEvent\" for constants.\n     */\n    _addTargetWithActionForControlEvent: function (target, action, controlEvent) {\n        // Create the invocation object\n        var invocation = new cc.Invocation(target, action, controlEvent);\n\n        // Add the invocation into the dispatch list for the given control event\n        var eventInvocationList = this._dispatchListforControlEvent(controlEvent);\n        eventInvocationList.push(invocation);\n    },\n\n    /**\n     * Removes a target and action for a particular event from an internal dispatch table.\n     *\n     * @param {Object} target The target object that is, the object to which the action message is sent. Pass nil to remove all targets paired with action and the specified control events.\n     * @param {function} action A selector identifying an action message. Pass NULL to remove all action messages paired with target.\n     * @param {Number} controlEvent A control event for which the action message is sent. See \"CCControlEvent\" for constants.\n     */\n    _removeTargetWithActionForControlEvent: function (target, action, controlEvent) {\n        // Retrieve all invocations for the given control event\n        //<CCInvocation*>\n        var eventInvocationList = this._dispatchListforControlEvent(controlEvent);\n\n        //remove all invocations if the target and action are null\n        //TODO: should the invocations be deleted, or just removed from the array? Won't that cause issues if you add a single invocation for multiple events?\n        var bDeleteObjects = true;\n        if (!target && !action) {\n            //remove objects\n            eventInvocationList.length = 0;\n        } else {\n            //normally we would use a predicate, but this won't work here. Have to do it manually\n            for (var i = 0; i < eventInvocationList.length;) {\n                var invocation = eventInvocationList[i];\n                var shouldBeRemoved = true;\n                if (target)\n                    shouldBeRemoved = (target === invocation.getTarget());\n                if (action)\n                    shouldBeRemoved = (shouldBeRemoved && (action === invocation.getAction()));\n                // Remove the corresponding invocation object\n                if (shouldBeRemoved)\n                    cc.arrayRemoveObject(eventInvocationList, invocation);\n                else\n                    i++;\n            }\n        }\n    },\n\n    /**\n     * Updates the control layout using its current internal state.\n     */\n    needsLayout: function () {\n    }\n});\n\nvar _p = cc.Control.prototype;\n\n// Extended properties\n/** @expose */\n_p.state;\ncc.defineGetterSetter(_p, \"state\", _p.getState);\n/** @expose */\n_p.enabled;\ncc.defineGetterSetter(_p, \"enabled\", _p.isEnabled, _p.setEnabled);\n/** @expose */\n_p.selected;\ncc.defineGetterSetter(_p, \"selected\", _p.isSelected, _p.setSelected);\n/** @expose */\n_p.highlighted;\ncc.defineGetterSetter(_p, \"highlighted\", _p.isHighlighted, _p.setHighlighted);\n\n_p = null;\n\ncc.Control.create = function () {\n    var retControl = new cc.Control();\n    if (retControl && retControl.init())\n        return retControl;\n    return null;\n};\n\n"]}