{"version":3,"sources":["../../../../../../../../assets/frameworks/cocos2d-html5/extensions/ccui/base-classes/assets/frameworks/cocos2d-html5/extensions/ccui/base-classes/UIScale9Sprite.js"],"names":["dataPool","_pool","_lengths","put","data","length","push","sort","get","id","i","pop","undefined","FIX_ARTIFACTS_BY_STRECHING_TEXEL","cc","cornerId","webgl","simpleQuadGenerator","_rebuildQuads_base","sprite","spriteFrame","contentSize","isTrimmedContentSize","vertices","_vertices","wt","_renderCmd","_worldTransform","l","b","r","t","width","height","originalSize","_originalSize","rect","_rect","offset","_offset","scaleX","scaleY","trimmLeft","x","trimmRight","trimmedBottom","y","trimmedTop","Float32Array","a","c","tx","d","ty","_uvsDirty","_calculateUVs","_vertCount","uvs","_uvs","atlasWidth","_texture","_pixelsWide","atlasHeight","_pixelsHigh","textureRect","rectPointsToPixels","texelCorrect","_rotated","scale9QuadGenerator","Array","insetLeft","insetRight","insetTop","insetBottom","leftWidth","centerWidth","rightWidth","topHeight","centerHeight","bottomHeight","preferSize","sizableWidth","sizableHeight","xScale","yScale","row","col","scale","contentScaleFactor","u","v","ccui","Scale9Sprite","Node","extend","_spriteFrame","_scale9Image","_insetLeft","_insetRight","_insetTop","_insetBottom","_blendFunc","_renderingType","_brightState","_opacityModifyRGB","_rawVerts","_rawUvs","_quadsDirty","_isTriangle","_isTrimmedContentSize","_textureLoaded","_flippedX","_flippedY","_className","ctor","file","rectOrCapInsets","capInsets","prototype","call","_loader","Sprite","LoadManager","setState","BlendFunc","_alphaPremultiplied","setAnchorPoint","p","SpriteFrame","initWithSpriteFrame","frame","spriteFrameCache","getSpriteFrame","initWithFile","_renderType","game","RENDER_TYPE_WEBGL","textureLoaded","getCapInsets","_capInsetsInternal","_asyncSetCapInsets","removeEventListener","setCapInsets","_cacheCapInsets","loaded","addEventListener","_updateCapInsets","_rectEqualToZero","_contentSize","Rect","arguments","Error","texture","textureCache","getTextureForKey","addImage","locLoaded","isLoaded","clear","once","dispatchEvent","textureSize","getContentSize","setTexture","updateWithBatchNode","batchNode","originalRect","rotated","getTexture","setSpriteFrame","initWithSpriteFrameName","spriteFrameName","log","_updateBlendFunc","blendFunc","hasPremultipliedAlpha","src","ONE","dst","BLEND_DST","SRC_ALPHA","setOpacityModifyRGB","value","_setColorDirty","isOpacityModifyRGB","self","onResourceDataLoaded","sizeEqualToSize","size","setContentSize","setDirtyFlag","_dirtyFlags","contentDirty","renderer","childrenOrderDirty","setBlendFunc","BLEND_SRC","getBlendFunc","setPreferredSize","preferredSize","getPreferredSize","RenderingType","SIMPLE","_setWidth","_setHeight","state","getState","setRenderingType","type","getRenderingType","setInsetLeft","getInsetLeft","setInsetTop","getInsetTop","setInsetRight","getInsetRight","setInsetBottom","getInsetBottom","_rebuildQuads","SLICED","error","_createRenderCmd","RENDER_TYPE_CANVAS","CanvasRenderCmd","WebGLRenderCmd","_p","EventHelper","apply","defineGetterSetter","create","createWithSpriteFrame","createWithSpriteFrameName","POSITIONS_CENTRE","POSITIONS_TOP","POSITIONS_LEFT","POSITIONS_RIGHT","POSITIONS_BOTTOM","POSITIONS_TOPRIGHT","POSITIONS_TOPLEFT","POSITIONS_BOTTOMRIGHT","NORMAL","GRAY"],"mappings":";;;;;;AAAA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,CAAC,YAAY;;AAEb,QAAIA,WAAW;AACXC,eAAO,EADI;AAEXC,kBAAU,EAFC;AAGXC,aAAK,aAAUC,IAAV,EAAgB;AACjB,gBAAIC,SAASD,KAAKC,MAAlB;AACA,gBAAI,CAAC,KAAKJ,KAAL,CAAWI,MAAX,CAAL,EAAyB;AACrB,qBAAKJ,KAAL,CAAWI,MAAX,IAAqB,CAACD,IAAD,CAArB;AACA,qBAAKF,QAAL,CAAcI,IAAd,CAAmBD,MAAnB;AACA,qBAAKH,QAAL,CAAcK,IAAd;AACH,aAJD,MAKK;AACD,qBAAKN,KAAL,CAAWI,MAAX,EAAmBC,IAAnB,CAAwBF,IAAxB;AACH;AACJ,SAbU;AAcXI,aAAK,aAAUH,MAAV,EAAkB;AACnB,gBAAII,EAAJ;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKR,QAAL,CAAcG,MAAlC,EAA0CK,GAA1C,EAA+C;AAC3C,oBAAI,KAAKR,QAAL,CAAcQ,CAAd,KAAoBL,MAAxB,EAAgC;AAC5BI,yBAAK,KAAKP,QAAL,CAAcQ,CAAd,CAAL;AACA;AACH;AACJ;AACD,gBAAID,EAAJ,EAAQ;AACJ,uBAAO,KAAKR,KAAL,CAAWQ,EAAX,EAAeE,GAAf,EAAP;AACH,aAFD,MAGK;AACD,uBAAOC,SAAP;AACH;AACJ;AA5BU,KAAf;;AA+BA,QAAIC,mCAAmCC,GAAGD,gCAA1C;AAAA,QAA4EE,WAAW,EAAvF;AAAA,QAA2FC,KAA3F;;AAGA,QAAIC,sBAAsB;AACtBC,4BAAoB,4BAAUC,MAAV,EAAkBC,WAAlB,EAA+BC,WAA/B,EAA4CC,oBAA5C,EAAkE;AAClF;AACA,gBAAIC,WAAWJ,OAAOK,SAAtB;AAAA,gBACIC,KAAKN,OAAOO,UAAP,CAAkBC,eAD3B;AAAA,gBAEIC,CAFJ;AAAA,gBAEOC,CAFP;AAAA,gBAEUC,CAFV;AAAA,gBAEaC,CAFb;AAGA,gBAAIT,oBAAJ,EAA0B;AACtBM,oBAAI,CAAJ;AACAC,oBAAI,CAAJ;AACAC,oBAAIT,YAAYW,KAAhB;AACAD,oBAAIV,YAAYY,MAAhB;AACH,aALD,MAKO;AACH,oBAAIC,eAAed,YAAYe,aAA/B;AACA,oBAAIC,OAAOhB,YAAYiB,KAAvB;AACA,oBAAIC,SAASlB,YAAYmB,OAAzB;AACA,oBAAIC,SAASnB,YAAYW,KAAZ,GAAoBE,aAAaF,KAA9C;AACA,oBAAIS,SAASpB,YAAYY,MAAZ,GAAqBC,aAAaD,MAA/C;AACA,oBAAIS,YAAYJ,OAAOK,CAAP,GAAW,CAACT,aAAaF,KAAb,GAAqBI,KAAKJ,KAA3B,IAAoC,CAA/D;AACA,oBAAIY,aAAaN,OAAOK,CAAP,GAAW,CAACT,aAAaF,KAAb,GAAqBI,KAAKJ,KAA3B,IAAoC,CAAhE;AACA,oBAAIa,gBAAgBP,OAAOQ,CAAP,GAAW,CAACZ,aAAaD,MAAb,GAAsBG,KAAKH,MAA5B,IAAsC,CAArE;AACA,oBAAIc,aAAaT,OAAOQ,CAAP,GAAW,CAACZ,aAAaD,MAAb,GAAsBG,KAAKH,MAA5B,IAAsC,CAAlE;;AAEAL,oBAAIc,YAAYF,MAAhB;AACAX,oBAAIgB,gBAAgBJ,MAApB;AACAX,oBAAIT,YAAYW,KAAZ,GAAoBY,aAAaJ,MAArC;AACAT,oBAAIV,YAAYY,MAAZ,GAAqBc,aAAaN,MAAtC;AACH;;AAED,gBAAIlB,SAASlB,MAAT,GAAkB,CAAtB,EAAyB;AACrBL,yBAASG,GAAT,CAAaoB,QAAb;AACAA,2BAAWvB,SAASQ,GAAT,CAAa,CAAb,KAAmB,IAAIwC,YAAJ,CAAiB,CAAjB,CAA9B;AACA7B,uBAAOK,SAAP,GAAmBD,QAAnB;AACH;AACD;AACA,gBAAIP,KAAJ,EAAW;AACPO,yBAAS,CAAT,IAAcK,IAAIH,GAAGwB,CAAP,GAAWpB,IAAIJ,GAAGyB,CAAlB,GAAsBzB,GAAG0B,EAAvC;AACA5B,yBAAS,CAAT,IAAcK,IAAIH,GAAGI,CAAP,GAAWA,IAAIJ,GAAG2B,CAAlB,GAAsB3B,GAAG4B,EAAvC;AACA9B,yBAAS,CAAT,IAAcO,IAAIL,GAAGwB,CAAP,GAAWpB,IAAIJ,GAAGyB,CAAlB,GAAsBzB,GAAG0B,EAAvC;AACA5B,yBAAS,CAAT,IAAcO,IAAIL,GAAGI,CAAP,GAAWA,IAAIJ,GAAG2B,CAAlB,GAAsB3B,GAAG4B,EAAvC;AACA9B,yBAAS,CAAT,IAAcK,IAAIH,GAAGwB,CAAP,GAAWlB,IAAIN,GAAGyB,CAAlB,GAAsBzB,GAAG0B,EAAvC;AACA5B,yBAAS,CAAT,IAAcK,IAAIH,GAAGI,CAAP,GAAWE,IAAIN,GAAG2B,CAAlB,GAAsB3B,GAAG4B,EAAvC;AACA9B,yBAAS,CAAT,IAAcO,IAAIL,GAAGwB,CAAP,GAAWlB,IAAIN,GAAGyB,CAAlB,GAAsBzB,GAAG0B,EAAvC;AACA5B,yBAAS,CAAT,IAAcO,IAAIL,GAAGI,CAAP,GAAWE,IAAIN,GAAG2B,CAAlB,GAAsB3B,GAAG4B,EAAvC;AACH,aATD,MAUK;AACD9B,yBAAS,CAAT,IAAcK,CAAd;AACAL,yBAAS,CAAT,IAAcM,CAAd;AACAN,yBAAS,CAAT,IAAcO,CAAd;AACAP,yBAAS,CAAT,IAAcM,CAAd;AACAN,yBAAS,CAAT,IAAcK,CAAd;AACAL,yBAAS,CAAT,IAAcQ,CAAd;AACAR,yBAAS,CAAT,IAAcO,CAAd;AACAP,yBAAS,CAAT,IAAcQ,CAAd;AACH;;AAEDhB,qBAAS,CAAT,IAAc,CAAd;AACAA,qBAAS,CAAT,IAAc,CAAd;AACAA,qBAAS,CAAT,IAAc,CAAd;AACAA,qBAAS,CAAT,IAAc,CAAd;;AAEA;AACA,gBAAII,OAAOmC,SAAX,EAAsB;AAClB,qBAAKC,aAAL,CAAmBpC,MAAnB,EAA2BC,WAA3B;AACH;;AAEDD,mBAAOqC,UAAP,GAAoB,CAApB;AACH,SAlEqB;;AAoEtBD,uBAAe,uBAAUpC,MAAV,EAAkBC,WAAlB,EAA+B;AAC1C,gBAAIqC,MAAMtC,OAAOuC,IAAjB;AACA,gBAAIC,aAAavC,YAAYwC,QAAZ,CAAqBC,WAAtC;AACA,gBAAIC,cAAc1C,YAAYwC,QAAZ,CAAqBG,WAAvC;AACA,gBAAIC,cAAc5C,YAAYiB,KAA9B;AACA2B,0BAAclD,GAAGmD,kBAAH,CAAsBD,WAAtB,CAAd;;AAEA,gBAAIP,IAAIpD,MAAJ,GAAa,CAAjB,EAAoB;AAChBL,yBAASG,GAAT,CAAasD,GAAb;AACAA,sBAAMzD,SAASQ,GAAT,CAAa,CAAb,KAAmB,IAAIwC,YAAJ,CAAiB,CAAjB,CAAzB;AACA7B,uBAAOuC,IAAP,GAAcD,GAAd;AACH;;AAED;AACA,gBAAI7B,CAAJ,EAAOC,CAAP,EAAUC,CAAV,EAAaC,CAAb;AACA,gBAAImC,eAAerD,mCAAmC,GAAnC,GAAyC,CAA5D;;AAEA,gBAAIO,YAAY+C,QAAhB,EAA0B;AACtBvC,oBAAI,CAACoC,YAAYrB,CAAZ,GAAgBuB,YAAjB,IAAiCP,UAArC;AACA9B,oBAAI,CAACmC,YAAYlB,CAAZ,GAAgBkB,YAAYhC,KAA5B,GAAoCkC,YAArC,IAAqDJ,WAAzD;AACAhC,oBAAI,CAACkC,YAAYrB,CAAZ,GAAgBqB,YAAY/B,MAA5B,GAAqCiC,YAAtC,IAAsDP,UAA1D;AACA5B,oBAAI,CAACiC,YAAYlB,CAAZ,GAAgBoB,YAAjB,IAAiCJ,WAArC;AACAL,oBAAI,CAAJ,IAAS7B,CAAT,CAAY6B,IAAI,CAAJ,IAAS1B,CAAT;AACZ0B,oBAAI,CAAJ,IAAS7B,CAAT,CAAY6B,IAAI,CAAJ,IAAS5B,CAAT;AACZ4B,oBAAI,CAAJ,IAAS3B,CAAT,CAAY2B,IAAI,CAAJ,IAAS1B,CAAT;AACZ0B,oBAAI,CAAJ,IAAS3B,CAAT,CAAY2B,IAAI,CAAJ,IAAS5B,CAAT;AACf,aATD,MAUK;AACDD,oBAAI,CAACoC,YAAYrB,CAAZ,GAAgBuB,YAAjB,IAAiCP,UAArC;AACA9B,oBAAI,CAACmC,YAAYlB,CAAZ,GAAgBkB,YAAY/B,MAA5B,GAAqCiC,YAAtC,IAAsDJ,WAA1D;AACAhC,oBAAI,CAACkC,YAAYrB,CAAZ,GAAgBqB,YAAYhC,KAA5B,GAAoCkC,YAArC,IAAqDP,UAAzD;AACA5B,oBAAI,CAACiC,YAAYlB,CAAZ,GAAgBoB,YAAjB,IAAiCJ,WAArC;AACAL,oBAAI,CAAJ,IAAS7B,CAAT,CAAY6B,IAAI,CAAJ,IAAS5B,CAAT;AACZ4B,oBAAI,CAAJ,IAAS3B,CAAT,CAAY2B,IAAI,CAAJ,IAAS5B,CAAT;AACZ4B,oBAAI,CAAJ,IAAS7B,CAAT,CAAY6B,IAAI,CAAJ,IAAS1B,CAAT;AACZ0B,oBAAI,CAAJ,IAAS3B,CAAT,CAAY2B,IAAI,CAAJ,IAAS1B,CAAT;AACf;AACJ;AAzGqB,KAA1B;;AA4GA,QAAIqC,sBAAsB;AACtBzB,WAAG,IAAI0B,KAAJ,CAAU,CAAV,CADmB;AAEtBvB,WAAG,IAAIuB,KAAJ,CAAU,CAAV,CAFmB;AAGtBnD,4BAAoB,4BAAUC,MAAV,EAAkBC,WAAlB,EAA+BC,WAA/B,EAA4CiD,SAA5C,EAAuDC,UAAvD,EAAmEC,QAAnE,EAA6EC,WAA7E,EAA0F;AAC1G;AACA,gBAAIlD,WAAWJ,OAAOK,SAAtB;AACA,gBAAIC,KAAKN,OAAOO,UAAP,CAAkBC,eAA3B;AACA,gBAAI+C,SAAJ,EAAeC,WAAf,EAA4BC,UAA5B;AACA,gBAAIC,SAAJ,EAAeC,YAAf,EAA6BC,YAA7B;AACA,gBAAI3C,OAAOhB,YAAYiB,KAAvB;;AAEAqC,wBAAYJ,SAAZ;AACAM,yBAAaL,UAAb;AACAI,0BAAcvC,KAAKJ,KAAL,GAAa0C,SAAb,GAAyBE,UAAvC;AACAC,wBAAYL,QAAZ;AACAO,2BAAeN,WAAf;AACAK,2BAAe1C,KAAKH,MAAL,GAAc4C,SAAd,GAA0BE,YAAzC;;AAEA,gBAAIC,aAAa3D,WAAjB;AACA,gBAAI4D,eAAeD,WAAWhD,KAAX,GAAmB0C,SAAnB,GAA+BE,UAAlD;AACA,gBAAIM,gBAAgBF,WAAW/C,MAAX,GAAoB4C,SAApB,GAAgCE,YAApD;AACA,gBAAII,SAASH,WAAWhD,KAAX,IAAoB0C,YAAYE,UAAhC,CAAb;AACA,gBAAIQ,SAASJ,WAAW/C,MAAX,IAAqB4C,YAAYE,YAAjC,CAAb;AACAI,qBAASA,SAAS,CAAT,GAAa,CAAb,GAAiBA,MAA1B;AACAC,qBAASA,SAAS,CAAT,GAAa,CAAb,GAAiBA,MAA1B;AACAH,2BAAeA,eAAe,CAAf,GAAmB,CAAnB,GAAuBA,YAAtC;AACAC,4BAAgBA,gBAAgB,CAAhB,GAAoB,CAApB,GAAwBA,aAAxC;AACA,gBAAIvC,IAAI,KAAKA,CAAb;AACA,gBAAIG,IAAI,KAAKA,CAAb;AACAH,cAAE,CAAF,IAAO,CAAP;AACAA,cAAE,CAAF,IAAO+B,YAAYS,MAAnB;AACAxC,cAAE,CAAF,IAAOA,EAAE,CAAF,IAAOsC,YAAd;AACAtC,cAAE,CAAF,IAAOqC,WAAWhD,KAAlB;AACAc,cAAE,CAAF,IAAO,CAAP;AACAA,cAAE,CAAF,IAAOiC,eAAeK,MAAtB;AACAtC,cAAE,CAAF,IAAOA,EAAE,CAAF,IAAOoC,aAAd;AACApC,cAAE,CAAF,IAAOkC,WAAW/C,MAAlB;;AAEA,gBAAIV,SAASlB,MAAT,GAAkB,EAAtB,EAA0B;AACtBL,yBAASG,GAAT,CAAaoB,QAAb;AACAA,2BAAWvB,SAASQ,GAAT,CAAa,EAAb,KAAoB,IAAIwC,YAAJ,CAAiB,EAAjB,CAA/B;AACA7B,uBAAOK,SAAP,GAAmBD,QAAnB;AACH;AACD,gBAAIe,SAAS,CAAb;AAAA,gBAAgB+C,GAAhB;AAAA,gBAAqBC,GAArB;AACA,gBAAItE,KAAJ,EAAW;AACP,qBAAKqE,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B,yBAAKC,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B/D,iCAASe,MAAT,IAAmBK,EAAE2C,GAAF,IAAS7D,GAAGwB,CAAZ,GAAgBH,EAAEuC,GAAF,IAAS5D,GAAGyB,CAA5B,GAAgCzB,GAAG0B,EAAtD;AACA5B,iCAASe,SAAO,CAAhB,IAAqBK,EAAE2C,GAAF,IAAS7D,GAAGI,CAAZ,GAAgBiB,EAAEuC,GAAF,IAAS5D,GAAG2B,CAA5B,GAAgC3B,GAAG4B,EAAxD;AACAf,kCAAU,CAAV;AACH;AACJ;AACJ,aARD,MASK;AACD,qBAAK+C,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B,yBAAKC,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B/D,iCAASe,MAAT,IAAmBK,EAAE2C,GAAF,CAAnB;AACA/D,iCAASe,SAAO,CAAhB,IAAqBQ,EAAEuC,GAAF,CAArB;AACA/C,kCAAU,CAAV;AACH;AACJ;AACJ;;AAEDvB,qBAAS,CAAT,IAAc,CAAd;AACAA,qBAAS,CAAT,IAAc,CAAd;AACAA,qBAAS,CAAT,IAAc,EAAd;AACAA,qBAAS,CAAT,IAAc,EAAd;;AAEA;AACA,gBAAII,OAAOmC,SAAX,EAAsB;AAClB,qBAAKC,aAAL,CAAmBpC,MAAnB,EAA2BC,WAA3B,EAAwCkD,SAAxC,EAAmDC,UAAnD,EAA+DC,QAA/D,EAAyEC,WAAzE;AACH;AACJ,SAxEqB;;AA0EtBlB,uBAAe,uBAAUpC,MAAV,EAAkBC,WAAlB,EAA+BkD,SAA/B,EAA0CC,UAA1C,EAAsDC,QAAtD,EAAgEC,WAAhE,EAA6E;AACxF,gBAAIhB,MAAMtC,OAAOuC,IAAjB;AACA,gBAAItB,OAAOhB,YAAYiB,KAAvB;AACA,gBAAIsB,aAAavC,YAAYwC,QAAZ,CAAqBC,WAAtC;AACA,gBAAIC,cAAc1C,YAAYwC,QAAZ,CAAqBG,WAAvC;;AAEA;AACA,gBAAIW,SAAJ,EAAeC,WAAf,EAA4BC,UAA5B;AACA,gBAAIC,SAAJ,EAAeC,YAAf,EAA6BC,YAA7B;AACA,gBAAIf,cAAc5C,YAAYiB,KAA9B;AACA2B,0BAAclD,GAAGmD,kBAAH,CAAsBD,WAAtB,CAAd;AACA5B,mBAAOtB,GAAGmD,kBAAH,CAAsB7B,IAAtB,CAAP;AACA,gBAAImD,QAAQzE,GAAG0E,kBAAH,EAAZ;;AAEAd,wBAAYJ,YAAYiB,KAAxB;AACAX,yBAAaL,aAAagB,KAA1B;AACAZ,0BAAcvC,KAAKJ,KAAL,GAAa0C,SAAb,GAAyBE,UAAvC;AACAC,wBAAYL,WAAWe,KAAvB;AACAR,2BAAeN,cAAcc,KAA7B;AACAT,2BAAe1C,KAAKH,MAAL,GAAc4C,SAAd,GAA0BE,YAAzC;;AAEA,gBAAItB,IAAIpD,MAAJ,GAAa,EAAjB,EAAqB;AACjBL,yBAASG,GAAT,CAAasD,GAAb;AACAA,sBAAMzD,SAASQ,GAAT,CAAa,EAAb,KAAoB,IAAIwC,YAAJ,CAAiB,EAAjB,CAA1B;AACA7B,uBAAOuC,IAAP,GAAcD,GAAd;AACH;;AAED;AACA,gBAAIgC,IAAI,KAAK9C,CAAb;AACA,gBAAI+C,IAAI,KAAK5C,CAAb;AACA,gBAAIoB,eAAerD,mCAAmC,GAAnC,GAAyC,CAA5D;AACA,gBAAIyB,SAAS,CAAb;AAAA,gBAAgB+C,GAAhB;AAAA,gBAAqBC,GAArB;;AAEA,gBAAIlE,YAAY+C,QAAhB,EAA0B;AACtBsB,kBAAE,CAAF,IAAO,CAACzB,YAAYrB,CAAZ,GAAgBuB,YAAjB,IAAiCP,UAAxC;AACA8B,kBAAE,CAAF,IAAO,CAACV,eAAef,YAAYrB,CAA5B,IAAiCgB,UAAxC;AACA8B,kBAAE,CAAF,IAAO,CAACV,eAAeD,YAAf,GAA8Bd,YAAYrB,CAA3C,IAAgDgB,UAAvD;AACA8B,kBAAE,CAAF,IAAO,CAACzB,YAAYrB,CAAZ,GAAgBqB,YAAY/B,MAA5B,GAAqCiC,YAAtC,IAAsDP,UAA7D;;AAEA+B,kBAAE,CAAF,IAAO,CAAC1B,YAAYlB,CAAZ,GAAgBoB,YAAjB,IAAiCJ,WAAxC;AACA4B,kBAAE,CAAF,IAAO,CAAChB,YAAYV,YAAYlB,CAAzB,IAA8BgB,WAArC;AACA4B,kBAAE,CAAF,IAAO,CAAChB,YAAYC,WAAZ,GAA0BX,YAAYlB,CAAvC,IAA4CgB,WAAnD;AACA4B,kBAAE,CAAF,IAAO,CAAC1B,YAAYlB,CAAZ,GAAgBkB,YAAYhC,KAA5B,GAAoCkC,YAArC,IAAqDJ,WAA5D;;AAEA,qBAAKuB,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B,yBAAKC,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B7B,4BAAInB,MAAJ,IAAcmD,EAAEJ,GAAF,CAAd;AACA5B,4BAAInB,SAAO,CAAX,IAAgBoD,EAAE,IAAEJ,GAAJ,CAAhB;AACAhD,kCAAU,CAAV;AACH;AACJ;AACJ,aAlBD,MAmBK;AACDmD,kBAAE,CAAF,IAAO,CAACzB,YAAYrB,CAAZ,GAAgBuB,YAAjB,IAAiCP,UAAxC;AACA8B,kBAAE,CAAF,IAAO,CAACf,YAAYV,YAAYrB,CAAzB,IAA8BgB,UAArC;AACA8B,kBAAE,CAAF,IAAO,CAACf,YAAYC,WAAZ,GAA0BX,YAAYrB,CAAvC,IAA4CgB,UAAnD;AACA8B,kBAAE,CAAF,IAAO,CAACzB,YAAYrB,CAAZ,GAAgBqB,YAAYhC,KAA5B,GAAoCkC,YAArC,IAAqDP,UAA5D;;AAEA+B,kBAAE,CAAF,IAAO,CAAC1B,YAAYlB,CAAZ,GAAgBoB,YAAjB,IAAiCJ,WAAxC;AACA4B,kBAAE,CAAF,IAAO,CAACb,YAAYb,YAAYlB,CAAzB,IAA8BgB,WAArC;AACA4B,kBAAE,CAAF,IAAO,CAACb,YAAYC,YAAZ,GAA2Bd,YAAYlB,CAAxC,IAA6CgB,WAApD;AACA4B,kBAAE,CAAF,IAAO,CAAC1B,YAAYlB,CAAZ,GAAgBkB,YAAY/B,MAA5B,GAAqCiC,YAAtC,IAAsDJ,WAA7D;;AAEA,qBAAKuB,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B,yBAAKC,MAAM,CAAX,EAAcA,MAAM,CAApB,EAAuBA,KAAvB,EAA8B;AAC1B7B,4BAAInB,MAAJ,IAAcmD,EAAEH,GAAF,CAAd;AACA7B,4BAAInB,SAAO,CAAX,IAAgBoD,EAAEL,GAAF,CAAhB;AACA/C,kCAAU,CAAV;AACH;AACJ;AACJ;AACJ;AAjJqB,KAA1B;;AAoJA;;;;;;;;;;;;;;;;;;;;;AAqBAqD,SAAKC,YAAL,GAAoB9E,GAAG8E,YAAH,GAAkB9E,GAAG+E,IAAH,CAAQC,MAAR,EAAe,gCAAgC;AACjF;AACAC,sBAAc,IAFmE;AAGjFC,sBAAc,IAHmE;;AAKjF;AACAC,oBAAY,CANqE;AAOjFC,qBAAa,CAPoE;AAQjFC,mBAAW,CARsE;AASjFC,sBAAc,CATmE;AAUjF;AACAC,oBAAY,IAXqE;AAYjF;AACAC,wBAAgB,CAbiE;AAcjF;AACAC,sBAAc,CAfmE;AAgBjFC,2BAAmB,KAhB8D;AAiBjF;AACAC,mBAAW,IAlBsE;AAmBjFC,iBAAS,IAnBwE;AAoBjFlF,mBAAW,IApBsE;AAqBjFkC,cAAM,IArB2E;AAsBjFF,oBAAY,CAtBqE;AAuBjFmD,qBAAa,IAvBoE;AAwBjFrD,mBAAW,IAxBsE;AAyBjFsD,qBAAa,KAzBoE;AA0BjFC,+BAAuB,KA1B0D;AA2BjFC,wBAAgB,KA3BiE;;AA6BjF;AACAC,mBAAW,KA9BsE;AA+BjFC,mBAAW,KA/BsE;AAgCjFC,oBAAY,cAhCqE;;AAkCjF;;;;;;;;AAQAC,cAAM,cAAUC,IAAV,EAAgBC,eAAhB,EAAiCC,SAAjC,EAA4C;AAC9CvG,eAAG+E,IAAH,CAAQyB,SAAR,CAAkBJ,IAAlB,CAAuBK,IAAvB,CAA4B,IAA5B;;AAEA;AACA,iBAAKC,OAAL,GAAe,IAAI1G,GAAG2G,MAAH,CAAUC,WAAd,EAAf;;AAEA,iBAAKhG,UAAL,CAAgBiG,QAAhB,CAAyB,KAAKpB,YAA9B;AACA,iBAAKF,UAAL,GAAkBvF,GAAG8G,SAAH,CAAaC,mBAAb,EAAlB;AACA,iBAAKC,cAAL,CAAoBhH,GAAGiH,CAAH,CAAK,GAAL,EAAU,GAAV,CAApB;AACA;AACA,iBAAKtB,SAAL,GAAiB,IAAjB;AACA,iBAAKC,OAAL,GAAe,IAAf;AACA,iBAAKlF,SAAL,GAAiBxB,SAASQ,GAAT,CAAa,CAAb,KAAmB,IAAIwC,YAAJ,CAAiB,CAAjB,CAApC;AACA,iBAAKU,IAAL,GAAY1D,SAASQ,GAAT,CAAa,CAAb,KAAmB,IAAIwC,YAAJ,CAAiB,CAAjB,CAA/B;;AAEA,gBAAImE,SAASvG,SAAb,EAAwB;AACpB,oBAAIuG,gBAAgBrG,GAAGkH,WAAvB,EACI,KAAKC,mBAAL,CAAyBd,IAAzB,EAA+BC,eAA/B,EADJ,KAEK;AACD,wBAAIc,QAAQpH,GAAGqH,gBAAH,CAAoBC,cAApB,CAAmCjB,IAAnC,CAAZ;AACA,wBAAIe,KAAJ,EACI,KAAKD,mBAAL,CAAyBC,KAAzB,EAAgCd,eAAhC,EADJ,KAGI,KAAKiB,YAAL,CAAkBlB,IAAlB,EAAwBC,eAAxB,EAAyCC,SAAzC;AACP;AACJ;;AAGD,gBAAIrG,UAAUJ,SAAd,EAAyB;AACrBI,wBAAQF,GAAGwH,WAAH,KAAmBxH,GAAGyH,IAAH,CAAQC,iBAAnC;AACH;AACJ,SAzEgF;;AA2EjFC,uBAAe,yBAAY;AACvB,mBAAO,KAAK3B,cAAZ;AACH,SA7EgF;;AA+EjF4B,sBAAc,wBAAY;AACtB,mBAAO5H,GAAGsB,IAAH,CAAQ,KAAKuG,kBAAb,CAAP;AACH,SAjFgF;;AAmFjFC,4BAAoB,8BAAY;AAC5B,iBAAKC,mBAAL,CAAyB,MAAzB,EAAiC,KAAKD,kBAAtC,EAA0D,IAA1D;AACA,iBAAKE,YAAL,CAAkB,KAAKC,eAAvB;AACA,iBAAKA,eAAL,GAAuB,IAAvB;AACH,SAvFgF;;AAyFjFD,sBAAc,sBAAUzB,SAAV,EAAqB;AAC/B;AACA;AACA,gBAAI,CAAC,KAAK2B,MAAL,EAAL,EAAoB;AAChB,qBAAKD,eAAL,GAAuB1B,SAAvB;AACA,qBAAKwB,mBAAL,CAAyB,MAAzB,EAAiC,KAAKD,kBAAtC,EAA0D,IAA1D;AACA,qBAAKK,gBAAL,CAAsB,MAAtB,EAA8B,KAAKL,kBAAnC,EAAuD,IAAvD;AACA,uBAAO,KAAP;AACH;;AAED,iBAAKD,kBAAL,GAA0BtB,SAA1B;AACA,iBAAK6B,gBAAL,CAAsB,KAAKnD,YAAL,CAAkB1D,KAAxC,EAA+C,KAAKsG,kBAApD;AACH,SArGgF;;AAuGjFO,0BAAkB,0BAAU9G,IAAV,EAAgBiF,SAAhB,EAA2B;AACzC,gBAAG,CAACA,SAAD,IAAc,CAACjF,IAAf,IAAuBtB,GAAGqI,gBAAH,CAAoB9B,SAApB,CAA1B,EAA0D;AACtDjF,uBAAOA,QAAQ,EAACO,GAAE,CAAH,EAAMG,GAAE,CAAR,EAAWd,OAAO,KAAKoH,YAAL,CAAkBpH,KAApC,EAA2CC,QAAQ,KAAKmH,YAAL,CAAkBnH,MAArE,EAAf;AACA,qBAAK0G,kBAAL,GAA0B7H,GAAGsB,IAAH,CAAQA,KAAKJ,KAAL,GAAY,CAApB,EACQI,KAAKH,MAAL,GAAa,CADrB,EAEQG,KAAKJ,KAAL,GAAY,CAFpB,EAGQI,KAAKH,MAAL,GAAa,CAHrB,CAA1B;AAIH,aAND,MAMO;AACH,qBAAK0G,kBAAL,GAA0BtB,SAA1B;AACH;;AAED,gBAAG,CAACvG,GAAGqI,gBAAH,CAAoB/G,IAApB,CAAJ,EAA+B;AAC3B,qBAAK6D,UAAL,GAAkB,KAAK0C,kBAAL,CAAwBhG,CAA1C;AACA,qBAAKwD,SAAL,GAAiB,KAAKwC,kBAAL,CAAwB7F,CAAzC;AACA,qBAAKoD,WAAL,GAAmB9D,KAAKJ,KAAL,GAAa,KAAKiE,UAAlB,GAA+B,KAAK0C,kBAAL,CAAwB3G,KAA1E;AACA,qBAAKoE,YAAL,GAAoBhE,KAAKH,MAAL,GAAc,KAAKkE,SAAnB,GAA+B,KAAKwC,kBAAL,CAAwB1G,MAA3E;AACH;AACJ,SAxHgF;;AA2HjFoG,sBAAc,sBAAUlB,IAAV,EAAgB/E,IAAhB,EAAsBiF,SAAtB,EAAiC;AAC3C,gBAAIF,gBAAgBrG,GAAGuI,IAAvB,EAA6B;AACzBlC,uBAAOmC,UAAU,CAAV,CAAP;AACAjC,4BAAYiC,UAAU,CAAV,CAAZ;AACAlH,uBAAOtB,GAAGsB,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAP;AACH,aAJD,MAIO;AACHA,uBAAOA,QAAQtB,GAAGsB,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAf;AACAiF,4BAAYA,aAAavG,GAAGsB,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAzB;AACH;;AAED,gBAAG,CAAC+E,IAAJ,EACI,MAAM,IAAIoC,KAAJ,CAAU,2DAAV,CAAN;;AAEJ,gBAAIC,UAAU1I,GAAG2I,YAAH,CAAgBC,gBAAhB,CAAiCvC,IAAjC,CAAd;AACA,gBAAI,CAACqC,OAAL,EAAc;AACVA,0BAAU1I,GAAG2I,YAAH,CAAgBE,QAAhB,CAAyBxC,IAAzB,CAAV;AACH;;AAED,gBAAIyC,YAAYJ,QAAQK,QAAR,EAAhB;AACA,iBAAK/C,cAAL,GAAsB8C,SAAtB;AACA,iBAAKpC,OAAL,CAAasC,KAAb;AACA,gBAAI,CAACF,SAAL,EAAgB;AACZ,qBAAKpC,OAAL,CAAauC,IAAb,CAAkBP,OAAlB,EAA2B,YAAY;AACnC,yBAAKnB,YAAL,CAAkBlB,IAAlB,EAAwB/E,IAAxB,EAA8BiF,SAA9B;AACA,yBAAK2C,aAAL,CAAmB,MAAnB;AACH,iBAHD,EAGG,IAHH;AAIA,uBAAO,KAAP;AACH;;AAED;AACA,gBAAIlJ,GAAGqI,gBAAH,CAAoB/G,IAApB,CAAJ,EAA+B;AAC3B,oBAAI6H,cAAcT,QAAQU,cAAR,EAAlB;AACA9H,uBAAOtB,GAAGsB,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc6H,YAAYjI,KAA1B,EAAiCiI,YAAYhI,MAA7C,CAAP;AACH;AACD,iBAAKkI,UAAL,CAAgBX,OAAhB,EAAyBpH,IAAzB;AACA,iBAAK8G,gBAAL,CAAsB9G,IAAtB,EAA4BiF,SAA5B;;AAEA,mBAAO,IAAP;AACH,SAjKgF;;AAmKjF+C,6BAAqB,6BAAUC,SAAV,EAAqBC,YAArB,EAAmCC,OAAnC,EAA4ClD,SAA5C,EAAuD;AACxE,gBAAI,CAACgD,SAAL,EAAgB;AACZ,uBAAO,KAAP;AACH;;AAED,gBAAIb,UAAUa,UAAUG,UAAV,EAAd;AACA,iBAAKhD,OAAL,CAAasC,KAAb;AACA,gBAAI,CAACN,QAAQK,QAAR,EAAL,EAAyB;AACrB,qBAAKrC,OAAL,CAAauC,IAAb,CAAkBP,OAAlB,EAA2B,YAAY;AACnC,yBAAKY,mBAAL,CAAyBC,SAAzB,EAAoCC,YAApC,EAAkDC,OAAlD,EAA2DlD,SAA3D;AACA,yBAAK2C,aAAL,CAAmB,MAAnB;AACH,iBAHD,EAGG,IAHH;AAIA,uBAAO,KAAP;AACH;;AAED,iBAAKG,UAAL,CAAgBX,OAAhB,EAAyBc,YAAzB;AACA,iBAAKpB,gBAAL,CAAsBoB,YAAtB,EAAoCjD,SAApC;;AAEA,mBAAO,IAAP;AACH,SAtLgF;;AAyLjF;;;;AAIAY,6BAAqB,6BAAU7G,WAAV,EAAuBiG,SAAvB,EAAkC;AACnD,iBAAKoD,cAAL,CAAoBrJ,WAApB;;AAEAiG,wBAAYA,aAAavG,GAAGsB,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAzB;;AAEA,iBAAK8G,gBAAL,CAAsB9H,YAAYiB,KAAlC,EAAyCgF,SAAzC;AACH,SAnMgF;;AAqMjFqD,iCAAyB,iCAAUC,eAAV,EAA2BtD,SAA3B,EAAsC;AAC3D,gBAAG,CAACsD,eAAJ,EACI,MAAM,IAAIpB,KAAJ,CAAU,iFAAV,CAAN;AACJlC,wBAAYA,aAAavG,GAAGsB,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAzB;;AAEA,gBAAI8F,QAAQpH,GAAGqH,gBAAH,CAAoBC,cAApB,CAAmCuC,eAAnC,CAAZ;AACA,gBAAIzC,SAAS,IAAb,EAAmB;AACfpH,mBAAG8J,GAAH,CAAO,6FAAP;AACA,uBAAO,KAAP;AACH;AACD,iBAAKH,cAAL,CAAoBvC,KAApB;;AAEAb,wBAAYA,aAAavG,GAAGsB,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAzB;;AAEA,iBAAK8G,gBAAL,CAAsBhB,MAAM7F,KAA5B,EAAmCgF,SAAnC;AACH,SApNgF;;AAsNjF2B,gBAAQ,kBAAY;AAChB,gBAAI,KAAKjD,YAAL,KAAsB,IAA1B,EAAgC;AAC5B,uBAAO,KAAP;AACH,aAFD,MAEO;AACH,uBAAO,KAAKA,YAAL,CAAkB0C,aAAlB,EAAP;AACH;AACJ,SA5NgF;;AA8NjF;;;;;AAKA0B,oBAAY,oBAAUX,OAAV,EAAmBpH,IAAnB,EAAyB;AACjC,gBAAIhB,cAAc,IAAIN,GAAGkH,WAAP,CAAmBwB,OAAnB,EAA4BpH,IAA5B,CAAlB;AACA,iBAAKqI,cAAL,CAAoBrJ,WAApB;AACH,SAtOgF;;AAwOjFyJ,0BAAkB,4BAAY;AAC1B;AACA,gBAAIC,YAAY,KAAKzE,UAArB;AACA,gBAAI,CAAC,KAAKN,YAAN,IAAsB,CAAC,KAAKA,YAAL,CAAkBnC,QAAlB,CAA2BmH,qBAA3B,EAA3B,EAA+E;AAC3E,oBAAID,UAAUE,GAAV,KAAkBlK,GAAGmK,GAArB,IAA4BH,UAAUI,GAAV,KAAkBpK,GAAGqK,SAArD,EAAgE;AAC5DL,8BAAUE,GAAV,GAAgBlK,GAAGsK,SAAnB;AACH;AACD,qBAAK5E,iBAAL,GAAyB,KAAzB;AACH,aALD,MAKO;AACH,oBAAIsE,UAAUE,GAAV,KAAkBlK,GAAGsK,SAArB,IAAkCN,UAAUI,GAAV,KAAkBpK,GAAGqK,SAA3D,EAAsE;AAClEL,8BAAUE,GAAV,GAAgBlK,GAAGmK,GAAnB;AACH;AACD,qBAAKzE,iBAAL,GAAyB,IAAzB;AACH;AACJ,SAtPgF;;AAwPjF6E,6BAAqB,6BAAUC,KAAV,EAAiB;AAClC,gBAAI,KAAK9E,iBAAL,KAA2B8E,KAA/B,EAAsC;AAClC,qBAAK9E,iBAAL,GAAyB8E,KAAzB;AACA,qBAAK5J,UAAL,CAAgB6J,cAAhB;AACH;AACJ,SA7PgF;;AA+PjFC,4BAAoB,8BAAY;AAC5B,mBAAO,KAAKhF,iBAAZ;AACH,SAjQgF;;AAmQjF;;;;;AAKAiE,wBAAgB,wBAAUrJ,WAAV,EAAuB;AACnC,gBAAIA,WAAJ,EAAiB;AACb,qBAAK2E,YAAL,GAAoB3E,WAApB;AACA,qBAAKuF,WAAL,GAAmB,IAAnB;AACA,qBAAKrD,SAAL,GAAiB,IAAjB;AACA,oBAAImI,OAAO,IAAX;AACA,oBAAIC,uBAAuB,SAAvBA,oBAAuB,GAAY;AACnC,wBAAI5K,GAAG6K,eAAH,CAAmBF,KAAKrC,YAAxB,EAAsCtI,GAAG8K,IAAH,CAAQ,CAAR,EAAW,CAAX,CAAtC,CAAJ,EAA0D;AACtDH,6BAAKI,cAAL,CAAoBJ,KAAK1F,YAAL,CAAkB1D,KAAtC;AACH;AACDoJ,yBAAK3E,cAAL,GAAsB,IAAtB;AACA2E,yBAAK/J,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACAlL,uBAAGmL,QAAH,CAAYC,kBAAZ,GAAiC,IAAjC;AACH,iBAPD;AAQAT,qBAAK3E,cAAL,GAAsB1F,YAAYqH,aAAZ,EAAtB;AACA,oBAAIgD,KAAK3E,cAAT,EAAyB;AACrB4E;AACH,iBAFD,MAEO;AACH,yBAAKlE,OAAL,CAAasC,KAAb;AACA,yBAAKtC,OAAL,CAAauC,IAAb,CAAkB3I,WAAlB,EAA+B,YAAY;AACvCsK;AACA,6BAAK1B,aAAL,CAAmB,MAAnB;AACH,qBAHD,EAGG,IAHH;AAIH;AACJ;AACJ,SAjSgF;;AAmSjF;;;;;AAKAmC,sBAAc,sBAAUrB,SAAV,EAAqBI,GAArB,EAA0B;AACpC,gBAAIA,QAAQtK,SAAZ,EAAuB;AACnB,qBAAKyF,UAAL,CAAgB2E,GAAhB,GAAsBF,UAAUE,GAAV,IAAiBlK,GAAGsL,SAA1C;AACA,qBAAK/F,UAAL,CAAgB6E,GAAhB,GAAsBJ,UAAUI,GAAV,IAAiBpK,GAAGqK,SAA1C;AACH,aAHD,MAIK;AACD,qBAAK9E,UAAL,CAAgB2E,GAAhB,GAAsBF,aAAahK,GAAGsL,SAAtC;AACA,qBAAK/F,UAAL,CAAgB6E,GAAhB,GAAsBA,OAAOpK,GAAGqK,SAAhC;AACH;AACD,iBAAKzJ,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACH,SAlTgF;;AAoTjF;;;;;AAKAK,sBAAc,wBAAY;AACtB,mBAAO,IAAIvL,GAAG8G,SAAP,CAAiB,KAAKvB,UAAL,CAAgB2E,GAAjC,EAAsC,KAAK3E,UAAL,CAAgB6E,GAAtD,CAAP;AACH,SA3TgF;;AA6TjFoB,0BAAkB,0BAAUC,aAAV,EAAyB;AACvC,gBAAI,CAACA,aAAD,IAAkBzL,GAAG6K,eAAH,CAAmB,KAAKvC,YAAxB,EAAsCmD,aAAtC,CAAtB,EAA4E;AAC5E,iBAAKV,cAAL,CAAoBU,aAApB;AACH,SAhUgF;;AAkUjFC,0BAAkB,4BAAY;AAC1B,mBAAO,KAAKtC,cAAL,EAAP;AACH,SApUgF;;AAsUjF;AACA2B,wBAAgB,wBAAU7J,KAAV,EAAiBC,MAAjB,EAAyB;AACrC,gBAAIA,WAAWrB,SAAf,EAA0B;AACtBqB,yBAASD,MAAMC,MAAf;AACAD,wBAAQA,MAAMA,KAAd;AACH;AACD,gBAAIA,UAAU,KAAKoH,YAAL,CAAkBpH,KAA5B,IAAqCC,WAAW,KAAKmH,YAAL,CAAkBnH,MAAtE,EAA8E;AAC1E;AACH;;AAEDnB,eAAG+E,IAAH,CAAQyB,SAAR,CAAkBuE,cAAlB,CAAiCtE,IAAjC,CAAsC,IAAtC,EAA4CvF,KAA5C,EAAmDC,MAAnD;AACA,iBAAK0E,WAAL,GAAmB,IAAnB;AACH,SAlVgF;;AAoVjFuD,wBAAgB,0BAAY;AACxB,gBAAG,KAAK5D,cAAL,KAAwBX,KAAKC,YAAL,CAAkB6G,aAAlB,CAAgCC,MAA3D,EAAmE;AAC/D,oBAAG,KAAK3G,YAAR,EAAsB;AAClB,2BAAO,KAAKA,YAAL,CAAkB5D,aAAzB;AACH;AACD,uBAAOrB,GAAG8K,IAAH,CAAQ,KAAKxC,YAAb,CAAP;AACH,aALD,MAKO;AACH,uBAAOtI,GAAG8K,IAAH,CAAQ,KAAKxC,YAAb,CAAP;AACH;AACJ,SA7VgF;;AA+VjFuD,mBAAW,mBAAUrB,KAAV,EAAiB;AACxBxK,eAAG+E,IAAH,CAAQyB,SAAR,CAAkBqF,SAAlB,CAA4BpF,IAA5B,CAAiC,IAAjC,EAAuC+D,KAAvC;AACA,iBAAK3E,WAAL,GAAmB,IAAnB;AACH,SAlWgF;;AAoWjFiG,oBAAY,oBAAUtB,KAAV,EAAiB;AACzBxK,eAAG+E,IAAH,CAAQyB,SAAR,CAAkBsF,UAAlB,CAA6BrF,IAA7B,CAAkC,IAAlC,EAAwC+D,KAAxC;AACA,iBAAK3E,WAAL,GAAmB,IAAnB;AACH,SAvWgF;;AAyWjF;;;;;AAKAgB,kBAAU,kBAAUkF,KAAV,EAAiB;AACvB,iBAAKtG,YAAL,GAAoBsG,KAApB;AACA,iBAAKnL,UAAL,CAAgBiG,QAAhB,CAAyBkF,KAAzB;AACA,iBAAKnL,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACH,SAlXgF;;AAoXjF;;;;AAIAc,kBAAU,oBAAY;AAClB,mBAAO,KAAKvG,YAAZ;AACH,SA1XgF;;AA4XjF;;;;AAIAwG,0BAAkB,0BAAUC,IAAV,EAAgB;AAC9B,gBAAI,KAAK1G,cAAL,KAAwB0G,IAA5B,EAAkC;;AAElC,iBAAK1G,cAAL,GAAsB0G,IAAtB;AACA,iBAAKrG,WAAL,GAAmB,IAAnB;AACA,iBAAKrD,SAAL,GAAiB,IAAjB;AACA,iBAAK5B,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACH,SAvYgF;AAwYjF;;;;AAIAiB,0BAAkB,4BAAY;AAC1B,mBAAO,KAAK3G,cAAZ;AACH,SA9YgF;AA+YjF;;;;AAIA4G,sBAAc,sBAAU5I,SAAV,EAAqB;AAC/B,iBAAK2B,UAAL,GAAkB3B,SAAlB;AACA,iBAAKqC,WAAL,GAAmB,IAAnB;AACA,iBAAKrD,SAAL,GAAiB,IAAjB;AACA,iBAAK5B,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACH,SAxZgF;AAyZjF;;;;AAIAmB,sBAAc,wBAAY;AACtB,mBAAO,KAAKlH,UAAZ;AACH,SA/ZgF;AAgajF;;;;AAIAmH,qBAAa,qBAAU5I,QAAV,EAAoB;AAC7B,iBAAK2B,SAAL,GAAiB3B,QAAjB;AACA,iBAAKmC,WAAL,GAAmB,IAAnB;AACA,iBAAKrD,SAAL,GAAiB,IAAjB;AACA,iBAAK5B,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACH,SAzagF;;AA2ajF;;;;AAIAqB,qBAAa,uBAAY;AACrB,mBAAO,KAAKlH,SAAZ;AACH,SAjbgF;;AAmbjF;;;;AAIAmH,uBAAe,uBAAU/I,UAAV,EAAsB;AACjC,iBAAK2B,WAAL,GAAmB3B,UAAnB;AACA,iBAAKoC,WAAL,GAAmB,IAAnB;AACA,iBAAKrD,SAAL,GAAiB,IAAjB;AACA,iBAAK5B,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACH,SA5bgF;;AA8bjF;;;;AAIAuB,uBAAe,yBAAY;AACvB,mBAAO,KAAKrH,WAAZ;AACH,SApcgF;;AAscjF;;;;AAIAsH,wBAAgB,wBAAU/I,WAAV,EAAuB;AACnC,iBAAK2B,YAAL,GAAoB3B,WAApB;AACA,iBAAKkC,WAAL,GAAmB,IAAnB;AACA,iBAAKrD,SAAL,GAAiB,IAAjB;AACA,iBAAK5B,UAAL,CAAgBoK,YAAhB,CAA6BhL,GAAG+E,IAAH,CAAQkG,WAAR,CAAoBC,YAAjD;AACH,SA/cgF;AAgdjF;;;;AAIAyB,wBAAgB,0BAAY;AACxB,mBAAO,KAAKrH,YAAZ;AACH,SAtdgF;;AAwdjFsH,uBAAe,yBAAY;AACvB,gBAAI,CAAC,KAAK3H,YAAN,IAAsB,CAAC,KAAKA,YAAL,CAAkBe,cAA7C,EAA6D;AACzD;AACH;;AAED,iBAAK+D,gBAAL;;AAEA,iBAAKjE,WAAL,GAAmB,KAAnB;AACA,oBAAQ,KAAKN,cAAb;AACE,qBAAKmG,cAAcC,MAAnB;AACIzL,wCAAoBC,kBAApB,CAAuC,IAAvC,EAA6C,KAAK6E,YAAlD,EAAgE,KAAKqD,YAArE,EAAmF,KAAKvC,qBAAxF;AACA;AACJ,qBAAK4F,cAAckB,MAAnB;AACIvJ,wCAAoBlD,kBAApB,CAAuC,IAAvC,EAA6C,KAAK6E,YAAlD,EAAgE,KAAKqD,YAArE,EAAmF,KAAKnD,UAAxF,EAAoG,KAAKC,WAAzG,EAAsH,KAAKC,SAA3H,EAAsI,KAAKC,YAA3I;AACA;AACJ;AACI,yBAAKO,WAAL,GAAmB,KAAnB;AACA,yBAAKrD,SAAL,GAAiB,KAAjB;AACAxC,uBAAG8M,KAAH,CAAS,uBAAT;AACA;AAXN;;AAeA,iBAAKjH,WAAL,GAAmB,KAAnB;AACA,iBAAKrD,SAAL,GAAiB,KAAjB;AACH,SAjfgF;;AAmfjFuK,0BAAkB,4BAAY;AAC1B,gBAAI/M,GAAGwH,WAAH,KAAmBxH,GAAGyH,IAAH,CAAQuF,kBAA/B,EACI,OAAO,IAAInI,KAAKC,YAAL,CAAkBmI,eAAtB,CAAsC,IAAtC,CAAP,CADJ,KAGI,OAAO,IAAIpI,KAAKC,YAAL,CAAkBoI,cAAtB,CAAqC,IAArC,CAAP;AACP;AAxfgF,KAA/C,CAAtC;;AA2fA,QAAIC,KAAKtI,KAAKC,YAAL,CAAkB0B,SAA3B;AACAxG,OAAGoN,WAAH,CAAe5G,SAAf,CAAyB6G,KAAzB,CAA+BF,EAA/B;;AAEA;AACA;AACAA,OAAG1B,aAAH;AACAzL,OAAGsN,kBAAH,CAAsBH,EAAtB,EAA0B,eAA1B,EAA2CA,GAAGzB,gBAA9C,EAAgEyB,GAAG3B,gBAAnE;AACA;AACA2B,OAAG5G,SAAH;AACAvG,OAAGsN,kBAAH,CAAsBH,EAAtB,EAA0B,WAA1B,EAAuCA,GAAGvF,YAA1C,EAAwDuF,GAAGnF,YAA3D;AACA;AACAmF,OAAG3J,SAAH;AACAxD,OAAGsN,kBAAH,CAAsBH,EAAtB,EAA0B,WAA1B,EAAuCA,GAAGd,YAA1C,EAAwDc,GAAGf,YAA3D;AACA;AACAe,OAAGzJ,QAAH;AACA1D,OAAGsN,kBAAH,CAAsBH,EAAtB,EAA0B,UAA1B,EAAsCA,GAAGZ,WAAzC,EAAsDY,GAAGb,WAAzD;AACA;AACAa,OAAG1J,UAAH;AACAzD,OAAGsN,kBAAH,CAAsBH,EAAtB,EAA0B,YAA1B,EAAwCA,GAAGV,aAA3C,EAA0DU,GAAGX,aAA7D;AACA;AACAW,OAAGxJ,WAAH;AACA3D,OAAGsN,kBAAH,CAAsBH,EAAtB,EAA0B,aAA1B,EAAyCA,GAAGR,cAA5C,EAA4DQ,GAAGT,cAA/D;;AAEAS,SAAK,IAAL;;AAEA;;;;;;;;;AASAtI,SAAKC,YAAL,CAAkByI,MAAlB,GAA2B,UAAUlH,IAAV,EAAgB/E,IAAhB,EAAsBiF,SAAtB,EAAiC;AACxD,eAAO,IAAI1B,KAAKC,YAAT,CAAsBuB,IAAtB,EAA4B/E,IAA5B,EAAkCiF,SAAlC,CAAP;AACH,KAFD;;AAIA;;;;;;;AAOA1B,SAAKC,YAAL,CAAkB0I,qBAAlB,GAA0C,UAAUlN,WAAV,EAAuBiG,SAAvB,EAAkC;AACxE,eAAO,IAAI1B,KAAKC,YAAT,CAAsBxE,WAAtB,EAAmCiG,SAAnC,CAAP;AACH,KAFD;;AAIA;;;;;;;AAOA1B,SAAKC,YAAL,CAAkB2I,yBAAlB,GAA8C,UAAU5D,eAAV,EAA2BtD,SAA3B,EAAsC;AAChF,eAAO,IAAI1B,KAAKC,YAAT,CAAsB+E,eAAtB,EAAuCtD,SAAvC,CAAP;AACH,KAFD;;AAIA;;;AAGA1B,SAAKC,YAAL,CAAkB4I,gBAAlB,GAAqC,CAArC;AACA7I,SAAKC,YAAL,CAAkB6I,aAAlB,GAAkC,CAAlC;AACA9I,SAAKC,YAAL,CAAkB8I,cAAlB,GAAmC,CAAnC;AACA/I,SAAKC,YAAL,CAAkB+I,eAAlB,GAAoC,CAApC;AACAhJ,SAAKC,YAAL,CAAkBgJ,gBAAlB,GAAqC,CAArC;AACAjJ,SAAKC,YAAL,CAAkBiJ,kBAAlB,GAAuC,CAAvC;AACAlJ,SAAKC,YAAL,CAAkBkJ,iBAAlB,GAAsC,CAAtC;AACAnJ,SAAKC,YAAL,CAAkBmJ,qBAAlB,GAA0C,CAA1C;;AAEApJ,SAAKC,YAAL,CAAkBiH,KAAlB,GAA0B,EAACmC,QAAQ,CAAT,EAAYC,MAAM,CAAlB,EAA1B;;AAEA,QAAIxC,gBAAgB9G,KAAKC,YAAL,CAAkB6G,aAAlB,GAAkC;AAClD;;;AAGAC,gBAAQ,CAJ0C;AAKlD;;;AAGAiB,gBAAQ;AAR0C,KAAtD;AAUC,CAx4BD","file":"UIScale9Sprite.js","sourceRoot":"../../../../../../../../assets/frameworks/cocos2d-html5/extensions/ccui/base-classes","sourcesContent":["/* global ccui */\n\n/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n Copyright (c) 2012 Neofect. All rights reserved.\n Copyright (c) 2016 zilongshanren. All rights reserved.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n\n Created by Jung Sang-Taik on 2012-03-16\n ****************************************************************************/\n(function () {\n\nvar dataPool = {\n    _pool: {},\n    _lengths: [],\n    put: function (data) {\n        var length = data.length;\n        if (!this._pool[length]) {\n            this._pool[length] = [data];\n            this._lengths.push(length);\n            this._lengths.sort();\n        }\n        else {\n            this._pool[length].push(data);\n        }\n    },\n    get: function (length) {\n        var id;\n        for (var i = 0; i < this._lengths.length; i++) {\n            if (this._lengths[i] >= length) {\n                id = this._lengths[i];\n                break;\n            }\n        }\n        if (id) {\n            return this._pool[id].pop();\n        }\n        else {\n            return undefined;\n        }\n    }\n};\n\nvar FIX_ARTIFACTS_BY_STRECHING_TEXEL = cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL, cornerId = [], webgl;\n\n\nvar simpleQuadGenerator = {\n    _rebuildQuads_base: function (sprite, spriteFrame, contentSize, isTrimmedContentSize) {\n        //build vertices\n        var vertices = sprite._vertices,\n            wt = sprite._renderCmd._worldTransform,\n            l, b, r, t;\n        if (isTrimmedContentSize) {\n            l = 0;\n            b = 0;\n            r = contentSize.width;\n            t = contentSize.height;\n        } else {\n            var originalSize = spriteFrame._originalSize;\n            var rect = spriteFrame._rect;\n            var offset = spriteFrame._offset;\n            var scaleX = contentSize.width / originalSize.width;\n            var scaleY = contentSize.height / originalSize.height;\n            var trimmLeft = offset.x + (originalSize.width - rect.width) / 2;\n            var trimmRight = offset.x - (originalSize.width - rect.width) / 2;\n            var trimmedBottom = offset.y + (originalSize.height - rect.height) / 2;\n            var trimmedTop = offset.y - (originalSize.height - rect.height) / 2;\n\n            l = trimmLeft * scaleX;\n            b = trimmedBottom * scaleY;\n            r = contentSize.width + trimmRight * scaleX;\n            t = contentSize.height + trimmedTop * scaleY;\n        }\n\n        if (vertices.length < 8) {\n            dataPool.put(vertices);\n            vertices = dataPool.get(8) || new Float32Array(8);\n            sprite._vertices = vertices;\n        }\n        // bl, br, tl, tr\n        if (webgl) {\n            vertices[0] = l * wt.a + b * wt.c + wt.tx;\n            vertices[1] = l * wt.b + b * wt.d + wt.ty;\n            vertices[2] = r * wt.a + b * wt.c + wt.tx;\n            vertices[3] = r * wt.b + b * wt.d + wt.ty;\n            vertices[4] = l * wt.a + t * wt.c + wt.tx;\n            vertices[5] = l * wt.b + t * wt.d + wt.ty;\n            vertices[6] = r * wt.a + t * wt.c + wt.tx;\n            vertices[7] = r * wt.b + t * wt.d + wt.ty;\n        }\n        else {\n            vertices[0] = l;\n            vertices[1] = b;\n            vertices[2] = r;\n            vertices[3] = b;\n            vertices[4] = l;\n            vertices[5] = t;\n            vertices[6] = r;\n            vertices[7] = t;\n        }\n\n        cornerId[0] = 0;\n        cornerId[1] = 2;\n        cornerId[2] = 4;\n        cornerId[3] = 6;\n\n        //build uvs\n        if (sprite._uvsDirty) {\n            this._calculateUVs(sprite, spriteFrame);\n        }\n\n        sprite._vertCount = 4;\n    },\n\n    _calculateUVs: function (sprite, spriteFrame) {\n        var uvs = sprite._uvs;\n        var atlasWidth = spriteFrame._texture._pixelsWide;\n        var atlasHeight = spriteFrame._texture._pixelsHigh;\n        var textureRect = spriteFrame._rect;\n        textureRect = cc.rectPointsToPixels(textureRect);\n\n        if (uvs.length < 8) {\n            dataPool.put(uvs);\n            uvs = dataPool.get(8) || new Float32Array(8);\n            sprite._uvs = uvs;\n        }\n\n        //uv computation should take spritesheet into account.\n        var l, b, r, t;\n        var texelCorrect = FIX_ARTIFACTS_BY_STRECHING_TEXEL ? 0.5 : 0;\n\n        if (spriteFrame._rotated) {\n            l = (textureRect.x + texelCorrect) / atlasWidth;\n            b = (textureRect.y + textureRect.width - texelCorrect) / atlasHeight;\n            r = (textureRect.x + textureRect.height - texelCorrect) / atlasWidth;\n            t = (textureRect.y + texelCorrect) / atlasHeight;\n            uvs[0] = l; uvs[1] = t;\n            uvs[2] = l; uvs[3] = b;\n            uvs[4] = r; uvs[5] = t;\n            uvs[6] = r; uvs[7] = b;\n        }\n        else {\n            l = (textureRect.x + texelCorrect) / atlasWidth;\n            b = (textureRect.y + textureRect.height - texelCorrect) / atlasHeight;\n            r = (textureRect.x + textureRect.width - texelCorrect) / atlasWidth;\n            t = (textureRect.y + texelCorrect) / atlasHeight;\n            uvs[0] = l; uvs[1] = b;\n            uvs[2] = r; uvs[3] = b;\n            uvs[4] = l; uvs[5] = t;\n            uvs[6] = r; uvs[7] = t;\n        }\n    }\n};\n\nvar scale9QuadGenerator = {\n    x: new Array(4),\n    y: new Array(4),\n    _rebuildQuads_base: function (sprite, spriteFrame, contentSize, insetLeft, insetRight, insetTop, insetBottom) {\n        //build vertices\n        var vertices = sprite._vertices;\n        var wt = sprite._renderCmd._worldTransform;\n        var leftWidth, centerWidth, rightWidth;\n        var topHeight, centerHeight, bottomHeight;\n        var rect = spriteFrame._rect;\n\n        leftWidth = insetLeft;\n        rightWidth = insetRight;\n        centerWidth = rect.width - leftWidth - rightWidth;\n        topHeight = insetTop;\n        bottomHeight = insetBottom;\n        centerHeight = rect.height - topHeight - bottomHeight;\n\n        var preferSize = contentSize;\n        var sizableWidth = preferSize.width - leftWidth - rightWidth;\n        var sizableHeight = preferSize.height - topHeight - bottomHeight;\n        var xScale = preferSize.width / (leftWidth + rightWidth);\n        var yScale = preferSize.height / (topHeight + bottomHeight);\n        xScale = xScale > 1 ? 1 : xScale;\n        yScale = yScale > 1 ? 1 : yScale;\n        sizableWidth = sizableWidth < 0 ? 0 : sizableWidth;\n        sizableHeight = sizableHeight < 0 ? 0 : sizableHeight;\n        var x = this.x;\n        var y = this.y;\n        x[0] = 0;\n        x[1] = leftWidth * xScale;\n        x[2] = x[1] + sizableWidth;\n        x[3] = preferSize.width;\n        y[0] = 0;\n        y[1] = bottomHeight * yScale;\n        y[2] = y[1] + sizableHeight;\n        y[3] = preferSize.height;\n\n        if (vertices.length < 32) {\n            dataPool.put(vertices);\n            vertices = dataPool.get(32) || new Float32Array(32);\n            sprite._vertices = vertices;\n        }\n        var offset = 0, row, col;\n        if (webgl) {\n            for (row = 0; row < 4; row++) {\n                for (col = 0; col < 4; col++) {\n                    vertices[offset] = x[col] * wt.a + y[row] * wt.c + wt.tx;\n                    vertices[offset+1] = x[col] * wt.b + y[row] * wt.d + wt.ty;\n                    offset += 2;\n                }\n            }\n        }\n        else {\n            for (row = 0; row < 4; row++) {\n                for (col = 0; col < 4; col++) {\n                    vertices[offset] = x[col];\n                    vertices[offset+1] = y[row];\n                    offset += 2;\n                }\n            }\n        }\n\n        cornerId[0] = 0;\n        cornerId[1] = 6;\n        cornerId[2] = 24;\n        cornerId[3] = 30;\n\n        //build uvs\n        if (sprite._uvsDirty) {\n            this._calculateUVs(sprite, spriteFrame, insetLeft, insetRight, insetTop, insetBottom);\n        }\n    },\n\n    _calculateUVs: function (sprite, spriteFrame, insetLeft, insetRight, insetTop, insetBottom) {\n        var uvs = sprite._uvs;\n        var rect = spriteFrame._rect;\n        var atlasWidth = spriteFrame._texture._pixelsWide;\n        var atlasHeight = spriteFrame._texture._pixelsHigh;\n\n        //caculate texture coordinate\n        var leftWidth, centerWidth, rightWidth;\n        var topHeight, centerHeight, bottomHeight;\n        var textureRect = spriteFrame._rect;\n        textureRect = cc.rectPointsToPixels(textureRect);\n        rect = cc.rectPointsToPixels(rect);\n        var scale = cc.contentScaleFactor();\n\n        leftWidth = insetLeft * scale;\n        rightWidth = insetRight * scale;\n        centerWidth = rect.width - leftWidth - rightWidth;\n        topHeight = insetTop * scale;\n        bottomHeight = insetBottom * scale;\n        centerHeight = rect.height - topHeight - bottomHeight;\n\n        if (uvs.length < 32) {\n            dataPool.put(uvs);\n            uvs = dataPool.get(32) || new Float32Array(32);\n            sprite._uvs = uvs;\n        }\n\n        //uv computation should take spritesheet into account.\n        var u = this.x;\n        var v = this.y;\n        var texelCorrect = FIX_ARTIFACTS_BY_STRECHING_TEXEL ? 0.5 : 0;\n        var offset = 0, row, col;\n\n        if (spriteFrame._rotated) {\n            u[0] = (textureRect.x + texelCorrect) / atlasWidth;\n            u[1] = (bottomHeight + textureRect.x) / atlasWidth;\n            u[2] = (bottomHeight + centerHeight + textureRect.x) / atlasWidth;\n            u[3] = (textureRect.x + textureRect.height - texelCorrect) / atlasWidth;\n\n            v[3] = (textureRect.y + texelCorrect) / atlasHeight;\n            v[2] = (leftWidth + textureRect.y) / atlasHeight;\n            v[1] = (leftWidth + centerWidth + textureRect.y) / atlasHeight;\n            v[0] = (textureRect.y + textureRect.width - texelCorrect) / atlasHeight;\n\n            for (row = 0; row < 4; row++) {\n                for (col = 0; col < 4; col++) {\n                    uvs[offset] = u[row];\n                    uvs[offset+1] = v[3-col];\n                    offset += 2;\n                }\n            }\n        }\n        else {\n            u[0] = (textureRect.x + texelCorrect) / atlasWidth;\n            u[1] = (leftWidth + textureRect.x) / atlasWidth;\n            u[2] = (leftWidth + centerWidth + textureRect.x) / atlasWidth;\n            u[3] = (textureRect.x + textureRect.width - texelCorrect) / atlasWidth;\n\n            v[3] = (textureRect.y + texelCorrect) / atlasHeight;\n            v[2] = (topHeight + textureRect.y) / atlasHeight;\n            v[1] = (topHeight + centerHeight + textureRect.y) / atlasHeight;\n            v[0] = (textureRect.y + textureRect.height - texelCorrect) / atlasHeight;\n\n            for (row = 0; row < 4; row++) {\n                for (col = 0; col < 4; col++) {\n                    uvs[offset] = u[col];\n                    uvs[offset+1] = v[row];\n                    offset += 2;\n                }\n            }\n        }\n    }\n};\n\n/**\n * <p>\n * A 9-slice sprite for cocos2d UI.                                                                    <br/>\n *                                                                                                     <br/>\n * 9-slice scaling allows you to specify how scaling is applied                                        <br/>\n * to specific areas of a sprite. With 9-slice scaling (3x3 grid),                                     <br/>\n * you can ensure that the sprite does not become distorted when                                       <br/>\n * scaled.                                                                                             <br/>\n * @see http://yannickloriot.com/library/ios/cccontrolextension/Classes/CCScale9Sprite.html            <br/>\n * </p>\n * @class\n * @extends cc.Node\n *\n * @property {cc.Size}  preferredSize   - The preferred size of the 9-slice sprite\n * @property {cc.Rect}  capInsets       - The cap insets of the 9-slice sprite\n * @property {Number}   insetLeft       - The left inset of the 9-slice sprite\n * @property {Number}   insetTop        - The top inset of the 9-slice sprite\n * @property {Number}   insetRight      - The right inset of the 9-slice sprite\n * @property {Number}   insetBottom     - The bottom inset of the 9-slice sprite\n */\n\nccui.Scale9Sprite = cc.Scale9Sprite = cc.Node.extend(/** @lends ccui.Scale9Sprite# */{\n    //resource data, could be async loaded.\n    _spriteFrame: null,\n    _scale9Image: null,\n\n    //scale 9 data\n    _insetLeft: 0,\n    _insetRight: 0,\n    _insetTop: 0,\n    _insetBottom: 0,\n    //blend function\n    _blendFunc: null,\n    //sliced or simple\n    _renderingType: 1,\n    //bright or not\n    _brightState: 0,\n    _opacityModifyRGB: false,\n    //rendering quads shared by canvas and webgl\n    _rawVerts: null,\n    _rawUvs: null,\n    _vertices: null,\n    _uvs: null,\n    _vertCount: 0,\n    _quadsDirty: true,\n    _uvsDirty: true,\n    _isTriangle: false,\n    _isTrimmedContentSize: false,\n    _textureLoaded: false,\n\n    //v3.3\n    _flippedX: false,\n    _flippedY: false,\n    _className: \"Scale9Sprite\",\n\n    /**\n     * Constructor function.\n     * @function\n     * @param {string|cc.SpriteFrame} file file name of texture or a SpriteFrame\n     * @param {cc.Rect} rectOrCapInsets\n     * @param {cc.Rect} capInsets\n     * @returns {Scale9Sprite}\n     */\n    ctor: function (file, rectOrCapInsets, capInsets) {\n        cc.Node.prototype.ctor.call(this);\n\n        //for async texture load\n        this._loader = new cc.Sprite.LoadManager();\n\n        this._renderCmd.setState(this._brightState);\n        this._blendFunc = cc.BlendFunc._alphaPremultiplied();\n        this.setAnchorPoint(cc.p(0.5, 0.5));\n        // Init vertex data for simple\n        this._rawVerts = null;\n        this._rawUvs = null;\n        this._vertices = dataPool.get(8) || new Float32Array(8);\n        this._uvs = dataPool.get(8) || new Float32Array(8);\n\n        if (file !== undefined) {\n            if (file instanceof cc.SpriteFrame)\n                this.initWithSpriteFrame(file, rectOrCapInsets);\n            else {\n                var frame = cc.spriteFrameCache.getSpriteFrame(file);\n                if (frame)\n                    this.initWithSpriteFrame(frame, rectOrCapInsets);\n                else\n                    this.initWithFile(file, rectOrCapInsets, capInsets);\n            }\n        }\n\n\n        if (webgl === undefined) {\n            webgl = cc._renderType === cc.game.RENDER_TYPE_WEBGL;\n        }\n    },\n\n    textureLoaded: function () {\n        return this._textureLoaded;\n    },\n\n    getCapInsets: function () {\n        return cc.rect(this._capInsetsInternal);\n    },\n\n    _asyncSetCapInsets: function () {\n        this.removeEventListener('load', this._asyncSetCapInsets, this);\n        this.setCapInsets(this._cacheCapInsets);\n        this._cacheCapInsets = null;\n    },\n\n    setCapInsets: function (capInsets) {\n        // Asynchronous loading texture requires this data\n        // This data does not take effect immediately, so it does not affect the existing texture.\n        if (!this.loaded()) {\n            this._cacheCapInsets = capInsets;\n            this.removeEventListener('load', this._asyncSetCapInsets, this);\n            this.addEventListener('load', this._asyncSetCapInsets, this);\n            return false;\n        }\n\n        this._capInsetsInternal = capInsets;\n        this._updateCapInsets(this._spriteFrame._rect, this._capInsetsInternal);\n    },\n\n    _updateCapInsets: function (rect, capInsets) {\n        if(!capInsets || !rect || cc._rectEqualToZero(capInsets)) {\n            rect = rect || {x:0, y:0, width: this._contentSize.width, height: this._contentSize.height};\n            this._capInsetsInternal = cc.rect(rect.width /3,\n                                              rect.height /3,\n                                              rect.width /3,\n                                              rect.height /3);\n        } else {\n            this._capInsetsInternal = capInsets;\n        }\n\n        if(!cc._rectEqualToZero(rect)) {\n            this._insetLeft = this._capInsetsInternal.x;\n            this._insetTop = this._capInsetsInternal.y;\n            this._insetRight = rect.width - this._insetLeft - this._capInsetsInternal.width;\n            this._insetBottom = rect.height - this._insetTop - this._capInsetsInternal.height;\n        }\n    },\n\n\n    initWithFile: function (file, rect, capInsets) {\n        if (file instanceof cc.Rect) {\n            file = arguments[1];\n            capInsets = arguments[0];\n            rect = cc.rect(0, 0, 0, 0);\n        } else {\n            rect = rect || cc.rect(0, 0, 0, 0);\n            capInsets = capInsets || cc.rect(0, 0, 0, 0);\n        }\n\n        if(!file)\n            throw new Error(\"ccui.Scale9Sprite.initWithFile(): file should be non-null\");\n\n        var texture = cc.textureCache.getTextureForKey(file);\n        if (!texture) {\n            texture = cc.textureCache.addImage(file);\n        }\n\n        var locLoaded = texture.isLoaded();\n        this._textureLoaded = locLoaded;\n        this._loader.clear();\n        if (!locLoaded) {\n            this._loader.once(texture, function () {\n                this.initWithFile(file, rect, capInsets);\n                this.dispatchEvent(\"load\");\n            }, this);\n            return false;\n        }\n\n        //in this function, the texture already make sure is loaded.\n        if( cc._rectEqualToZero(rect)) {\n            var textureSize = texture.getContentSize();\n            rect = cc.rect(0, 0, textureSize.width, textureSize.height);\n        }\n        this.setTexture(texture, rect);\n        this._updateCapInsets(rect, capInsets);\n\n        return true;\n    },\n\n    updateWithBatchNode: function (batchNode, originalRect, rotated, capInsets) {\n        if (!batchNode) {\n            return false;\n        }\n\n        var texture = batchNode.getTexture();\n        this._loader.clear();\n        if (!texture.isLoaded()) {\n            this._loader.once(texture, function () {\n                this.updateWithBatchNode(batchNode, originalRect, rotated, capInsets);\n                this.dispatchEvent(\"load\");\n            }, this);\n            return false;\n        }\n\n        this.setTexture(texture, originalRect);\n        this._updateCapInsets(originalRect, capInsets);\n\n        return true;\n    },\n\n\n    /**\n     * Initializes a 9-slice sprite with an sprite frame\n     * @param spriteFrameOrSFName The sprite frame object.\n     */\n    initWithSpriteFrame: function (spriteFrame, capInsets) {\n        this.setSpriteFrame(spriteFrame);\n\n        capInsets = capInsets || cc.rect(0, 0, 0, 0);\n\n        this._updateCapInsets(spriteFrame._rect, capInsets);\n    },\n\n    initWithSpriteFrameName: function (spriteFrameName, capInsets) {\n        if(!spriteFrameName)\n            throw new Error(\"ccui.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null\");\n        capInsets = capInsets || cc.rect(0, 0, 0, 0);\n\n        var frame = cc.spriteFrameCache.getSpriteFrame(spriteFrameName);\n        if (frame == null) {\n            cc.log(\"ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName\");\n            return false;\n        }\n        this.setSpriteFrame(frame);\n\n        capInsets = capInsets || cc.rect(0, 0, 0, 0);\n\n        this._updateCapInsets(frame._rect, capInsets);\n    },\n\n    loaded: function () {\n        if (this._spriteFrame === null) {\n            return false;\n        } else {\n            return this._spriteFrame.textureLoaded();\n        }\n    },\n\n    /**\n     * Change the texture file of 9 slice sprite\n     *\n     * @param textureOrTextureFile The name of the texture file.\n     */\n    setTexture: function (texture, rect) {\n        var spriteFrame = new cc.SpriteFrame(texture, rect);\n        this.setSpriteFrame(spriteFrame);\n    },\n\n    _updateBlendFunc: function () {\n        // it's possible to have an untextured sprite\n        var blendFunc = this._blendFunc;\n        if (!this._spriteFrame || !this._spriteFrame._texture.hasPremultipliedAlpha()) {\n            if (blendFunc.src === cc.ONE && blendFunc.dst === cc.BLEND_DST) {\n                blendFunc.src = cc.SRC_ALPHA;\n            }\n            this._opacityModifyRGB = false;\n        } else {\n            if (blendFunc.src === cc.SRC_ALPHA && blendFunc.dst === cc.BLEND_DST) {\n                blendFunc.src = cc.ONE;\n            }\n            this._opacityModifyRGB = true;\n        }\n    },\n\n    setOpacityModifyRGB: function (value) {\n        if (this._opacityModifyRGB !== value) {\n            this._opacityModifyRGB = value;\n            this._renderCmd._setColorDirty();\n        }\n    },\n\n    isOpacityModifyRGB: function () {\n        return this._opacityModifyRGB;\n    },\n\n    /**\n     * Change the sprite frame of 9 slice sprite\n     *\n     * @param spriteFrameOrSFFileName The name of the texture file.\n     */\n    setSpriteFrame: function (spriteFrame) {\n        if (spriteFrame) {\n            this._spriteFrame = spriteFrame;\n            this._quadsDirty = true;\n            this._uvsDirty = true;\n            var self = this;\n            var onResourceDataLoaded = function () {\n                if (cc.sizeEqualToSize(self._contentSize, cc.size(0, 0))) {\n                    self.setContentSize(self._spriteFrame._rect);\n                }\n                self._textureLoaded = true;\n                self._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n                cc.renderer.childrenOrderDirty = true;\n            };\n            self._textureLoaded = spriteFrame.textureLoaded();\n            if (self._textureLoaded) {\n                onResourceDataLoaded();\n            } else {\n                this._loader.clear();\n                this._loader.once(spriteFrame, function () {\n                    onResourceDataLoaded();\n                    this.dispatchEvent(\"load\");\n                }, this);\n            }\n        }\n    },\n\n    /**\n     * Sets the source blending function.\n     *\n     * @param blendFunc A structure with source and destination factor to specify pixel arithmetic. e.g. {GL_ONE, GL_ONE}, {GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA}.\n     */\n    setBlendFunc: function (blendFunc, dst) {\n        if (dst === undefined) {\n            this._blendFunc.src = blendFunc.src || cc.BLEND_SRC;\n            this._blendFunc.dst = blendFunc.dst || cc.BLEND_DST;\n        }\n        else {\n            this._blendFunc.src = blendFunc || cc.BLEND_SRC;\n            this._blendFunc.dst = dst || cc.BLEND_DST;\n        }\n        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n    },\n\n    /**\n     * Returns the blending function that is currently being used.\n     *\n     * @return A BlendFunc structure with source and destination factor which specified pixel arithmetic.\n     */\n    getBlendFunc: function () {\n        return new cc.BlendFunc(this._blendFunc.src, this._blendFunc.dst);\n    },\n\n    setPreferredSize: function (preferredSize) {\n        if (!preferredSize || cc.sizeEqualToSize(this._contentSize, preferredSize)) return;\n        this.setContentSize(preferredSize);\n    },\n\n    getPreferredSize: function () {\n        return this.getContentSize();\n    },\n\n    // overrides\n    setContentSize: function (width, height) {\n        if (height === undefined) {\n            height = width.height;\n            width = width.width;\n        }\n        if (width === this._contentSize.width && height === this._contentSize.height) {\n            return;\n        }\n\n        cc.Node.prototype.setContentSize.call(this, width, height);\n        this._quadsDirty = true;\n    },\n\n    getContentSize: function () {\n        if(this._renderingType === ccui.Scale9Sprite.RenderingType.SIMPLE) {\n            if(this._spriteFrame) {\n                return this._spriteFrame._originalSize;\n            }\n            return cc.size(this._contentSize);\n        } else {\n            return cc.size(this._contentSize);\n        }\n    },\n\n    _setWidth: function (value) {\n        cc.Node.prototype._setWidth.call(this, value);\n        this._quadsDirty = true;\n    },\n\n    _setHeight: function (value) {\n        cc.Node.prototype._setHeight.call(this, value);\n        this._quadsDirty = true;\n    },\n\n    /**\n     * Change the state of 9-slice sprite.\n     * @see `State`\n     * @param state A enum value in State.\n     */\n    setState: function (state) {\n        this._brightState = state;\n        this._renderCmd.setState(state);\n        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n    },\n\n    /**\n     * Query the current bright state.\n     * @return @see `State`\n     */\n    getState: function () {\n        return this._brightState;\n    },\n\n    /**\n     * change the rendering type, could be simple or slice\n     * @return @see `RenderingType`\n     */\n    setRenderingType: function (type) {\n        if (this._renderingType === type) return;\n\n        this._renderingType = type;\n        this._quadsDirty = true;\n        this._uvsDirty = true;\n        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n    },\n    /**\n     * get the rendering type, could be simple or slice\n     * @return @see `RenderingType`\n     */\n    getRenderingType: function () {\n        return this._renderingType;\n    },\n    /**\n     * change the left border of 9 slice sprite, it should be specified before trimmed.\n     * @param insetLeft left border.\n     */\n    setInsetLeft: function (insetLeft) {\n        this._insetLeft = insetLeft;\n        this._quadsDirty = true;\n        this._uvsDirty = true;\n        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n    },\n    /**\n     * get the left border of 9 slice sprite, the result is specified before trimmed.\n     * @return left border.\n     */\n    getInsetLeft: function () {\n        return this._insetLeft;\n    },\n    /**\n     * change the top border of 9 slice sprite, it should be specified before trimmed.\n     * @param insetTop top border.\n     */\n    setInsetTop: function (insetTop) {\n        this._insetTop = insetTop;\n        this._quadsDirty = true;\n        this._uvsDirty = true;\n        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n    },\n\n    /**\n     * get the top border of 9 slice sprite, the result is specified before trimmed.\n     * @return top border.\n     */\n    getInsetTop: function () {\n        return this._insetTop;\n    },\n\n    /**\n     * change the right border of 9 slice sprite, it should be specified before trimmed.\n     * @param insetRight right border.\n     */\n    setInsetRight: function (insetRight) {\n        this._insetRight = insetRight;\n        this._quadsDirty = true;\n        this._uvsDirty = true;\n        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n    },\n\n    /**\n     * get the right border of 9 slice sprite, the result is specified before trimmed.\n     * @return right border.\n     */\n    getInsetRight: function () {\n        return this._insetRight;\n    },\n\n    /**\n     * change the bottom border of 9 slice sprite, it should be specified before trimmed.\n     * @param insetBottom bottom border.\n     */\n    setInsetBottom: function (insetBottom) {\n        this._insetBottom = insetBottom;\n        this._quadsDirty = true;\n        this._uvsDirty = true;\n        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);\n    },\n    /**\n     * get the bottom border of 9 slice sprite, the result is specified before trimmed.\n     * @return bottom border.\n     */\n    getInsetBottom: function () {\n        return this._insetBottom;\n    },\n\n    _rebuildQuads: function () {\n        if (!this._spriteFrame || !this._spriteFrame._textureLoaded) {\n            return;\n        }\n\n        this._updateBlendFunc();\n\n        this._isTriangle = false;\n        switch (this._renderingType) {\n          case RenderingType.SIMPLE:\n              simpleQuadGenerator._rebuildQuads_base(this, this._spriteFrame, this._contentSize, this._isTrimmedContentSize);\n              break;\n          case RenderingType.SLICED:\n              scale9QuadGenerator._rebuildQuads_base(this, this._spriteFrame, this._contentSize, this._insetLeft, this._insetRight, this._insetTop, this._insetBottom);\n              break;\n          default:\n              this._quadsDirty = false;\n              this._uvsDirty = false;\n              cc.error('Can not generate quad');\n              return;\n        }\n\n\n        this._quadsDirty = false;\n        this._uvsDirty = false;\n    },\n\n    _createRenderCmd: function () {\n        if (cc._renderType === cc.game.RENDER_TYPE_CANVAS)\n            return new ccui.Scale9Sprite.CanvasRenderCmd(this);\n        else\n            return new ccui.Scale9Sprite.WebGLRenderCmd(this);\n    }\n});\n\nvar _p = ccui.Scale9Sprite.prototype;\ncc.EventHelper.prototype.apply(_p);\n\n// Extended properties\n/** @expose */\n_p.preferredSize;\ncc.defineGetterSetter(_p, \"preferredSize\", _p.getPreferredSize, _p.setPreferredSize);\n/** @expose */\n_p.capInsets;\ncc.defineGetterSetter(_p, \"capInsets\", _p.getCapInsets, _p.setCapInsets);\n/** @expose */\n_p.insetLeft;\ncc.defineGetterSetter(_p, \"insetLeft\", _p.getInsetLeft, _p.setInsetLeft);\n/** @expose */\n_p.insetTop;\ncc.defineGetterSetter(_p, \"insetTop\", _p.getInsetTop, _p.setInsetTop);\n/** @expose */\n_p.insetRight;\ncc.defineGetterSetter(_p, \"insetRight\", _p.getInsetRight, _p.setInsetRight);\n/** @expose */\n_p.insetBottom;\ncc.defineGetterSetter(_p, \"insetBottom\", _p.getInsetBottom, _p.setInsetBottom);\n\n_p = null;\n\n/**\n * Creates a 9-slice sprite with a texture file, a delimitation zone and\n * with the specified cap insets.\n * @deprecated since v3.0, please use new ccui.Scale9Sprite(file, rect, capInsets) instead.\n * @param {String|cc.SpriteFrame} file file name of texture or a cc.Sprite object\n * @param {cc.Rect} rect the rect of the texture\n * @param {cc.Rect} capInsets the cap insets of ccui.Scale9Sprite\n * @returns {ccui.Scale9Sprite}\n */\nccui.Scale9Sprite.create = function (file, rect, capInsets) {\n    return new ccui.Scale9Sprite(file, rect, capInsets);\n};\n\n/**\n * create a ccui.Scale9Sprite with Sprite frame.\n * @deprecated since v3.0, please use \"new ccui.Scale9Sprite(spriteFrame, capInsets)\" instead.\n * @param {cc.SpriteFrame} spriteFrame\n * @param {cc.Rect} capInsets\n * @returns {ccui.Scale9Sprite}\n */\nccui.Scale9Sprite.createWithSpriteFrame = function (spriteFrame, capInsets) {\n    return new ccui.Scale9Sprite(spriteFrame, capInsets);\n};\n\n/**\n * create a ccui.Scale9Sprite with a Sprite frame name\n * @deprecated since v3.0, please use \"new ccui.Scale9Sprite(spriteFrameName, capInsets)\" instead.\n * @param {string} spriteFrameName\n * @param {cc.Rect} capInsets\n * @returns {Scale9Sprite}\n */\nccui.Scale9Sprite.createWithSpriteFrameName = function (spriteFrameName, capInsets) {\n    return new ccui.Scale9Sprite(spriteFrameName, capInsets);\n};\n\n/**\n * @ignore\n */\nccui.Scale9Sprite.POSITIONS_CENTRE = 0;\nccui.Scale9Sprite.POSITIONS_TOP = 1;\nccui.Scale9Sprite.POSITIONS_LEFT = 2;\nccui.Scale9Sprite.POSITIONS_RIGHT = 3;\nccui.Scale9Sprite.POSITIONS_BOTTOM = 4;\nccui.Scale9Sprite.POSITIONS_TOPRIGHT = 5;\nccui.Scale9Sprite.POSITIONS_TOPLEFT = 6;\nccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT = 7;\n\nccui.Scale9Sprite.state = {NORMAL: 0, GRAY: 1};\n\nvar RenderingType = ccui.Scale9Sprite.RenderingType = {\n    /**\n     * @property {Number} SIMPLE\n     */\n    SIMPLE: 0,\n    /**\n     * @property {Number} SLICED\n     */\n    SLICED: 1\n};\n})();\n"]}