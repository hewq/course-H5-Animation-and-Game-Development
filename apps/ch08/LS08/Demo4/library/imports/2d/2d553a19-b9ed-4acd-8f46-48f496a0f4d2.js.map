{"version":3,"sources":["../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/particle/assets/frameworks/cocos2d-html5/cocos2d/particle/CCParticleSystem.js"],"names":["cc","Particle","pos","startPos","color","deltaColor","size","deltaSize","rotation","deltaRotation","timeToLive","atlasIndex","modeA","modeB","p","r","g","b","a","ModeA","ModeB","isChangeColor","drawPos","dir","radialAccel","tangentialAccel","angle","degreesPerSecond","radius","deltaRadius","TemporaryPoints","ParticleSystem","Node","extend","_className","_plistFile","_elapsed","_dontTint","_pointZeroForParticle","_particles","_emitCounter","_particleIdx","_batchNode","_transformSystemDirty","_allocatedParticles","_isActive","particleCount","duration","_sourcePosition","_posVar","life","lifeVar","angleVar","startSize","startSizeVar","endSize","endSizeVar","_startColor","_startColorVar","_endColor","_endColorVar","startSpin","startSpinVar","endSpin","endSpinVar","emissionRate","_totalParticles","_texture","_blendFunc","_opacityModifyRGB","positionType","autoRemoveOnFinish","emitterMode","_textureLoaded","ctor","plistFile","prototype","call","MODE_GRAVITY","src","BLEND_SRC","dst","BLEND_DST","TYPE_FREE","isNumber","ton","setDrawMode","TEXTURE_MODE","initWithTotalParticles","isString","initWithFile","isObject","initWithDictionary","_createRenderCmd","_renderType","game","RENDER_TYPE_CANVAS","CanvasRenderCmd","WebGLRenderCmd","ignoreColor","ignore","initTexCoordsWithRect","pointRect","_renderCmd","getBatchNode","setBatchNode","batchNode","getAtlasIndex","setAtlasIndex","getDrawMode","drawMode","getShapeType","setShapeType","shapeType","isActive","getParticleCount","setParticleCount","getDuration","setDuration","getSourcePosition","x","y","setSourcePosition","sourcePosition","getPosVar","setPosVar","posVar","getLife","setLife","getLifeVar","setLifeVar","getAngle","setAngle","getAngleVar","setAngleVar","getGravity","log","locGravity","gravity","setGravity","getSpeed","speed","setSpeed","getSpeedVar","speedVar","setSpeedVar","getTangentialAccel","setTangentialAccel","getTangentialAccelVar","tangentialAccelVar","setTangentialAccelVar","getRadialAccel","setRadialAccel","getRadialAccelVar","radialAccelVar","setRadialAccelVar","getRotationIsDir","rotationIsDir","setRotationIsDir","t","getStartRadius","MODE_RADIUS","startRadius","setStartRadius","getStartRadiusVar","startRadiusVar","setStartRadiusVar","getEndRadius","endRadius","setEndRadius","getEndRadiusVar","endRadiusVar","setEndRadiusVar","getRotatePerSecond","rotatePerSecond","setRotatePerSecond","degrees","getRotatePerSecondVar","rotatePerSecondVar","setRotatePerSecondVar","setScale","scale","scaleY","setRotation","newRotation","setScaleX","newScaleX","setScaleY","newScaleY","getStartSize","setStartSize","getStartSizeVar","setStartSizeVar","getEndSize","setEndSize","getEndSizeVar","setEndSizeVar","getStartColor","setStartColor","startColor","getStartColorVar","setStartColorVar","startColorVar","getEndColor","setEndColor","endColor","getEndColorVar","setEndColorVar","endColorVar","getStartSpin","setStartSpin","getStartSpinVar","setStartSpinVar","getEndSpin","setEndSpin","getEndSpinVar","setEndSpinVar","getEmissionRate","setEmissionRate","getTotalParticles","setTotalParticles","tp","getTexture","setTexture","texture","isLoaded","setTextureWithRect","rect","width","height","addEventListener","sender","getBlendFunc","setBlendFunc","undefined","_updateBlendFunc","isOpacityModifyRGB","setOpacityModifyRGB","newValue","isBlendAdditive","SRC_ALPHA","ONE","setBlendAdditive","locBlendFunc","_setBlendAdditive","getPositionType","setPositionType","isAutoRemoveOnFinish","setAutoRemoveOnFinish","getEmitterMode","setEmitterMode","init","dict","loader","getRes","getBoundingBoxToWorld","_canvas","dictionary","dirname","ret","buffer","image","locValueForKey","_valueForKey","maxParticles","parseInt","parseFloat","locStartColor","locStartColorVar","locEndColor","locEndColorVar","setPosition","locModeA","pszTmp","locRotationIsDir","toString","toLowerCase","locModeB","textureName","imgPath","path","changeBasename","tex","textureCache","getTextureForKey","textureData","length","addImage","unzipBase64AsArray","imageFormat","getImageFormatByData","FMT_TIFF","FMT_PNG","canvasObj","document","createElement","myPngObj","PNGReader","render","myTIFFObj","tiffReader","parseTIFF","cacheImage","addTexture","numberOfParticles","i","locParticles","scheduleUpdateWithPriority","_initWithTotalParticles","destroyParticleSystem","unscheduleUpdate","addParticle","isFull","particle","initParticle","locRandomMinus11","randomMinus1To1","Math","max","start","end","clampf","locParticleDeltaColor","locParticleTimeToLive","startS","START_SIZE_EQUAL_TO_END_SIZE","endS","startA","endA","convertToWorldSpace","TYPE_RELATIVE","_position","degreesToRadians","locParticleModeA","s","cos","sin","pMultIn","radiansToDegrees","pToAngle","locParitlceModeB","START_RADIUS_EQUAL_TO_END_RADIUS","stopSystem","resetSystem","updateQuadWithParticle","newPosition","postStep","update","dt","rate","currentPosition","pIn","_visible","tpa","tpb","tpc","pZeroIn","selParticle","tmp","radial","tangential","pNormalizeIn","newy","pAddIn","selModeB","_updateDeltaColor","newPos","diff","pSubIn","updateParticlePosition","currentIndex","deadParticle","disableParticle","_parent","removeChild","updateWithNoTime","key","pString","locTexture","Texture2D","hasPremultipliedAlpha","ONE_MINUS_SRC_ALPHA","clone","retParticle","blend","gra","getContentSize","setDisplayFrame","spriteFrame","locOffset","getOffsetInPixels","listenBackToForeground","obj","_p","opacityModifyRGB","defineGetterSetter","active","sourcePos","rotatePerS","rotatePerSVar","totalParticles","create","createWithTotalParticles","SHAPE_MODE","STAR_SHAPE","BALL_SHAPE","DURATION_INFINITY","TYPE_GROUPED"],"mappings":"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","file":"CCParticleSystem.js","sourceRoot":"../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/particle","sourcesContent":["/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// ideas taken from:\n//   . The ocean spray in your face [Jeff Lander]\n//      http://www.double.co.nz/dust/col0798.pdf\n//   . Building an Advanced Particle System [John van der Burg]\n//      http://www.gamasutra.com/features/20000623/vanderburg_01.htm\n//   . LOVE game engine\n//      http://love2d.org/\n//\n//\n// Radius mode support, from 71 squared\n//      http://particledesigner.71squared.com/\n//\n// IMPORTANT: Particle Designer is supported by cocos2d, but\n// 'Radius Mode' in Particle Designer uses a fixed emit rate of 30 hz. Since that can't be guarateed in cocos2d,\n//  cocos2d uses a another approach, but the results are almost identical.\n//\n\n\n// tCCPositionType\n// possible types of particle positions\n\n\n/**\n * Structure that contains the values of each particle\n * @Class\n * @Construct\n * @param {cc.Point} [pos=cc.p(0,0)] Position of particle\n * @param {cc.Point} [startPos=cc.p(0,0)]\n * @param {cc.Color} [color= cc.color(0, 0, 0, 255)]\n * @param {cc.Color} [deltaColor=cc.color(0, 0, 0, 255)]\n * @param {cc.Size} [size=0]\n * @param {cc.Size} [deltaSize=0]\n * @param {Number} [rotation=0]\n * @param {Number} [deltaRotation=0]\n * @param {Number} [timeToLive=0]\n * @param {Number} [atlasIndex=0]\n * @param {cc.Particle.ModeA} [modeA=]\n * @param {cc.Particle.ModeA} [modeB=]\n */\ncc.Particle = function (pos, startPos, color, deltaColor, size, deltaSize, rotation, deltaRotation, timeToLive, atlasIndex, modeA, modeB) {\n    this.pos = pos ? pos : cc.p(0, 0);\n    this.startPos = startPos ? startPos : cc.p(0, 0);\n    this.color = color ? color : {r: 0, g: 0, b: 0, a: 255};\n    this.deltaColor = deltaColor ? deltaColor : {r: 0, g: 0, b: 0, a: 255};\n    this.size = size || 0;\n    this.deltaSize = deltaSize || 0;\n    this.rotation = rotation || 0;\n    this.deltaRotation = deltaRotation || 0;\n    this.timeToLive = timeToLive || 0;\n    this.atlasIndex = atlasIndex || 0;\n    this.modeA = modeA ? modeA : new cc.Particle.ModeA();\n    this.modeB = modeB ? modeB : new cc.Particle.ModeB();\n    this.isChangeColor = false;\n    this.drawPos = cc.p(0, 0);\n};\n\n/**\n * Mode A: gravity, direction, radial accel, tangential accel\n * @Class\n * @Construct\n * @param {cc.Point} dir direction of particle\n * @param {Number} radialAccel\n * @param {Number} tangentialAccel\n */\ncc.Particle.ModeA = function (dir, radialAccel, tangentialAccel) {\n    this.dir = dir ? dir : cc.p(0, 0);\n    this.radialAccel = radialAccel || 0;\n    this.tangentialAccel = tangentialAccel || 0;\n};\n\n/**\n * Mode B: radius mode\n * @Class\n * @Construct\n * @param {Number} angle\n * @param {Number} degreesPerSecond\n * @param {Number} radius\n * @param {Number} deltaRadius\n */\ncc.Particle.ModeB = function (angle, degreesPerSecond, radius, deltaRadius) {\n    this.angle = angle || 0;\n    this.degreesPerSecond = degreesPerSecond || 0;\n    this.radius = radius || 0;\n    this.deltaRadius = deltaRadius || 0;\n};\n\n/**\n * Array of Point instances used to optimize particle updates\n */\ncc.Particle.TemporaryPoints = [\n    cc.p(),\n    cc.p(),\n    cc.p(),\n    cc.p()\n];\n\n/**\n * <p>\n *     Particle System base class. <br/>\n *     Attributes of a Particle System:<br/>\n *     - emission rate of the particles<br/>\n *     - Gravity Mode (Mode A): <br/>\n *     - gravity <br/>\n *     - direction <br/>\n *     - speed +-  variance <br/>\n *     - tangential acceleration +- variance<br/>\n *     - radial acceleration +- variance<br/>\n *     - Radius Mode (Mode B):      <br/>\n *     - startRadius +- variance    <br/>\n *     - endRadius +- variance      <br/>\n *     - rotate +- variance         <br/>\n *     - Properties common to all modes: <br/>\n *     - life +- life variance      <br/>\n *     - start spin +- variance     <br/>\n *     - end spin +- variance       <br/>\n *     - start size +- variance     <br/>\n *     - end size +- variance       <br/>\n *     - start color +- variance    <br/>\n *     - end color +- variance      <br/>\n *     - life +- variance           <br/>\n *     - blending function          <br/>\n *     - texture                    <br/>\n *                                  <br/>\n *     cocos2d also supports particles generated by Particle Designer (http://particledesigner.71squared.com/).<br/>\n *     'Radius Mode' in Particle Designer uses a fixed emit rate of 30 hz. Since that can't be guarateed in cocos2d,  <br/>\n *     cocos2d uses a another approach, but the results are almost identical.<br/>\n *     cocos2d supports all the variables used by Particle Designer plus a bit more:  <br/>\n *     - spinning particles (supported when using ParticleSystem)       <br/>\n *     - tangential acceleration (Gravity mode)                               <br/>\n *     - radial acceleration (Gravity mode)                                   <br/>\n *     - radius direction (Radius mode) (Particle Designer supports outwards to inwards direction only) <br/>\n *     It is possible to customize any of the above mentioned properties in runtime. Example:   <br/>\n * </p>\n * @class\n * @extends cc.Node\n *\n * @property {Boolean}              opacityModifyRGB    - Indicate whether the alpha value modify color.\n * @property {cc.SpriteBatchNode}   batchNode           - Weak reference to the sprite batch node.\n * @property {Boolean}              active              - <@readonly> Indicate whether the particle system is activated.\n * @property {Number}               shapeType           - ShapeType of ParticleSystem : cc.ParticleSystem.BALL_SHAPE | cc.ParticleSystem.STAR_SHAPE.\n * @property {Number}               atlasIndex          - Index of system in batch node array.\n * @property {Number}               particleCount       - Current quantity of particles that are being simulated.\n * @property {Number}               duration            - How many seconds the emitter wil run. -1 means 'forever'\n * @property {cc.Point}             sourcePos           - Source position of the emitter.\n * @property {cc.Point}             posVar              - Variation of source position.\n * @property {Number}               life                - Life of each particle setter.\n * @property {Number}               lifeVar             - Variation of life.\n * @property {Number}               angle               - Angle of each particle setter.\n * @property {Number}               angleVar            - Variation of angle of each particle setter.\n * @property {Number}               startSize           - Start size in pixels of each particle.\n * @property {Number}               startSizeVar        - Variation of start size in pixels.\n * @property {Number}               endSize             - End size in pixels of each particle.\n * @property {Number}               endSizeVar          - Variation of end size in pixels.\n * @property {Number}               startSpin           - Start angle of each particle.\n * @property {Number}               startSpinVar        - Variation of start angle.\n * @property {Number}               endSpin             - End angle of each particle.\n * @property {Number}               endSpinVar          - Variation of end angle.\n * @property {cc.Point}             gravity             - Gravity of the emitter.\n * @property {cc.Point}             speed               - Speed of the emitter.\n * @property {cc.Point}             speedVar            - Variation of the speed.\n * @property {Number}               tangentialAccel     - Tangential acceleration of each particle. Only available in 'Gravity' mode.\n * @property {Number}               tangentialAccelVar  - Variation of the tangential acceleration.\n * @property {Number}               tangentialAccel     - Radial acceleration of each particle. Only available in 'Gravity' mode.\n * @property {Number}               tangentialAccelVar  - Variation of the radial acceleration.\n * @property {Boolean}              rotationIsDir       - Indicate whether the rotation of each particle equals to its direction. Only available in 'Gravity' mode.\n * @property {Number}               startRadius         - Starting radius of the particles. Only available in 'Radius' mode.\n * @property {Number}               startRadiusVar      - Variation of the starting radius.\n * @property {Number}               endRadius           - Ending radius of the particles. Only available in 'Radius' mode.\n * @property {Number}               endRadiusVar        - Variation of the ending radius.\n * @property {Number}               rotatePerS          - Number of degress to rotate a particle around the source pos per second. Only available in 'Radius' mode.\n * @property {Number}               rotatePerSVar       - Variation of the degress to rotate a particle around the source pos per second.\n * @property {cc.Color}             startColor          - Start color of each particle.\n * @property {cc.Color}             startColorVar       - Variation of the start color.\n * @property {cc.Color}             endColor            - Ending color of each particle.\n * @property {cc.Color}             endColorVar         - Variation of the end color.\n * @property {Number}               emissionRate        - Emission rate of the particles.\n * @property {Number}               emitterMode         - Emitter modes: CCParticleSystem.MODE_GRAVITY: uses gravity, speed, radial and tangential acceleration; CCParticleSystem.MODE_RADIUS: uses radius movement + rotation.\n * @property {Number}               positionType        - Particles movement type: cc.ParticleSystem.TYPE_FREE | cc.ParticleSystem.TYPE_GROUPED.\n * @property {Number}               totalParticles      - Maximum particles of the system.\n * @property {Boolean}              autoRemoveOnFinish  - Indicate whether the node will be auto-removed when it has no particles left.\n * @property {cc.Texture2D|HTMLImageElement|HTMLCanvasElement}         texture             - Texture of Particle System.\n *\n * @example\n *  emitter.radialAccel = 15;\n *  emitter.startSpin = 0;\n */\ncc.ParticleSystem = cc.Node.extend(/** @lends cc.ParticleSystem# */{\n    _className: \"ParticleSystem\",\n    //***********variables*************\n    _plistFile: \"\",\n    //! time elapsed since the start of the system (in seconds)\n    _elapsed: 0,\n    _dontTint: false,\n\n    // Different modes\n    //! Mode A:Gravity + Tangential Accel + Radial Accel\n    modeA: null,\n    //! Mode B: circular movement (gravity, radial accel and tangential accel don't are not used in this mode)\n    modeB: null,\n\n    //private POINTZERO for ParticleSystem\n    _pointZeroForParticle: cc.p(0, 0),\n\n    //! Array of particles\n    _particles: null,\n\n    // color modulate\n    //  BOOL colorModulate;\n\n    //! How many particles can be emitted per second\n    _emitCounter: 0,\n    //!  particle idx\n    _particleIdx: 0,\n\n    _batchNode: null,\n    atlasIndex: 0,\n\n    //true if scaled or rotated\n    _transformSystemDirty: false,\n    _allocatedParticles: 0,\n\n    _isActive: false,\n    particleCount: 0,\n    duration: 0,\n    _sourcePosition: null,\n    _posVar: null,\n    life: 0,\n    lifeVar: 0,\n    angle: 0,\n    angleVar: 0,\n    startSize: 0,\n    startSizeVar: 0,\n    endSize: 0,\n    endSizeVar: 0,\n    _startColor: null,\n    _startColorVar: null,\n    _endColor: null,\n    _endColorVar: null,\n    startSpin: 0,\n    startSpinVar: 0,\n    endSpin: 0,\n    endSpinVar: 0,\n    emissionRate: 0,\n    _totalParticles: 0,\n    _texture: null,\n    _blendFunc: null,\n    _opacityModifyRGB: false,\n    positionType: null,\n    autoRemoveOnFinish: false,\n    emitterMode: 0,\n\n    _textureLoaded: null,\n\n    /**\n     * <p> return the string found by key in dict. <br/>\n     *    This plist files can be create manually or with Particle Designer:<br/>\n     *    http://particledesigner.71squared.com/<br/>\n     * </p>\n     * Constructor of cc.ParticleSystem\n     * @param {String|Number} plistFile\n     */\n    ctor: function (plistFile) {\n        cc.Node.prototype.ctor.call(this);\n        this.emitterMode = cc.ParticleSystem.MODE_GRAVITY;\n        this.modeA = new cc.ParticleSystem.ModeA();\n        this.modeB = new cc.ParticleSystem.ModeB();\n        this._blendFunc = {src: cc.BLEND_SRC, dst: cc.BLEND_DST};\n\n        this._particles = [];\n        this._sourcePosition = cc.p(0, 0);\n        this._posVar = cc.p(0, 0);\n\n        this._startColor = cc.color(255, 255, 255, 255);\n        this._startColorVar = cc.color(255, 255, 255, 255);\n        this._endColor = cc.color(255, 255, 255, 255);\n        this._endColorVar = cc.color(255, 255, 255, 255);\n\n        this._plistFile = \"\";\n        this._elapsed = 0;\n        this._dontTint = false;\n        this._pointZeroForParticle = cc.p(0, 0);\n        this._emitCounter = 0;\n        this._particleIdx = 0;\n        this._batchNode = null;\n        this.atlasIndex = 0;\n\n        this._transformSystemDirty = false;\n        this._allocatedParticles = 0;\n        this._isActive = false;\n        this.particleCount = 0;\n        this.duration = 0;\n        this.life = 0;\n        this.lifeVar = 0;\n        this.angle = 0;\n        this.angleVar = 0;\n        this.startSize = 0;\n        this.startSizeVar = 0;\n        this.endSize = 0;\n        this.endSizeVar = 0;\n\n        this.startSpin = 0;\n        this.startSpinVar = 0;\n        this.endSpin = 0;\n        this.endSpinVar = 0;\n        this.emissionRate = 0;\n        this._totalParticles = 0;\n        this._texture = null;\n        this._opacityModifyRGB = false;\n        this.positionType = cc.ParticleSystem.TYPE_FREE;\n        this.autoRemoveOnFinish = false;\n\n        this._textureLoaded = true;\n\n        if (!plistFile || cc.isNumber(plistFile)) {\n            var ton = plistFile || 100;\n            this.setDrawMode(cc.ParticleSystem.TEXTURE_MODE);\n            this.initWithTotalParticles(ton);\n        } else if (cc.isString(plistFile)) {\n            this.initWithFile(plistFile);\n        } else if (cc.isObject(plistFile)) {\n            this.initWithDictionary(plistFile, \"\");\n        }\n    },\n\n    _createRenderCmd: function () {\n        if (cc._renderType === cc.game.RENDER_TYPE_CANVAS)\n            return new cc.ParticleSystem.CanvasRenderCmd(this);\n        else\n            return new cc.ParticleSystem.WebGLRenderCmd(this);\n    },\n\n    /**\n     * This is a hack function for performance, it's only available on Canvas mode. <br/>\n     * It's very expensive to change color on Canvas mode, so if set it to true, particle system will ignore the changing color operation.\n     * @param {boolean} ignore\n     */\n    ignoreColor: function (ignore) {\n        this._dontTint = ignore;\n    },\n\n    /**\n     * <p> initializes the texture with a rectangle measured Points<br/>\n     * pointRect should be in Texture coordinates, not pixel coordinates\n     * </p>\n     * @param {cc.Rect} pointRect\n     */\n    initTexCoordsWithRect: function (pointRect) {\n        this._renderCmd.initTexCoordsWithRect(pointRect);\n    },\n\n    /**\n     * return weak reference to the cc.SpriteBatchNode that renders the cc.Sprite\n     * @return {cc.ParticleBatchNode}\n     */\n    getBatchNode: function () {\n        return this._batchNode;\n    },\n\n    /**\n     *  set weak reference to the cc.SpriteBatchNode that renders the cc.Sprite\n     * @param {cc.ParticleBatchNode} batchNode\n     */\n    setBatchNode: function (batchNode) {\n        this._renderCmd.setBatchNode(batchNode);\n    },\n\n    /**\n     * return index of system in batch node array\n     * @return {Number}\n     */\n    getAtlasIndex: function () {\n        return this.atlasIndex;\n    },\n\n    /**\n     * set index of system in batch node array\n     * @param {Number} atlasIndex\n     */\n    setAtlasIndex: function (atlasIndex) {\n        this.atlasIndex = atlasIndex;\n    },\n\n    /**\n     * Return DrawMode of ParticleSystem   (Canvas Mode only)\n     * @return {Number}\n     */\n    getDrawMode: function () {\n        return this._renderCmd.getDrawMode();\n    },\n\n    /**\n     * DrawMode of ParticleSystem setter   (Canvas Mode only)\n     * @param {Number} drawMode\n     */\n    setDrawMode: function (drawMode) {\n        this._renderCmd.setDrawMode(drawMode);\n    },\n\n    /**\n     * Return ShapeType of ParticleSystem  (Canvas Mode only)\n     * @return {Number}\n     */\n    getShapeType: function () {\n        return this._renderCmd.getShapeType();\n    },\n\n    /**\n     * ShapeType of ParticleSystem setter  (Canvas Mode only)\n     * @param {Number} shapeType\n     */\n    setShapeType: function (shapeType) {\n        this._renderCmd.setShapeType(shapeType);\n    },\n\n    /**\n     * Return ParticleSystem is active\n     * @return {Boolean}\n     */\n    isActive: function () {\n        return this._isActive;\n    },\n\n    /**\n     * Quantity of particles that are being simulated at the moment\n     * @return {Number}\n     */\n    getParticleCount: function () {\n        return this.particleCount;\n    },\n\n    /**\n     * Quantity of particles setter\n     * @param {Number} particleCount\n     */\n    setParticleCount: function (particleCount) {\n        this.particleCount = particleCount;\n    },\n\n    /**\n     * How many seconds the emitter wil run. -1 means 'forever'\n     * @return {Number}\n     */\n    getDuration: function () {\n        return this.duration;\n    },\n\n    /**\n     * set run seconds of the emitter\n     * @param {Number} duration\n     */\n    setDuration: function (duration) {\n        this.duration = duration;\n    },\n\n    /**\n     * Return sourcePosition of the emitter\n     * @return {cc.Point | Object}\n     */\n    getSourcePosition: function () {\n        return {x: this._sourcePosition.x, y: this._sourcePosition.y};\n    },\n\n    /**\n     * sourcePosition of the emitter setter\n     * @param sourcePosition\n     */\n    setSourcePosition: function (sourcePosition) {\n        this._sourcePosition.x = sourcePosition.x;\n        this._sourcePosition.y = sourcePosition.y;\n    },\n\n    /**\n     * Return Position variance of the emitter\n     * @return {cc.Point | Object}\n     */\n    getPosVar: function () {\n        return {x: this._posVar.x, y: this._posVar.y};\n    },\n\n    /**\n     * Position variance of the emitter setter\n     * @param {cc.Point} posVar\n     */\n    setPosVar: function (posVar) {\n        this._posVar.x = posVar.x;\n        this._posVar.y = posVar.y;\n    },\n\n    /**\n     * Return life of each particle\n     * @return {Number}\n     */\n    getLife: function () {\n        return this.life;\n    },\n\n    /**\n     * life of each particle setter\n     * @param {Number} life\n     */\n    setLife: function (life) {\n        this.life = life;\n    },\n\n    /**\n     * Return life variance of each particle\n     * @return {Number}\n     */\n    getLifeVar: function () {\n        return this.lifeVar;\n    },\n\n    /**\n     * life variance of each particle setter\n     * @param {Number} lifeVar\n     */\n    setLifeVar: function (lifeVar) {\n        this.lifeVar = lifeVar;\n    },\n\n    /**\n     * Return angle of each particle\n     * @return {Number}\n     */\n    getAngle: function () {\n        return this.angle;\n    },\n\n    /**\n     * angle of each particle setter\n     * @param {Number} angle\n     */\n    setAngle: function (angle) {\n        this.angle = angle;\n    },\n\n    /**\n     * Return angle variance of each particle\n     * @return {Number}\n     */\n    getAngleVar: function () {\n        return this.angleVar;\n    },\n\n    /**\n     * angle variance of each particle setter\n     * @param angleVar\n     */\n    setAngleVar: function (angleVar) {\n        this.angleVar = angleVar;\n    },\n\n    // mode A\n    /**\n     * Return Gravity of emitter\n     * @return {cc.Point}\n     */\n    getGravity: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getGravity() : Particle Mode should be Gravity\");\n        var locGravity = this.modeA.gravity;\n        return cc.p(locGravity.x, locGravity.y);\n    },\n\n    /**\n     * Gravity of emitter setter\n     * @param {cc.Point} gravity\n     */\n    setGravity: function (gravity) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setGravity() : Particle Mode should be Gravity\");\n        this.modeA.gravity = gravity;\n    },\n\n    /**\n     * Return Speed of each particle\n     * @return {Number}\n     */\n    getSpeed: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getSpeed() : Particle Mode should be Gravity\");\n        return this.modeA.speed;\n    },\n\n    /**\n     * Speed of each particle setter\n     * @param {Number} speed\n     */\n    setSpeed: function (speed) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setSpeed() : Particle Mode should be Gravity\");\n        this.modeA.speed = speed;\n    },\n\n    /**\n     * return speed variance of each particle. Only available in 'Gravity' mode.\n     * @return {Number}\n     */\n    getSpeedVar: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getSpeedVar() : Particle Mode should be Gravity\");\n        return this.modeA.speedVar;\n    },\n\n    /**\n     * speed variance of each particle setter. Only available in 'Gravity' mode.\n     * @param {Number} speedVar\n     */\n    setSpeedVar: function (speedVar) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setSpeedVar() : Particle Mode should be Gravity\");\n        this.modeA.speedVar = speedVar;\n    },\n\n    /**\n     * Return tangential acceleration of each particle. Only available in 'Gravity' mode.\n     * @return {Number}\n     */\n    getTangentialAccel: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getTangentialAccel() : Particle Mode should be Gravity\");\n        return this.modeA.tangentialAccel;\n    },\n\n    /**\n     * Tangential acceleration of each particle setter. Only available in 'Gravity' mode.\n     * @param {Number} tangentialAccel\n     */\n    setTangentialAccel: function (tangentialAccel) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setTangentialAccel() : Particle Mode should be Gravity\");\n        this.modeA.tangentialAccel = tangentialAccel;\n    },\n\n    /**\n     * Return tangential acceleration variance of each particle. Only available in 'Gravity' mode.\n     * @return {Number}\n     */\n    getTangentialAccelVar: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getTangentialAccelVar() : Particle Mode should be Gravity\");\n        return this.modeA.tangentialAccelVar;\n    },\n\n    /**\n     * tangential acceleration variance of each particle setter. Only available in 'Gravity' mode.\n     * @param {Number} tangentialAccelVar\n     */\n    setTangentialAccelVar: function (tangentialAccelVar) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setTangentialAccelVar() : Particle Mode should be Gravity\");\n        this.modeA.tangentialAccelVar = tangentialAccelVar;\n    },\n\n    /**\n     * Return radial acceleration of each particle. Only available in 'Gravity' mode.\n     * @return {Number}\n     */\n    getRadialAccel: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getRadialAccel() : Particle Mode should be Gravity\");\n        return this.modeA.radialAccel;\n    },\n\n    /**\n     * radial acceleration of each particle setter. Only available in 'Gravity' mode.\n     * @param {Number} radialAccel\n     */\n    setRadialAccel: function (radialAccel) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setRadialAccel() : Particle Mode should be Gravity\");\n        this.modeA.radialAccel = radialAccel;\n    },\n\n    /**\n     * Return radial acceleration variance of each particle. Only available in 'Gravity' mode.\n     * @return {Number}\n     */\n    getRadialAccelVar: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getRadialAccelVar() : Particle Mode should be Gravity\");\n        return this.modeA.radialAccelVar;\n    },\n\n    /**\n     * radial acceleration variance of each particle setter. Only available in 'Gravity' mode.\n     * @param {Number} radialAccelVar\n     */\n    setRadialAccelVar: function (radialAccelVar) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setRadialAccelVar() : Particle Mode should be Gravity\");\n        this.modeA.radialAccelVar = radialAccelVar;\n    },\n\n    /**\n     * get the rotation of each particle to its direction Only available in 'Gravity' mode.\n     * @returns {boolean}\n     */\n    getRotationIsDir: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.getRotationIsDir() : Particle Mode should be Gravity\");\n        return this.modeA.rotationIsDir;\n    },\n\n    /**\n     * set the rotation of each particle to its direction Only available in 'Gravity' mode.\n     * @param {boolean} t\n     */\n    setRotationIsDir: function (t) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY)\n            cc.log(\"cc.ParticleBatchNode.setRotationIsDir() : Particle Mode should be Gravity\");\n        this.modeA.rotationIsDir = t;\n    },\n\n    // mode B\n    /**\n     * Return starting radius of the particles. Only available in 'Radius' mode.\n     * @return {Number}\n     */\n    getStartRadius: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.getStartRadius() : Particle Mode should be Radius\");\n        return this.modeB.startRadius;\n    },\n\n    /**\n     * starting radius of the particles setter. Only available in 'Radius' mode.\n     * @param {Number} startRadius\n     */\n    setStartRadius: function (startRadius) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.setStartRadius() : Particle Mode should be Radius\");\n        this.modeB.startRadius = startRadius;\n    },\n\n    /**\n     * Return starting radius variance of the particles. Only available in 'Radius' mode.\n     * @return {Number}\n     */\n    getStartRadiusVar: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.getStartRadiusVar() : Particle Mode should be Radius\");\n        return this.modeB.startRadiusVar;\n    },\n\n    /**\n     * starting radius variance of the particles setter. Only available in 'Radius' mode.\n     * @param {Number} startRadiusVar\n     */\n    setStartRadiusVar: function (startRadiusVar) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.setStartRadiusVar() : Particle Mode should be Radius\");\n        this.modeB.startRadiusVar = startRadiusVar;\n    },\n\n    /**\n     * Return ending radius of the particles. Only available in 'Radius' mode.\n     * @return {Number}\n     */\n    getEndRadius: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.getEndRadius() : Particle Mode should be Radius\");\n        return this.modeB.endRadius;\n    },\n\n    /**\n     * ending radius of the particles setter. Only available in 'Radius' mode.\n     * @param {Number} endRadius\n     */\n    setEndRadius: function (endRadius) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.setEndRadius() : Particle Mode should be Radius\");\n        this.modeB.endRadius = endRadius;\n    },\n\n    /**\n     * Return ending radius variance of the particles. Only available in 'Radius' mode.\n     * @return {Number}\n     */\n    getEndRadiusVar: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.getEndRadiusVar() : Particle Mode should be Radius\");\n        return this.modeB.endRadiusVar;\n    },\n\n    /**\n     * ending radius variance of the particles setter. Only available in 'Radius' mode.\n     * @param endRadiusVar\n     */\n    setEndRadiusVar: function (endRadiusVar) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.setEndRadiusVar() : Particle Mode should be Radius\");\n        this.modeB.endRadiusVar = endRadiusVar;\n    },\n\n    /**\n     * get Number of degress to rotate a particle around the source pos per second. Only available in 'Radius' mode.\n     * @return {Number}\n     */\n    getRotatePerSecond: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.getRotatePerSecond() : Particle Mode should be Radius\");\n        return this.modeB.rotatePerSecond;\n    },\n\n    /**\n     * set Number of degress to rotate a particle around the source pos per second. Only available in 'Radius' mode.\n     * @param {Number} degrees\n     */\n    setRotatePerSecond: function (degrees) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.setRotatePerSecond() : Particle Mode should be Radius\");\n        this.modeB.rotatePerSecond = degrees;\n    },\n\n    /**\n     * Return Variance in degrees for rotatePerSecond. Only available in 'Radius' mode.\n     * @return {Number}\n     */\n    getRotatePerSecondVar: function () {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.getRotatePerSecondVar() : Particle Mode should be Radius\");\n        return this.modeB.rotatePerSecondVar;\n    },\n\n    /**\n     * Variance in degrees for rotatePerSecond setter. Only available in 'Radius' mode.\n     * @param degrees\n     */\n    setRotatePerSecondVar: function (degrees) {\n        if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)\n            cc.log(\"cc.ParticleBatchNode.setRotatePerSecondVar() : Particle Mode should be Radius\");\n        this.modeB.rotatePerSecondVar = degrees;\n    },\n    //////////////////////////////////////////////////////////////////////////\n\n    //don't use a transform matrix, this is faster\n    setScale: function (scale, scaleY) {\n        this._transformSystemDirty = true;\n        cc.Node.prototype.setScale.call(this, scale, scaleY);\n    },\n\n    setRotation: function (newRotation) {\n        this._transformSystemDirty = true;\n        cc.Node.prototype.setRotation.call(this, newRotation);\n    },\n\n    setScaleX: function (newScaleX) {\n        this._transformSystemDirty = true;\n        cc.Node.prototype.setScaleX.call(this, newScaleX);\n    },\n\n    setScaleY: function (newScaleY) {\n        this._transformSystemDirty = true;\n        cc.Node.prototype.setScaleY.call(this, newScaleY);\n    },\n\n    /**\n     * get start size in pixels of each particle\n     * @return {Number}\n     */\n    getStartSize: function () {\n        return this.startSize;\n    },\n\n    /**\n     * set start size in pixels of each particle\n     * @param {Number} startSize\n     */\n    setStartSize: function (startSize) {\n        this.startSize = startSize;\n    },\n\n    /**\n     * get size variance in pixels of each particle\n     * @return {Number}\n     */\n    getStartSizeVar: function () {\n        return this.startSizeVar;\n    },\n\n    /**\n     * set size variance in pixels of each particle\n     * @param {Number} startSizeVar\n     */\n    setStartSizeVar: function (startSizeVar) {\n        this.startSizeVar = startSizeVar;\n    },\n\n    /**\n     * get end size in pixels of each particle\n     * @return {Number}\n     */\n    getEndSize: function () {\n        return this.endSize;\n    },\n\n    /**\n     * set end size in pixels of each particle\n     * @param endSize\n     */\n    setEndSize: function (endSize) {\n        this.endSize = endSize;\n    },\n\n    /**\n     * get end size variance in pixels of each particle\n     * @return {Number}\n     */\n    getEndSizeVar: function () {\n        return this.endSizeVar;\n    },\n\n    /**\n     * set end size variance in pixels of each particle\n     * @param {Number} endSizeVar\n     */\n    setEndSizeVar: function (endSizeVar) {\n        this.endSizeVar = endSizeVar;\n    },\n\n    /**\n     * set start color of each particle\n     * @return {cc.Color}\n     */\n    getStartColor: function () {\n        return cc.color(this._startColor.r, this._startColor.g, this._startColor.b, this._startColor.a);\n    },\n\n    /**\n     * get start color of each particle\n     * @param {cc.Color} startColor\n     */\n    setStartColor: function (startColor) {\n        this._startColor.r = startColor.r;\n        this._startColor.g = startColor.g;\n        this._startColor.b = startColor.b;\n        this._startColor.a = startColor.a;\n    },\n\n    /**\n     * get start color variance of each particle\n     * @return {cc.Color}\n     */\n    getStartColorVar: function () {\n        return cc.color(this._startColorVar.r, this._startColorVar.g, this._startColorVar.b, this._startColorVar.a);\n    },\n\n    /**\n     * set start color variance of each particle\n     * @param {cc.Color} startColorVar\n     */\n    setStartColorVar: function (startColorVar) {\n        this._startColorVar.r = startColorVar.r;\n        this._startColorVar.g = startColorVar.g;\n        this._startColorVar.b = startColorVar.b;\n        this._startColorVar.a = startColorVar.a;\n    },\n\n    /**\n     * get end color and end color variation of each particle\n     * @return {cc.Color}\n     */\n    getEndColor: function () {\n        return cc.color(this._endColor.r, this._endColor.g, this._endColor.b, this._endColor.a);\n    },\n\n    /**\n     * set end color and end color variation of each particle\n     * @param {cc.Color} endColor\n     */\n    setEndColor: function (endColor) {\n        this._endColor.r = endColor.r;\n        this._endColor.g = endColor.g;\n        this._endColor.b = endColor.b;\n        this._endColor.a = endColor.a;\n    },\n\n    /**\n     * get end color variance of each particle\n     * @return {cc.Color}\n     */\n    getEndColorVar: function () {\n        return cc.color(this._endColorVar.r, this._endColorVar.g, this._endColorVar.b, this._endColorVar.a);\n    },\n\n    /**\n     * set end color variance of each particle\n     * @param {cc.Color} endColorVar\n     */\n    setEndColorVar: function (endColorVar) {\n        this._endColorVar.r = endColorVar.r;\n        this._endColorVar.g = endColorVar.g;\n        this._endColorVar.b = endColorVar.b;\n        this._endColorVar.a = endColorVar.a;\n    },\n\n    /**\n     * get initial angle of each particle\n     * @return {Number}\n     */\n    getStartSpin: function () {\n        return this.startSpin;\n    },\n\n    /**\n     * set initial angle of each particle\n     * @param {Number} startSpin\n     */\n    setStartSpin: function (startSpin) {\n        this.startSpin = startSpin;\n    },\n\n    /**\n     * get initial angle variance of each particle\n     * @return {Number}\n     */\n    getStartSpinVar: function () {\n        return this.startSpinVar;\n    },\n\n    /**\n     * set initial angle variance of each particle\n     * @param {Number} startSpinVar\n     */\n    setStartSpinVar: function (startSpinVar) {\n        this.startSpinVar = startSpinVar;\n    },\n\n    /**\n     * get end angle of each particle\n     * @return {Number}\n     */\n    getEndSpin: function () {\n        return this.endSpin;\n    },\n\n    /**\n     * set end angle of each particle\n     * @param {Number} endSpin\n     */\n    setEndSpin: function (endSpin) {\n        this.endSpin = endSpin;\n    },\n\n    /**\n     * get end angle variance of each particle\n     * @return {Number}\n     */\n    getEndSpinVar: function () {\n        return this.endSpinVar;\n    },\n\n    /**\n     * set end angle variance of each particle\n     * @param {Number} endSpinVar\n     */\n    setEndSpinVar: function (endSpinVar) {\n        this.endSpinVar = endSpinVar;\n    },\n\n    /**\n     * get emission rate of the particles\n     * @return {Number}\n     */\n    getEmissionRate: function () {\n        return this.emissionRate;\n    },\n\n    /**\n     * set emission rate of the particles\n     * @param {Number} emissionRate\n     */\n    setEmissionRate: function (emissionRate) {\n        this.emissionRate = emissionRate;\n    },\n\n    /**\n     * get maximum particles of the system\n     * @return {Number}\n     */\n    getTotalParticles: function () {\n        return this._totalParticles;\n    },\n\n    /**\n     * set maximum particles of the system\n     * @param {Number} tp totalParticles\n     */\n    setTotalParticles: function (tp) {\n        this._renderCmd.setTotalParticles(tp);\n    },\n\n    /**\n     * get Texture of Particle System\n     * @return {cc.Texture2D}\n     */\n    getTexture: function () {\n        return this._texture;\n    },\n\n    /**\n     * set Texture of Particle System\n     * @param {cc.Texture2D } texture\n     */\n    setTexture: function (texture) {\n        if (!texture)\n            return;\n\n        if (texture.isLoaded()) {\n            this.setTextureWithRect(texture, cc.rect(0, 0, texture.width, texture.height));\n        } else {\n            this._textureLoaded = false;\n            texture.addEventListener(\"load\", function (sender) {\n                this._textureLoaded = true;\n                this.setTextureWithRect(sender, cc.rect(0, 0, sender.width, sender.height));\n            }, this);\n        }\n    },\n\n    /** conforms to CocosNodeTexture protocol */\n    /**\n     * get BlendFunc of Particle System\n     * @return {cc.BlendFunc}\n     */\n    getBlendFunc: function () {\n        return this._blendFunc;\n    },\n\n    /**\n     * set BlendFunc of Particle System\n     * @param {Number} src\n     * @param {Number} dst\n     */\n    setBlendFunc: function (src, dst) {\n        if (dst === undefined) {\n            if (this._blendFunc !== src) {\n                this._blendFunc = src;\n                this._updateBlendFunc();\n            }\n        } else {\n            if (this._blendFunc.src !== src || this._blendFunc.dst !== dst) {\n                this._blendFunc = {src: src, dst: dst};\n                this._updateBlendFunc();\n            }\n        }\n    },\n\n    /**\n     * does the alpha value modify color getter\n     * @return {Boolean}\n     */\n    isOpacityModifyRGB: function () {\n        return this._opacityModifyRGB;\n    },\n\n    /**\n     * does the alpha value modify color setter\n     * @param newValue\n     */\n    setOpacityModifyRGB: function (newValue) {\n        this._opacityModifyRGB = newValue;\n    },\n\n    /**\n     * <p>whether or not the particles are using blend additive.<br/>\n     *     If enabled, the following blending function will be used.<br/>\n     * </p>\n     * @return {Boolean}\n     * @example\n     *    source blend function = GL_SRC_ALPHA;\n     *    dest blend function = GL_ONE;\n     */\n    isBlendAdditive: function () {\n        return (( this._blendFunc.src === cc.SRC_ALPHA && this._blendFunc.dst === cc.ONE) || (this._blendFunc.src === cc.ONE && this._blendFunc.dst === cc.ONE));\n    },\n\n    /**\n     * <p>whether or not the particles are using blend additive.<br/>\n     *     If enabled, the following blending function will be used.<br/>\n     * </p>\n     * @param {Boolean} isBlendAdditive\n     */\n    setBlendAdditive: function (isBlendAdditive) {\n        var locBlendFunc = this._blendFunc;\n        if (isBlendAdditive) {\n            locBlendFunc.src = cc.SRC_ALPHA;\n            locBlendFunc.dst = cc.ONE;\n        } else {\n            this._renderCmd._setBlendAdditive();\n        }\n    },\n\n    /**\n     * get particles movement type: Free or Grouped\n     * @return {Number}\n     */\n    getPositionType: function () {\n        return this.positionType;\n    },\n\n    /**\n     * set particles movement type: Free or Grouped\n     * @param {Number} positionType\n     */\n    setPositionType: function (positionType) {\n        this.positionType = positionType;\n    },\n\n    /**\n     *  <p> return whether or not the node will be auto-removed when it has no particles left.<br/>\n     *      By default it is false.<br/>\n     *  </p>\n     * @return {Boolean}\n     */\n    isAutoRemoveOnFinish: function () {\n        return this.autoRemoveOnFinish;\n    },\n\n    /**\n     *  <p> set whether or not the node will be auto-removed when it has no particles left.<br/>\n     *      By default it is false.<br/>\n     *  </p>\n     * @param {Boolean} isAutoRemoveOnFinish\n     */\n    setAutoRemoveOnFinish: function (isAutoRemoveOnFinish) {\n        this.autoRemoveOnFinish = isAutoRemoveOnFinish;\n    },\n\n    /**\n     * return kind of emitter modes\n     * @return {Number}\n     */\n    getEmitterMode: function () {\n        return this.emitterMode;\n    },\n\n    /**\n     * <p>Switch between different kind of emitter modes:<br/>\n     *  - CCParticleSystem.MODE_GRAVITY: uses gravity, speed, radial and tangential acceleration<br/>\n     *  - CCParticleSystem.MODE_RADIUS: uses radius movement + rotation <br/>\n     *  </p>\n     * @param {Number} emitterMode\n     */\n    setEmitterMode: function (emitterMode) {\n        this.emitterMode = emitterMode;\n    },\n\n    /**\n     * initializes a cc.ParticleSystem\n     */\n    init: function () {\n        return this.initWithTotalParticles(150);\n    },\n\n    /**\n     * <p>\n     *     initializes a CCParticleSystem from a plist file. <br/>\n     *      This plist files can be creted manually or with Particle Designer:<br/>\n     *      http://particledesigner.71squared.com/\n     * </p>\n     * @param {String} plistFile\n     * @return {boolean}\n     */\n    initWithFile: function (plistFile) {\n        this._plistFile = plistFile;\n        var dict = cc.loader.getRes(plistFile);\n        if (!dict) {\n            cc.log(\"cc.ParticleSystem.initWithFile(): Particles: file not found\");\n            return false;\n        }\n\n        // XXX compute path from a path, should define a function somewhere to do it\n        return this.initWithDictionary(dict, \"\");\n    },\n\n    /**\n     * return bounding box of particle system in world space\n     * @return {cc.Rect}\n     */\n    getBoundingBoxToWorld: function () {\n        return cc.rect(0, 0, cc._canvas.width, cc._canvas.height);\n    },\n\n    /**\n     * initializes a particle system from a NSDictionary and the path from where to load the png\n     * @param {object} dictionary\n     * @param {String} dirname\n     * @return {Boolean}\n     */\n    initWithDictionary: function (dictionary, dirname) {\n        var ret = false;\n        var buffer = null;\n        var image = null;\n        var locValueForKey = this._valueForKey;\n\n        var maxParticles = parseInt(locValueForKey(\"maxParticles\", dictionary));\n        // self, not super\n        if (this.initWithTotalParticles(maxParticles)) {\n            // angle\n            this.angle = parseFloat(locValueForKey(\"angle\", dictionary));\n            this.angleVar = parseFloat(locValueForKey(\"angleVariance\", dictionary));\n\n            // duration\n            this.duration = parseFloat(locValueForKey(\"duration\", dictionary));\n\n            // blend function\n            this._blendFunc.src = parseInt(locValueForKey(\"blendFuncSource\", dictionary));\n            this._blendFunc.dst = parseInt(locValueForKey(\"blendFuncDestination\", dictionary));\n\n            // color\n            var locStartColor = this._startColor;\n            locStartColor.r = parseFloat(locValueForKey(\"startColorRed\", dictionary)) * 255;\n            locStartColor.g = parseFloat(locValueForKey(\"startColorGreen\", dictionary)) * 255;\n            locStartColor.b = parseFloat(locValueForKey(\"startColorBlue\", dictionary)) * 255;\n            locStartColor.a = parseFloat(locValueForKey(\"startColorAlpha\", dictionary)) * 255;\n\n            var locStartColorVar = this._startColorVar;\n            locStartColorVar.r = parseFloat(locValueForKey(\"startColorVarianceRed\", dictionary)) * 255;\n            locStartColorVar.g = parseFloat(locValueForKey(\"startColorVarianceGreen\", dictionary)) * 255;\n            locStartColorVar.b = parseFloat(locValueForKey(\"startColorVarianceBlue\", dictionary)) * 255;\n            locStartColorVar.a = parseFloat(locValueForKey(\"startColorVarianceAlpha\", dictionary)) * 255;\n\n            var locEndColor = this._endColor;\n            locEndColor.r = parseFloat(locValueForKey(\"finishColorRed\", dictionary)) * 255;\n            locEndColor.g = parseFloat(locValueForKey(\"finishColorGreen\", dictionary)) * 255;\n            locEndColor.b = parseFloat(locValueForKey(\"finishColorBlue\", dictionary)) * 255;\n            locEndColor.a = parseFloat(locValueForKey(\"finishColorAlpha\", dictionary)) * 255;\n\n            var locEndColorVar = this._endColorVar;\n            locEndColorVar.r = parseFloat(locValueForKey(\"finishColorVarianceRed\", dictionary)) * 255;\n            locEndColorVar.g = parseFloat(locValueForKey(\"finishColorVarianceGreen\", dictionary)) * 255;\n            locEndColorVar.b = parseFloat(locValueForKey(\"finishColorVarianceBlue\", dictionary)) * 255;\n            locEndColorVar.a = parseFloat(locValueForKey(\"finishColorVarianceAlpha\", dictionary)) * 255;\n\n            // particle size\n            this.startSize = parseFloat(locValueForKey(\"startParticleSize\", dictionary));\n            this.startSizeVar = parseFloat(locValueForKey(\"startParticleSizeVariance\", dictionary));\n            this.endSize = parseFloat(locValueForKey(\"finishParticleSize\", dictionary));\n            this.endSizeVar = parseFloat(locValueForKey(\"finishParticleSizeVariance\", dictionary));\n\n            // position\n            this.setPosition(parseFloat(locValueForKey(\"sourcePositionx\", dictionary)),\n                parseFloat(locValueForKey(\"sourcePositiony\", dictionary)));\n            this._posVar.x = parseFloat(locValueForKey(\"sourcePositionVariancex\", dictionary));\n            this._posVar.y = parseFloat(locValueForKey(\"sourcePositionVariancey\", dictionary));\n\n            // Spinning\n            this.startSpin = parseFloat(locValueForKey(\"rotationStart\", dictionary));\n            this.startSpinVar = parseFloat(locValueForKey(\"rotationStartVariance\", dictionary));\n            this.endSpin = parseFloat(locValueForKey(\"rotationEnd\", dictionary));\n            this.endSpinVar = parseFloat(locValueForKey(\"rotationEndVariance\", dictionary));\n\n            this.emitterMode = parseInt(locValueForKey(\"emitterType\", dictionary));\n\n            // Mode A: Gravity + tangential accel + radial accel\n            if (this.emitterMode === cc.ParticleSystem.MODE_GRAVITY) {\n                var locModeA = this.modeA;\n                // gravity\n                locModeA.gravity.x = parseFloat(locValueForKey(\"gravityx\", dictionary));\n                locModeA.gravity.y = parseFloat(locValueForKey(\"gravityy\", dictionary));\n\n                // speed\n                locModeA.speed = parseFloat(locValueForKey(\"speed\", dictionary));\n                locModeA.speedVar = parseFloat(locValueForKey(\"speedVariance\", dictionary));\n\n                // radial acceleration\n                var pszTmp = locValueForKey(\"radialAcceleration\", dictionary);\n                locModeA.radialAccel = (pszTmp) ? parseFloat(pszTmp) : 0;\n\n                pszTmp = locValueForKey(\"radialAccelVariance\", dictionary);\n                locModeA.radialAccelVar = (pszTmp) ? parseFloat(pszTmp) : 0;\n\n                // tangential acceleration\n                pszTmp = locValueForKey(\"tangentialAcceleration\", dictionary);\n                locModeA.tangentialAccel = (pszTmp) ? parseFloat(pszTmp) : 0;\n\n                pszTmp = locValueForKey(\"tangentialAccelVariance\", dictionary);\n                locModeA.tangentialAccelVar = (pszTmp) ? parseFloat(pszTmp) : 0;\n\n                // rotation is dir\n                var locRotationIsDir = locValueForKey(\"rotationIsDir\", dictionary);\n                if (locRotationIsDir !== null) {\n                    locRotationIsDir = locRotationIsDir.toString().toLowerCase();\n                    locModeA.rotationIsDir = (locRotationIsDir === \"true\" || locRotationIsDir === \"1\");\n                }\n                else {\n                    locModeA.rotationIsDir = false;\n                }\n            } else if (this.emitterMode === cc.ParticleSystem.MODE_RADIUS) {\n                // or Mode B: radius movement\n                var locModeB = this.modeB;\n                locModeB.startRadius = parseFloat(locValueForKey(\"maxRadius\", dictionary));\n                locModeB.startRadiusVar = parseFloat(locValueForKey(\"maxRadiusVariance\", dictionary));\n                locModeB.endRadius = parseFloat(locValueForKey(\"minRadius\", dictionary));\n                locModeB.endRadiusVar = 0;\n                locModeB.rotatePerSecond = parseFloat(locValueForKey(\"rotatePerSecond\", dictionary));\n                locModeB.rotatePerSecondVar = parseFloat(locValueForKey(\"rotatePerSecondVariance\", dictionary));\n            } else {\n                cc.log(\"cc.ParticleSystem.initWithDictionary(): Invalid emitterType in config file\");\n                return false;\n            }\n\n            // life span\n            this.life = parseFloat(locValueForKey(\"particleLifespan\", dictionary));\n            this.lifeVar = parseFloat(locValueForKey(\"particleLifespanVariance\", dictionary));\n\n            // emission Rate\n            this.emissionRate = this._totalParticles / this.life;\n\n            //don't get the internal texture if a batchNode is used\n            if (!this._batchNode) {\n                // Set a compatible default for the alpha transfer\n                this._opacityModifyRGB = false;\n\n                // texture\n                // Try to get the texture from the cache\n                var textureName = locValueForKey(\"textureFileName\", dictionary);\n                var imgPath = cc.path.changeBasename(this._plistFile, textureName);\n                var tex = cc.textureCache.getTextureForKey(imgPath);\n\n                if (tex) {\n                    this.setTexture(tex);\n                } else {\n                    var textureData = locValueForKey(\"textureImageData\", dictionary);\n\n                    if (!textureData || textureData.length === 0) {\n                        tex = cc.textureCache.addImage(imgPath);\n                        if (!tex)\n                            return false;\n                        this.setTexture(tex);\n                    } else {\n                        buffer = cc.unzipBase64AsArray(textureData, 1);\n                        if (!buffer) {\n                            cc.log(\"cc.ParticleSystem: error decoding or ungzipping textureImageData\");\n                            return false;\n                        }\n\n                        var imageFormat = cc.getImageFormatByData(buffer);\n\n                        if (imageFormat !== cc.FMT_TIFF && imageFormat !== cc.FMT_PNG) {\n                            cc.log(\"cc.ParticleSystem: unknown image format with Data\");\n                            return false;\n                        }\n\n                        var canvasObj = document.createElement(\"canvas\");\n                        if (imageFormat === cc.FMT_PNG) {\n                            var myPngObj = new cc.PNGReader(buffer);\n                            myPngObj.render(canvasObj);\n                        } else {\n                            var myTIFFObj = cc.tiffReader;\n                            myTIFFObj.parseTIFF(buffer, canvasObj);\n                        }\n\n                        cc.textureCache.cacheImage(imgPath, canvasObj);\n\n                        var addTexture = cc.textureCache.getTextureForKey(imgPath);\n                        if (!addTexture)\n                            cc.log(\"cc.ParticleSystem.initWithDictionary() : error loading the texture\");\n                        this.setTexture(addTexture);\n                    }\n                }\n            }\n            ret = true;\n        }\n        return ret;\n    },\n\n    /**\n     * Initializes a system with a fixed number of particles\n     * @param {Number} numberOfParticles\n     * @return {Boolean}\n     */\n    initWithTotalParticles: function (numberOfParticles) {\n        this._totalParticles = numberOfParticles;\n\n        var i, locParticles = this._particles;\n        locParticles.length = 0;\n        for (i = 0; i < numberOfParticles; i++) {\n            locParticles[i] = new cc.Particle();\n        }\n\n        if (!locParticles) {\n            cc.log(\"Particle system: not enough memory\");\n            return false;\n        }\n        this._allocatedParticles = numberOfParticles;\n\n        if (this._batchNode)\n            for (i = 0; i < this._totalParticles; i++)\n                locParticles[i].atlasIndex = i;\n\n        // default, active\n        this._isActive = true;\n\n        // default blend function\n        this._blendFunc.src = cc.BLEND_SRC;\n        this._blendFunc.dst = cc.BLEND_DST;\n\n        // default movement type;\n        this.positionType = cc.ParticleSystem.TYPE_FREE;\n\n        // by default be in mode A:\n        this.emitterMode = cc.ParticleSystem.MODE_GRAVITY;\n\n        // default: modulate\n        // XXX: not used\n        //  colorModulate = YES;\n        this.autoRemoveOnFinish = false;\n\n        //for batchNode\n        this._transformSystemDirty = false;\n\n        // udpate after action in run!\n        this.scheduleUpdateWithPriority(1);\n        this._renderCmd._initWithTotalParticles(numberOfParticles);\n        return true;\n    },\n\n    /**\n     * Unschedules the \"update\" method.\n     * @function\n     * @see scheduleUpdate();\n     */\n    destroyParticleSystem: function () {\n        this.unscheduleUpdate();\n    },\n\n    /**\n     * Add a particle to the emitter\n     * @return {Boolean}\n     */\n    addParticle: function () {\n        if (this.isFull())\n            return false;\n\n        var particle = this._renderCmd.addParticle();\n        this.initParticle(particle);\n        ++this.particleCount;\n        return true;\n    },\n\n    /**\n     * Initializes a particle\n     * @param {cc.Particle} particle\n     */\n    initParticle: function (particle) {\n        var locRandomMinus11 = cc.randomMinus1To1;\n        // timeToLive\n        // no negative life. prevent division by 0\n        particle.timeToLive = this.life + this.lifeVar * locRandomMinus11();\n        particle.timeToLive = Math.max(0, particle.timeToLive);\n\n        // position\n        particle.pos.x = this._sourcePosition.x + this._posVar.x * locRandomMinus11();\n        particle.pos.y = this._sourcePosition.y + this._posVar.y * locRandomMinus11();\n\n        // Color\n        var start, end;\n        var locStartColor = this._startColor, locStartColorVar = this._startColorVar;\n        var locEndColor = this._endColor, locEndColorVar = this._endColorVar;\n        start = {\n            r: cc.clampf(locStartColor.r + locStartColorVar.r * locRandomMinus11(), 0, 255),\n            g: cc.clampf(locStartColor.g + locStartColorVar.g * locRandomMinus11(), 0, 255),\n            b: cc.clampf(locStartColor.b + locStartColorVar.b * locRandomMinus11(), 0, 255),\n            a: cc.clampf(locStartColor.a + locStartColorVar.a * locRandomMinus11(), 0, 255)\n        };\n        end = {\n            r: cc.clampf(locEndColor.r + locEndColorVar.r * locRandomMinus11(), 0, 255),\n            g: cc.clampf(locEndColor.g + locEndColorVar.g * locRandomMinus11(), 0, 255),\n            b: cc.clampf(locEndColor.b + locEndColorVar.b * locRandomMinus11(), 0, 255),\n            a: cc.clampf(locEndColor.a + locEndColorVar.a * locRandomMinus11(), 0, 255)\n        };\n\n        particle.color = start;\n        var locParticleDeltaColor = particle.deltaColor, locParticleTimeToLive = particle.timeToLive;\n        locParticleDeltaColor.r = (end.r - start.r) / locParticleTimeToLive;\n        locParticleDeltaColor.g = (end.g - start.g) / locParticleTimeToLive;\n        locParticleDeltaColor.b = (end.b - start.b) / locParticleTimeToLive;\n        locParticleDeltaColor.a = (end.a - start.a) / locParticleTimeToLive;\n\n        // size\n        var startS = this.startSize + this.startSizeVar * locRandomMinus11();\n        startS = Math.max(0, startS); // No negative value\n\n        particle.size = startS;\n        if (this.endSize === cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE) {\n            particle.deltaSize = 0;\n        } else {\n            var endS = this.endSize + this.endSizeVar * locRandomMinus11();\n            endS = Math.max(0, endS); // No negative values\n            particle.deltaSize = (endS - startS) / locParticleTimeToLive;\n        }\n\n        // rotation\n        var startA = this.startSpin + this.startSpinVar * locRandomMinus11();\n        var endA = this.endSpin + this.endSpinVar * locRandomMinus11();\n        particle.rotation = startA;\n        particle.deltaRotation = (endA - startA) / locParticleTimeToLive;\n\n        // position\n        if (this.positionType === cc.ParticleSystem.TYPE_FREE)\n            particle.startPos = this.convertToWorldSpace(this._pointZeroForParticle);\n        else if (this.positionType === cc.ParticleSystem.TYPE_RELATIVE) {\n            particle.startPos.x = this._position.x;\n            particle.startPos.y = this._position.y;\n        }\n\n        // direction\n        var a = cc.degreesToRadians(this.angle + this.angleVar * locRandomMinus11());\n\n        // Mode Gravity: A\n        if (this.emitterMode === cc.ParticleSystem.MODE_GRAVITY) {\n            var locModeA = this.modeA, locParticleModeA = particle.modeA;\n            var s = locModeA.speed + locModeA.speedVar * locRandomMinus11();\n\n            // direction\n            locParticleModeA.dir.x = Math.cos(a);\n            locParticleModeA.dir.y = Math.sin(a);\n            cc.pMultIn(locParticleModeA.dir, s);\n\n            // radial accel\n            locParticleModeA.radialAccel = locModeA.radialAccel + locModeA.radialAccelVar * locRandomMinus11();\n\n            // tangential accel\n            locParticleModeA.tangentialAccel = locModeA.tangentialAccel + locModeA.tangentialAccelVar * locRandomMinus11();\n\n            // rotation is dir\n            if (locModeA.rotationIsDir)\n                particle.rotation = -cc.radiansToDegrees(cc.pToAngle(locParticleModeA.dir));\n        } else {\n            // Mode Radius: B\n            var locModeB = this.modeB, locParitlceModeB = particle.modeB;\n\n            // Set the default diameter of the particle from the source position\n            var startRadius = locModeB.startRadius + locModeB.startRadiusVar * locRandomMinus11();\n            var endRadius = locModeB.endRadius + locModeB.endRadiusVar * locRandomMinus11();\n\n            locParitlceModeB.radius = startRadius;\n            locParitlceModeB.deltaRadius = (locModeB.endRadius === cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS) ? 0 : (endRadius - startRadius) / locParticleTimeToLive;\n\n            locParitlceModeB.angle = a;\n            locParitlceModeB.degreesPerSecond = cc.degreesToRadians(locModeB.rotatePerSecond + locModeB.rotatePerSecondVar * locRandomMinus11());\n        }\n    },\n\n    /**\n     * stop emitting particles. Running particles will continue to run until they die\n     */\n    stopSystem: function () {\n        this._isActive = false;\n        this._elapsed = this.duration;\n        this._emitCounter = 0;\n    },\n\n    /**\n     * Kill all living particles.\n     */\n    resetSystem: function () {\n        this._isActive = true;\n        this._elapsed = 0;\n        var locParticles = this._particles;\n        for (this._particleIdx = 0; this._particleIdx < this.particleCount; ++this._particleIdx)\n            locParticles[this._particleIdx].timeToLive = 0;\n    },\n\n    /**\n     * whether or not the system is full\n     * @return {Boolean}\n     */\n    isFull: function () {\n        return (this.particleCount >= this._totalParticles);\n    },\n\n    /**\n     * should be overridden by subclasses\n     * @param {cc.Particle} particle\n     * @param {cc.Point} newPosition\n     */\n    updateQuadWithParticle: function (particle, newPosition) {\n        this._renderCmd.updateQuadWithParticle(particle, newPosition);\n    },\n\n    /**\n     * should be overridden by subclasses\n     */\n    postStep: function () {\n        this._renderCmd.postStep();\n    },\n\n    /**\n     * update emitter's status\n     * @override\n     * @param {Number} dt delta time\n     */\n    update:function (dt) {\n        if (this._isActive && this.emissionRate) {\n            var rate = 1.0 / this.emissionRate;\n            //issue #1201, prevent bursts of particles, due to too high emitCounter\n            if (this.particleCount < this._totalParticles)\n                this._emitCounter += dt;\n\n            while ((this.particleCount < this._totalParticles) && (this._emitCounter > rate)) {\n                this.addParticle();\n                this._emitCounter -= rate;\n            }\n\n            this._elapsed += dt;\n            if (this.duration !== -1 && this.duration < this._elapsed)\n                this.stopSystem();\n        }\n        this._particleIdx = 0;\n\n        var currentPosition = cc.Particle.TemporaryPoints[0];\n        if (this.positionType === cc.ParticleSystem.TYPE_FREE) {\n            cc.pIn(currentPosition, this.convertToWorldSpace(this._pointZeroForParticle));\n        } else if (this.positionType === cc.ParticleSystem.TYPE_RELATIVE) {\n            currentPosition.x = this._position.x;\n            currentPosition.y = this._position.y;\n        }\n\n        if (this._visible) {\n            // Used to reduce memory allocation / creation within the loop\n            var tpa = cc.Particle.TemporaryPoints[1],\n                tpb = cc.Particle.TemporaryPoints[2],\n                tpc = cc.Particle.TemporaryPoints[3];\n\n            var locParticles = this._particles;\n            while (this._particleIdx < this.particleCount) {\n\n                // Reset the working particles\n                cc.pZeroIn(tpa);\n                cc.pZeroIn(tpb);\n                cc.pZeroIn(tpc);\n\n                var selParticle = locParticles[this._particleIdx];\n\n                // life\n                selParticle.timeToLive -= dt;\n\n                if (selParticle.timeToLive > 0) {\n                    // Mode A: gravity, direction, tangential accel & radial accel\n                    if (this.emitterMode === cc.ParticleSystem.MODE_GRAVITY) {\n\n                        var tmp = tpc, radial = tpa, tangential = tpb;\n\n                        // radial acceleration\n                        if (selParticle.pos.x || selParticle.pos.y) {\n                            cc.pIn(radial, selParticle.pos);\n                            cc.pNormalizeIn(radial);\n                        } else {\n                            cc.pZeroIn(radial);\n                        }\n\n                        cc.pIn(tangential, radial);\n                        cc.pMultIn(radial, selParticle.modeA.radialAccel);\n\n                        // tangential acceleration\n                        var newy = tangential.x;\n                        tangential.x = -tangential.y;\n                        tangential.y = newy;\n\n                        cc.pMultIn(tangential, selParticle.modeA.tangentialAccel);\n\n                        cc.pIn(tmp, radial);\n                        cc.pAddIn(tmp, tangential);\n                        cc.pAddIn(tmp, this.modeA.gravity);\n                        cc.pMultIn(tmp, dt);\n                        cc.pAddIn(selParticle.modeA.dir, tmp);\n\n\n                        cc.pIn(tmp, selParticle.modeA.dir);\n                        cc.pMultIn(tmp, dt);\n                        cc.pAddIn(selParticle.pos, tmp);\n                    } else {\n                        // Mode B: radius movement\n                        var selModeB = selParticle.modeB;\n                        // Update the angle and radius of the particle.\n                        selModeB.angle += selModeB.degreesPerSecond * dt;\n                        selModeB.radius += selModeB.deltaRadius * dt;\n\n                        selParticle.pos.x = -Math.cos(selModeB.angle) * selModeB.radius;\n                        selParticle.pos.y = -Math.sin(selModeB.angle) * selModeB.radius;\n                    }\n\n                    // color\n                    this._renderCmd._updateDeltaColor(selParticle, dt);\n\n                    // size\n                    selParticle.size += (selParticle.deltaSize * dt);\n                    selParticle.size = Math.max(0, selParticle.size);\n\n                    // angle\n                    selParticle.rotation += (selParticle.deltaRotation * dt);\n\n                    //\n                    // update values in quad\n                    //\n                    var newPos = tpa;\n                    if (this.positionType === cc.ParticleSystem.TYPE_FREE || this.positionType === cc.ParticleSystem.TYPE_RELATIVE) {\n                        var diff = tpb;\n                        cc.pIn(diff, currentPosition);\n                        cc.pSubIn(diff, selParticle.startPos);\n\n                        cc.pIn(newPos, selParticle.pos);\n                        cc.pSubIn(newPos, diff);\n                    } else {\n                        cc.pIn(newPos, selParticle.pos);\n                    }\n\n                    // translate newPos to correct position, since matrix transform isn't performed in batchnode\n                    // don't update the particle with the new position information, it will interfere with the radius and tangential calculations\n                    if (this._batchNode) {\n                        newPos.x += this._position.x;\n                        newPos.y += this._position.y;\n                    }\n                    this._renderCmd.updateParticlePosition(selParticle, newPos);\n\n                    // update particle counter\n                    ++this._particleIdx;\n                } else {\n                    // life < 0\n                    var currentIndex = selParticle.atlasIndex;\n                    if (this._particleIdx !== this.particleCount - 1) {\n                        var deadParticle = locParticles[this._particleIdx];\n                        locParticles[this._particleIdx] = locParticles[this.particleCount - 1];\n                        locParticles[this.particleCount - 1] = deadParticle;\n                    }\n                    if (this._batchNode) {\n                        //disable the switched particle\n                        this._batchNode.disableParticle(this.atlasIndex + currentIndex);\n                        //switch indexes\n                        locParticles[this.particleCount - 1].atlasIndex = currentIndex;\n                    }\n\n                    --this.particleCount;\n                    if (this.particleCount === 0 && this.autoRemoveOnFinish) {\n                        this.unscheduleUpdate();\n                        this._parent.removeChild(this, true);\n                        return;\n                    }\n                }\n            }\n            this._transformSystemDirty = false;\n        }\n\n        if (!this._batchNode)\n            this.postStep();\n    },\n\n    /**\n     * update emitter's status (dt = 0)\n     */\n    updateWithNoTime: function () {\n        this.update(0);\n    },\n\n    //\n    // return the string found by key in dict.\n    // @param {string} key\n    // @param {object} dict\n    // @return {String} \"\" if not found; return the string if found.\n    // @private\n    //\n    _valueForKey: function (key, dict) {\n        if (dict) {\n            var pString = dict[key];\n            return pString != null ? pString : \"\";\n        }\n        return \"\";\n    },\n\n    _updateBlendFunc: function () {\n        if (this._batchNode) {\n            cc.log(\"Can't change blending functions when the particle is being batched\");\n            return;\n        }\n\n        var locTexture = this._texture;\n        if (locTexture && locTexture instanceof cc.Texture2D) {\n            this._opacityModifyRGB = false;\n            var locBlendFunc = this._blendFunc;\n            if (locBlendFunc.src === cc.BLEND_SRC && locBlendFunc.dst === cc.BLEND_DST) {\n                if (locTexture.hasPremultipliedAlpha()) {\n                    this._opacityModifyRGB = true;\n                } else {\n                    locBlendFunc.src = cc.SRC_ALPHA;\n                    locBlendFunc.dst = cc.ONE_MINUS_SRC_ALPHA;\n                }\n            }\n        }\n    },\n\n    /**\n     * to copy object with deep copy.\n     * returns a clone of action.\n     *\n     * @return {cc.ParticleSystem}\n     */\n    clone: function () {\n        var retParticle = new cc.ParticleSystem();\n\n        // self, not super\n        if (retParticle.initWithTotalParticles(this.getTotalParticles())) {\n            // angle\n            retParticle.setAngle(this.getAngle());\n            retParticle.setAngleVar(this.getAngleVar());\n\n            // duration\n            retParticle.setDuration(this.getDuration());\n\n            // blend function\n            var blend = this.getBlendFunc();\n            retParticle.setBlendFunc(blend.src, blend.dst);\n\n            // color\n            retParticle.setStartColor(this.getStartColor());\n\n            retParticle.setStartColorVar(this.getStartColorVar());\n\n            retParticle.setEndColor(this.getEndColor());\n\n            retParticle.setEndColorVar(this.getEndColorVar());\n\n            // this size\n            retParticle.setStartSize(this.getStartSize());\n            retParticle.setStartSizeVar(this.getStartSizeVar());\n            retParticle.setEndSize(this.getEndSize());\n            retParticle.setEndSizeVar(this.getEndSizeVar());\n\n            // position\n            retParticle.setPosition(cc.p(this.x, this.y));\n            retParticle.setPosVar(cc.p(this.getPosVar().x, this.getPosVar().y));\n\n            retParticle.setPositionType(this.getPositionType());\n\n            // Spinning\n            retParticle.setStartSpin(this.getStartSpin() || 0);\n            retParticle.setStartSpinVar(this.getStartSpinVar() || 0);\n            retParticle.setEndSpin(this.getEndSpin() || 0);\n            retParticle.setEndSpinVar(this.getEndSpinVar() || 0);\n\n            retParticle.setEmitterMode(this.getEmitterMode());\n\n            // Mode A: Gravity + tangential accel + radial accel\n            if (this.getEmitterMode() === cc.ParticleSystem.MODE_GRAVITY) {\n                // gravity\n                var gra = this.getGravity();\n                retParticle.setGravity(cc.p(gra.x, gra.y));\n\n                // speed\n                retParticle.setSpeed(this.getSpeed());\n                retParticle.setSpeedVar(this.getSpeedVar());\n\n                // radial acceleration\n                retParticle.setRadialAccel(this.getRadialAccel());\n                retParticle.setRadialAccelVar(this.getRadialAccelVar());\n\n                // tangential acceleration\n                retParticle.setTangentialAccel(this.getTangentialAccel());\n                retParticle.setTangentialAccelVar(this.getTangentialAccelVar());\n\n            } else if (this.getEmitterMode() === cc.ParticleSystem.MODE_RADIUS) {\n                // or Mode B: radius movement\n                retParticle.setStartRadius(this.getStartRadius());\n                retParticle.setStartRadiusVar(this.getStartRadiusVar());\n                retParticle.setEndRadius(this.getEndRadius());\n                retParticle.setEndRadiusVar(this.getEndRadiusVar());\n\n                retParticle.setRotatePerSecond(this.getRotatePerSecond());\n                retParticle.setRotatePerSecondVar(this.getRotatePerSecondVar());\n            }\n\n            // life span\n            retParticle.setLife(this.getLife());\n            retParticle.setLifeVar(this.getLifeVar());\n\n            // emission Rate\n            retParticle.setEmissionRate(this.getEmissionRate());\n\n            //don't get the internal texture if a batchNode is used\n            if (!this.getBatchNode()) {\n                // Set a compatible default for the alpha transfer\n                retParticle.setOpacityModifyRGB(this.isOpacityModifyRGB());\n                // texture\n                var texture = this.getTexture();\n                if (texture) {\n                    var size = texture.getContentSize();\n                    retParticle.setTextureWithRect(texture, cc.rect(0, 0, size.width, size.height));\n                }\n            }\n        }\n        return retParticle;\n    },\n\n    /**\n     * <p> Sets a new CCSpriteFrame as particle.</br>\n     * WARNING: this method is experimental. Use setTextureWithRect instead.\n     * </p>\n     * @param {cc.SpriteFrame} spriteFrame\n     */\n    setDisplayFrame: function (spriteFrame) {\n        if (!spriteFrame)\n            return;\n\n        var locOffset = spriteFrame.getOffsetInPixels();\n        if (locOffset.x !== 0 || locOffset.y !== 0)\n            cc.log(\"cc.ParticleSystem.setDisplayFrame(): QuadParticle only supports SpriteFrames with no offsets\");\n\n        // update texture before updating texture rect\n        var texture = spriteFrame.getTexture(), locTexture = this._texture;\n        if (locTexture !== texture)\n            this.setTexture(texture);\n    },\n\n    /**\n     *  Sets a new texture with a rect. The rect is in Points.\n     * @param {cc.Texture2D} texture\n     * @param {cc.Rect} rect\n     */\n    setTextureWithRect: function (texture, rect) {\n        var locTexture = this._texture;\n        if (locTexture !== texture) {\n            this._texture = texture;\n            this._updateBlendFunc();\n        }\n        this.initTexCoordsWithRect(rect);\n    },\n\n    /**\n     * listen the event that coming to foreground on Android  (An empty function for native)\n     * @param {cc.Class} obj\n     */\n    listenBackToForeground: function (obj) {\n        //do nothing\n    }\n});\n\nvar _p = cc.ParticleSystem.prototype;\n\n// Extended properties\n/** @expose */\n_p.opacityModifyRGB;\ncc.defineGetterSetter(_p, \"opacityModifyRGB\", _p.isOpacityModifyRGB, _p.setOpacityModifyRGB);\n/** @expose */\n_p.batchNode;\ncc.defineGetterSetter(_p, \"batchNode\", _p.getBatchNode, _p.setBatchNode);\n/** @expose */\n_p.drawMode;\ncc.defineGetterSetter(_p, \"drawMode\", _p.getDrawMode, _p.setDrawMode);\n/** @expose */\n_p.shapeType;\ncc.defineGetterSetter(_p, \"shapeType\", _p.getShapeType, _p.setShapeType);\n/** @expose */\n_p.active;\ncc.defineGetterSetter(_p, \"active\", _p.isActive);\n/** @expose */\n_p.sourcePos;\ncc.defineGetterSetter(_p, \"sourcePos\", _p.getSourcePosition, _p.setSourcePosition);\n/** @expose */\n_p.posVar;\ncc.defineGetterSetter(_p, \"posVar\", _p.getPosVar, _p.setPosVar);\n/** @expose */\n_p.gravity;\ncc.defineGetterSetter(_p, \"gravity\", _p.getGravity, _p.setGravity);\n/** @expose */\n_p.speed;\ncc.defineGetterSetter(_p, \"speed\", _p.getSpeed, _p.setSpeed);\n/** @expose */\n_p.speedVar;\ncc.defineGetterSetter(_p, \"speedVar\", _p.getSpeedVar, _p.setSpeedVar);\n/** @expose */\n_p.tangentialAccel;\ncc.defineGetterSetter(_p, \"tangentialAccel\", _p.getTangentialAccel, _p.setTangentialAccel);\n/** @expose */\n_p.tangentialAccelVar;\ncc.defineGetterSetter(_p, \"tangentialAccelVar\", _p.getTangentialAccelVar, _p.setTangentialAccelVar);\n/** @expose */\n_p.radialAccel;\ncc.defineGetterSetter(_p, \"radialAccel\", _p.getRadialAccel, _p.setRadialAccel);\n/** @expose */\n_p.radialAccelVar;\ncc.defineGetterSetter(_p, \"radialAccelVar\", _p.getRadialAccelVar, _p.setRadialAccelVar);\n/** @expose */\n_p.rotationIsDir;\ncc.defineGetterSetter(_p, \"rotationIsDir\", _p.getRotationIsDir, _p.setRotationIsDir);\n/** @expose */\n_p.startRadius;\ncc.defineGetterSetter(_p, \"startRadius\", _p.getStartRadius, _p.setStartRadius);\n/** @expose */\n_p.startRadiusVar;\ncc.defineGetterSetter(_p, \"startRadiusVar\", _p.getStartRadiusVar, _p.setStartRadiusVar);\n/** @expose */\n_p.endRadius;\ncc.defineGetterSetter(_p, \"endRadius\", _p.getEndRadius, _p.setEndRadius);\n/** @expose */\n_p.endRadiusVar;\ncc.defineGetterSetter(_p, \"endRadiusVar\", _p.getEndRadiusVar, _p.setEndRadiusVar);\n/** @expose */\n_p.rotatePerS;\ncc.defineGetterSetter(_p, \"rotatePerS\", _p.getRotatePerSecond, _p.setRotatePerSecond);\n/** @expose */\n_p.rotatePerSVar;\ncc.defineGetterSetter(_p, \"rotatePerSVar\", _p.getRotatePerSecondVar, _p.setRotatePerSecondVar);\n/** @expose */\n_p.startColor;\ncc.defineGetterSetter(_p, \"startColor\", _p.getStartColor, _p.setStartColor);\n/** @expose */\n_p.startColorVar;\ncc.defineGetterSetter(_p, \"startColorVar\", _p.getStartColorVar, _p.setStartColorVar);\n/** @expose */\n_p.endColor;\ncc.defineGetterSetter(_p, \"endColor\", _p.getEndColor, _p.setEndColor);\n/** @expose */\n_p.endColorVar;\ncc.defineGetterSetter(_p, \"endColorVar\", _p.getEndColorVar, _p.setEndColorVar);\n/** @expose */\n_p.totalParticles;\ncc.defineGetterSetter(_p, \"totalParticles\", _p.getTotalParticles, _p.setTotalParticles);\n/** @expose */\n_p.texture;\ncc.defineGetterSetter(_p, \"texture\", _p.getTexture, _p.setTexture);\n\n\n/**\n * <p> return the string found by key in dict. <br/>\n *    This plist files can be create manually or with Particle Designer:<br/>\n *    http://particledesigner.71squared.com/<br/>\n * </p>\n * @deprecated since v3.0 please use new cc.ParticleSysytem(plistFile) instead.\n * @param {String|Number} plistFile\n * @return {cc.ParticleSystem}\n */\ncc.ParticleSystem.create = function (plistFile) {\n    return new cc.ParticleSystem(plistFile);\n};\n\n/**\n * <p> return the string found by key in dict. <br/>\n *    This plist files can be create manually or with Particle Designer:<br/>\n *    http://particledesigner.71squared.com/<br/>\n * </p>\n * @deprecated since v3.0 please use new cc.ParticleSysytem(plistFile) instead.\n * @function\n * @param {String|Number} plistFile\n * @return {cc.ParticleSystem}\n */\ncc.ParticleSystem.createWithTotalParticles = cc.ParticleSystem.create;\n\n// Different modes\n/**\n * Mode A:Gravity + Tangential Accel + Radial Accel\n * @Class\n * @Construct\n * @param {cc.Point} [gravity=] Gravity value.\n * @param {Number} [speed=0] speed of each particle.\n * @param {Number} [speedVar=0] speed variance of each particle.\n * @param {Number} [tangentialAccel=0] tangential acceleration of each particle.\n * @param {Number} [tangentialAccelVar=0] tangential acceleration variance of each particle.\n * @param {Number} [radialAccel=0] radial acceleration of each particle.\n * @param {Number} [radialAccelVar=0] radial acceleration variance of each particle.\n * @param {boolean} [rotationIsDir=false]\n */\ncc.ParticleSystem.ModeA = function (gravity, speed, speedVar, tangentialAccel, tangentialAccelVar, radialAccel, radialAccelVar, rotationIsDir) {\n    /** Gravity value. Only available in 'Gravity' mode. */\n    this.gravity = gravity ? gravity : cc.p(0, 0);\n    /** speed of each particle. Only available in 'Gravity' mode.  */\n    this.speed = speed || 0;\n    /** speed variance of each particle. Only available in 'Gravity' mode. */\n    this.speedVar = speedVar || 0;\n    /** tangential acceleration of each particle. Only available in 'Gravity' mode. */\n    this.tangentialAccel = tangentialAccel || 0;\n    /** tangential acceleration variance of each particle. Only available in 'Gravity' mode. */\n    this.tangentialAccelVar = tangentialAccelVar || 0;\n    /** radial acceleration of each particle. Only available in 'Gravity' mode. */\n    this.radialAccel = radialAccel || 0;\n    /** radial acceleration variance of each particle. Only available in 'Gravity' mode. */\n    this.radialAccelVar = radialAccelVar || 0;\n    /** set the rotation of each particle to its direction Only available in 'Gravity' mode. */\n    this.rotationIsDir = rotationIsDir || false;\n};\n\n/**\n * Mode B: circular movement (gravity, radial accel and tangential accel don't are not used in this mode)\n * @Class\n * @Construct\n * @param {Number} [startRadius=0] The starting radius of the particles.\n * @param {Number} [startRadiusVar=0] The starting radius variance of the particles.\n * @param {Number} [endRadius=0] The ending radius of the particles.\n * @param {Number} [endRadiusVar=0] The ending radius variance of the particles.\n * @param {Number} [rotatePerSecond=0] Number of degrees to rotate a particle around the source pos per second.\n * @param {Number} [rotatePerSecondVar=0] Variance in degrees for rotatePerSecond.\n */\ncc.ParticleSystem.ModeB = function (startRadius, startRadiusVar, endRadius, endRadiusVar, rotatePerSecond, rotatePerSecondVar) {\n    /** The starting radius of the particles. Only available in 'Radius' mode. */\n    this.startRadius = startRadius || 0;\n    /** The starting radius variance of the particles. Only available in 'Radius' mode. */\n    this.startRadiusVar = startRadiusVar || 0;\n    /** The ending radius of the particles. Only available in 'Radius' mode. */\n    this.endRadius = endRadius || 0;\n    /** The ending radius variance of the particles. Only available in 'Radius' mode. */\n    this.endRadiusVar = endRadiusVar || 0;\n    /** Number of degress to rotate a particle around the source pos per second. Only available in 'Radius' mode. */\n    this.rotatePerSecond = rotatePerSecond || 0;\n    /** Variance in degrees for rotatePerSecond. Only available in 'Radius' mode. */\n    this.rotatePerSecondVar = rotatePerSecondVar || 0;\n};\n\n/**\n * Shape Mode of Particle Draw\n * @constant\n * @type Number\n */\ncc.ParticleSystem.SHAPE_MODE = 0;\n\n/**\n * Texture Mode of Particle Draw\n * @constant\n * @type Number\n */\ncc.ParticleSystem.TEXTURE_MODE = 1;\n\n/**\n * Star Shape for ShapeMode of Particle\n * @constant\n * @type Number\n */\ncc.ParticleSystem.STAR_SHAPE = 0;\n\n/**\n * Ball Shape for ShapeMode of Particle\n * @constant\n * @type Number\n */\ncc.ParticleSystem.BALL_SHAPE = 1;\n\n/**\n * The Particle emitter lives forever\n * @constant\n * @type Number\n */\ncc.ParticleSystem.DURATION_INFINITY = -1;\n\n/**\n * The starting size of the particle is equal to the ending size\n * @constant\n * @type Number\n */\ncc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE = -1;\n\n/**\n * The starting radius of the particle is equal to the ending radius\n * @constant\n * @type Number\n */\ncc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS = -1;\n\n/**\n * Gravity mode (A mode)\n * @constant\n * @type Number\n */\ncc.ParticleSystem.MODE_GRAVITY = 0;\n\n/**\n * Radius mode (B mode)\n * @constant\n * @type Number\n */\ncc.ParticleSystem.MODE_RADIUS = 1;\n\n/**\n * Living particles are attached to the world and are unaffected by emitter repositioning.\n * @constant\n * @type Number\n */\ncc.ParticleSystem.TYPE_FREE = 0;\n\n/**\n * Living particles are attached to the world but will follow the emitter repositioning.<br/>\n * Use case: Attach an emitter to an sprite, and you want that the emitter follows the sprite.\n * @constant\n * @type Number\n */\ncc.ParticleSystem.TYPE_RELATIVE = 1;\n\n/**\n * Living particles are attached to the emitter and are translated along with it.\n * @constant\n * @type Number\n */\ncc.ParticleSystem.TYPE_GROUPED = 2;\n"]}