{"version":3,"sources":["../../../../../../../../assets/frameworks/cocos2d-html5/extensions/gui/control-extension/assets/frameworks/cocos2d-html5/extensions/gui/control-extension/CCControlColourPicker.js"],"names":["cc","ControlColourPicker","Control","extend","_hsv","_colourPicker","_huePicker","_background","_className","ctor","prototype","call","init","hueSliderValueChanged","sender","controlEvent","h","getHue","rgb","ControlUtils","RGBfromHSV","setColor","color","r","g","b","sendActionsForControlEvents","CONTROL_EVENT_VALUECHANGED","_updateControlPicker","colourSliderValueChanged","s","getSaturation","v","getBrightness","rgba","RGBA","a","HSVfromRGB","_updateHueAndControlPicker","getBackground","spriteFrameCache","addSpriteFrames","res","CCControlColourPickerSpriteSheet_plist","spriteSheet","SpriteBatchNode","CCControlColourPickerSpriteSheet_png","addChild","HSV","addSpriteToTargetWithPosAndAnchor","p","backgroundPointZero","pSub","getPosition","getContentSize","width","height","hueShift","colourShift","ControlHuePicker","x","y","ControlSaturationBrightnessPicker","addTargetWithActionForControlEvents","setContentSize","setHue","updateWithHSV","updateDraggerWithHSV","setEnabled","enabled","onTouchBegan","_p","background","defineGetterSetter","create"],"mappings":"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","file":"CCControlColourPicker.js","sourceRoot":"../../../../../../../../assets/frameworks/cocos2d-html5/extensions/gui/control-extension","sourcesContent":["/**\n *\n * Copyright (c) 2008-2010 Ricardo Quesada\n * Copyright (c) 2011-2012 cocos2d-x.org\n * Copyright (c) 2013-2014 Chukong Technologies Inc.\n *\n * Copyright 2012 Stewart Hamilton-Arrandale.\n * http://creativewax.co.uk\n *\n * Modified by Yannick Loriot.\n * http://yannickloriot.com\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE. *\n *\n */\n\n/**\n * ControlColourPicker: color picker ui component.\n * @class\n * @extends cc.Control\n *\n * @property {cc.Sprite}  background   - <@readonly> The background sprite\n */\ncc.ControlColourPicker = cc.Control.extend(/** @lends cc.ControlColourPicker# */{\n    _hsv:null,\n    _colourPicker:null,\n    _huePicker:null,\n\n    _background:null,\n    _className:\"ControlColourPicker\",\n    ctor:function () {\n        cc.Control.prototype.ctor.call(this);\n        this.init();\n    },\n    hueSliderValueChanged:function (sender, controlEvent) {\n        this._hsv.h = sender.getHue();\n\n        // Update the value\n        var rgb = cc.ControlUtils.RGBfromHSV(this._hsv);\n        cc.Control.prototype.setColor.call(this,cc.color(0 | (rgb.r * 255), 0 | (rgb.g * 255), 0 | (rgb.b * 255)));\n\n        // Send CCControl callback\n        this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);\n        this._updateControlPicker();\n    },\n\n    colourSliderValueChanged:function (sender, controlEvent) {\n        this._hsv.s = sender.getSaturation();\n        this._hsv.v = sender.getBrightness();\n\n\n        // Update the value\n        var rgb = cc.ControlUtils.RGBfromHSV(this._hsv);\n        cc.Control.prototype.setColor.call(this,cc.color(0 | (rgb.r * 255), 0 | (rgb.g * 255), 0 | (rgb.b * 255)));\n\n        // Send CCControl callback\n        this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);\n    },\n\n    setColor:function (color) {\n        cc.Control.prototype.setColor.call(this,color);\n        //this._colorValue = color;\n        var rgba = new cc.RGBA();\n        rgba.r = color.r / 255.0;\n        rgba.g = color.g / 255.0;\n        rgba.b = color.b / 255.0;\n        rgba.a = 1.0;\n\n        this._hsv = cc.ControlUtils.HSVfromRGB(rgba);\n        this._updateHueAndControlPicker();\n    },\n\n    getBackground:function () {\n        return this._background;\n    },\n\n    init:function () {\n        if (cc.Control.prototype.init.call(this)) {\n            // Cache the sprites\n            cc.spriteFrameCache.addSpriteFrames(res.CCControlColourPickerSpriteSheet_plist);\n\n            // Create the sprite batch node\n            var spriteSheet = new cc.SpriteBatchNode(res.CCControlColourPickerSpriteSheet_png);\n            this.addChild(spriteSheet);\n\n          /*// MIPMAP\n            //TODO WebGL code\n            var params = [gl.LINEAR_MIPMAP_NEAREST, gl.LINEAR, gl.REPEAT, gl.CLAMP_TO_EDGE];\n            spriteSheet.getTexture().setAliasTexParameters();\n            spriteSheet.getTexture().setTexParameters(params);\n            spriteSheet.getTexture().generateMipmap();*/\n\n            // Init default color\n            this._hsv = new cc.HSV(0, 0, 0);\n\n            // Add image\n            this._background = cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(\"menuColourPanelBackground.png\", spriteSheet, cc.p(0,0), cc.p(0.5, 0.5));\n\n            var backgroundPointZero = cc.pSub(this._background.getPosition(),\n                cc.p(this._background.getContentSize().width / 2, this._background.getContentSize().height / 2));\n\n            // Setup panels . currently hard-coded...\n            var hueShift = 8;\n            var colourShift = 28;\n\n            this._huePicker = new cc.ControlHuePicker(spriteSheet, cc.p(backgroundPointZero.x + hueShift, backgroundPointZero.y + hueShift));\n            this._colourPicker = new cc.ControlSaturationBrightnessPicker(spriteSheet, cc.p(backgroundPointZero.x + colourShift, backgroundPointZero.y + colourShift));\n\n            // Setup events\n            this._huePicker.addTargetWithActionForControlEvents(this, this.hueSliderValueChanged, cc.CONTROL_EVENT_VALUECHANGED);\n            this._colourPicker.addTargetWithActionForControlEvents(this, this.colourSliderValueChanged, cc.CONTROL_EVENT_VALUECHANGED);\n\n            // Set defaults\n            this._updateHueAndControlPicker();\n            this.addChild(this._huePicker);\n            this.addChild(this._colourPicker);\n\n            // Set content size\n            this.setContentSize(this._background.getContentSize());\n            return true;\n        }\n        else\n            return false;\n    },\n\n    _updateControlPicker:function () {\n        this._huePicker.setHue(this._hsv.h);\n        this._colourPicker.updateWithHSV(this._hsv);\n    },\n\n    _updateHueAndControlPicker:function () {\n        this._huePicker.setHue(this._hsv.h);\n        this._colourPicker.updateWithHSV(this._hsv);\n        this._colourPicker.updateDraggerWithHSV(this._hsv);\n    },\n    setEnabled:function (enabled) {\n        cc.Control.prototype.setEnabled.call(this, enabled);\n        if (this._huePicker !== null) {\n            this._huePicker.setEnabled(enabled);\n        }\n        if (this._colourPicker) {\n            this._colourPicker.setEnabled(enabled);\n        }\n    },\n    onTouchBegan:function () {\n        //ignore all touches, handled by children\n        return false;\n    }\n});\n\nvar _p = cc.ControlColourPicker.prototype;\n\n// Extended properties\n/** @expose */\n_p.background;\ncc.defineGetterSetter(_p, \"background\", _p.getBackground);\n\n_p = null;\n\n/**\n * @deprecated\n * @returns {ControlColourPicker}\n */\ncc.ControlColourPicker.create = function () {\n    return new cc.ControlColourPicker();\n};\n\n// compatible with NPM\nvar res = res || {};\nres.CCControlColourPickerSpriteSheet_plist = res.CCControlColourPickerSpriteSheet_plist || \"res/extensions/CCControlColourPickerSpriteSheet.plist\";\nres.CCControlColourPickerSpriteSheet_png = res.CCControlColourPickerSpriteSheet_png || \"res/extensions/CCControlColourPickerSpriteSheet.png\";"]}