{"version":3,"sources":["../../../../../../../../../assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/jsb_prepare.js"],"names":["window","cc","jsb","container","each","obj","iterator","context","Array","i","li","length","call","key","extend","target","sources","arguments","prototype","slice","src","hasOwnProperty","isFunction","isNumber","Object","toString","isString","isArray","isUndefined","isObject","isCrossOrigin","url","defineGetterSetter","proto","prop","getter","setter","desc","enumerable","configurable","get","set","defineProperty","associateWithNative","jsobj","superclass_or_instance","inherits","childCtor","parentCtor","tempCtor","superClass_","constructor","base","me","opt_methodName","var_args","caller","callee","ret","apply","args","foundCaller","ctor","Error","ClassManager","id","Math","random","instanceId","getNewID","getNewInstanceId","Class","_super","classId","className","_className","name","initializing","create","fnTest","test","xyz","fn","tmp","__instanceId","writable","value","registerNativeRef","owner","refs","__nativeRefs","index","indexOf","push","unregisterNativeRef","splice","unregisterAllNativeRefs","unregisterChildRefsForNode","node","recursive","Node","children","getChildren","l","child"],"mappings":"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","file":"jsb_prepare.js","sourceRoot":"../../../../../../../../../assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script","sourcesContent":["/*\n * Copyright (c) 2014-2016 Chukong Technologies Inc.\n * Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n// Prepare JSB environment\n\nvar window = window || this;\nvar cc = cc || {};\n/**\n * @namespace jsb\n * @name jsb\n */\nvar jsb = jsb || {};\n\n/**\n * The element contains the game canvas\n * @type {HTMLDivElement}\n */\ncc.container = null;\n\n/**\n * Iterate over an object or an array, executing a function for each matched element.\n * @param {object|array} obj\n * @param {function} iterator\n * @param {object} [context]\n */\ncc.each = function (obj, iterator, context) {\n    if (!obj)\n        return;\n    if (obj instanceof Array) {\n        for (var i = 0, li = obj.length; i < li; i++) {\n            if (iterator.call(context, obj[i], i) === false)\n                return;\n        }\n    } else {\n        for (var key in obj) {\n            if (iterator.call(context, obj[key], key) === false)\n                return;\n        }\n    }\n};\n\n/**\n * Copy all of the properties in source objects to target object and return the target object.\n * @param {object} target\n * @param {object} *sources\n * @returns {object}\n */\ncc.extend = function(target) {\n    var sources = arguments.length >= 2 ? Array.prototype.slice.call(arguments, 1) : [];\n\n    cc.each(sources, function(src) {\n        for(var key in src) {\n            if (src.hasOwnProperty(key)) {\n                target[key] = src[key];\n            }\n        }\n    });\n    return target;\n};\n\n/**\n * Check the obj whether is function or not\n * @param {*} obj\n * @returns {boolean}\n */\ncc.isFunction = function(obj) {\n    return typeof obj == 'function';\n};\n\n/**\n * Check the obj whether is number or not\n * @param {*} obj\n * @returns {boolean}\n */\ncc.isNumber = function(obj) {\n    return typeof obj == 'number' || Object.prototype.toString.call(obj) == '[object Number]';\n};\n\n/**\n * Check the obj whether is string or not\n * @param {*} obj\n * @returns {boolean}\n */\ncc.isString = function(obj) {\n    return typeof obj == 'string' || Object.prototype.toString.call(obj) == '[object String]';\n};\n\n/**\n * Check the obj whether is array or not\n * @param {*} obj\n * @returns {boolean}\n */\ncc.isArray = function(obj) {\n    return Array.isArray(obj) ||\n        (typeof obj === 'object' && Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n/**\n * Check the obj whether is undefined or not\n * @param {*} obj\n * @returns {boolean}\n */\ncc.isUndefined = function(obj) {\n    return typeof obj === 'undefined';\n};\n\n/**\n * Check the obj whether is object or not\n * @param {*} obj\n * @returns {boolean}\n */\ncc.isObject = function(obj) {\n    return ( obj !== null && typeof obj === \"object\" );\n};\n\n/**\n * Check the url whether cross origin\n * @param {String} url\n * @returns {boolean}\n */\ncc.isCrossOrigin = function (url) {\n    return false;\n};\n\n/**\n * Common getter setter configuration function\n * @function\n * @param {Object}   proto      A class prototype or an object to config\n * @param {String}   prop       Property name\n * @param {function} getter     Getter function for the property\n * @param {function} setter     Setter function for the property\n */\ncc.defineGetterSetter = function (proto, prop, getter, setter){\n    var desc = { enumerable: false, configurable: true };\n    getter && (desc.get = getter);\n    setter && (desc.set = setter);\n    Object.defineProperty(proto, prop, desc);\n};\n\n/**\n * Associates a base class with a native superclass\n * @function\n * @param {object} jsobj subclass\n * @param {object} klass superclass\n */\ncc.associateWithNative = function( jsobj, superclass_or_instance ) {};\n\n//\n// JSB supports 2 official ways to create subclasses\n//\n// 1) Google \"subclasses\" borrowed from closure library\n// This is the recommended way to do it\n//\ncc.inherits = function (childCtor, parentCtor) {\n    /** @constructor */\n    function tempCtor() {};\n    tempCtor.prototype = parentCtor.prototype;\n    childCtor.superClass_ = parentCtor.prototype;\n    childCtor.prototype = new tempCtor();\n    childCtor.prototype.constructor = childCtor;\n\n    // Copy \"static\" method, but doesn't generate subclasses.\n//  for( var i in parentCtor ) {\n//      childCtor[ i ] = parentCtor[ i ];\n//  }\n};\ncc.base = function(me, opt_methodName, var_args) {\n    var caller = arguments.callee.caller;\n    if (caller.superClass_) {\n        // This is a constructor. Call the superclass constructor.\n        ret =  caller.superClass_.constructor.apply( me, Array.prototype.slice.call(arguments, 1));\n        return ret;\n    }\n\n    var args = Array.prototype.slice.call(arguments, 2);\n    var foundCaller = false;\n    for (var ctor = me.constructor;\n        ctor; ctor = ctor.superClass_ && ctor.superClass_.constructor) {\n        if (ctor.prototype[opt_methodName] === caller) {\n            foundCaller = true;\n        } else if (foundCaller) {\n            return ctor.prototype[opt_methodName].apply(me, args);\n        }\n    }\n\n    // If we did not find the caller in the prototype chain,\n    // then one of two things happened:\n    // 1) The caller is an instance method.\n    // 2) This method was not called by the right caller.\n    if (me[opt_methodName] === caller) {\n        return me.constructor.prototype[opt_methodName].apply(me, args);\n    } else {\n        throw Error(\n                    'cc.base called from a method of one name ' +\n                    'to a method of a different name');\n    }\n};\n\n\nvar ClassManager = {\n    id : (0|(Math.random()*998)),\n\n    instanceId : (0|(Math.random()*998)),\n\n    getNewID : function(){\n        return this.id++;\n    },\n\n    getNewInstanceId : function(){\n        return this.instanceId++;\n    }\n};\n//\n// 2) Using \"extend\" subclassing\n// Simple JavaScript Inheritance By John Resig http://ejohn.org/\n//\ncc.Class = function(){};\ncc.Class.extend = function (prop) {\n    var _super = this.prototype,\n        prototype, Class, classId,\n        className = prop._className || \"\",\n        name, desc;\n\n    // Instantiate a base class (but only create the instance,\n    // don't run the init constructor)\n    initializing = true;\n    prototype = Object.create(_super);\n    initializing = false;\n    fnTest = /xyz/.test(function(){xyz;}) ? /\\b_super\\b/ : /.*/;\n\n    // Copy the properties over onto the new prototype\n    for (name in prop) {\n        // Check if we're overwriting an existing function\n        prototype[name] = typeof prop[name] == \"function\" &&\n            typeof _super[name] == \"function\" && fnTest.test(prop[name]) ?\n            (function (name, fn) {\n                return function () {\n                    var tmp = this._super;\n\n                    // Add a new ._super() method that is the same method\n                    // but on the super-class\n                    this._super = _super[name];\n\n                    // The method only need to be bound temporarily, so we\n                    // remove it when we're done executing\n                    var ret = fn.apply(this, arguments);\n                    this._super = tmp;\n\n                    return ret;\n                };\n            })(name, prop[name]) :\n            prop[name];\n    }\n\n    Class = function () {\n        if (!initializing) {\n            this.__instanceId = ClassManager.getNewInstanceId();\n            this.ctor && this.ctor.apply(this, arguments);\n        }\n    };\n    // Populate our constructed prototype object\n    Class.prototype = prototype;\n    // Enforce the constructor to be what we expect\n    Class.prototype.constructor = Class;\n    // And make this class extendable\n    Class.extend = cc.Class.extend;\n\n    classId = ClassManager.getNewID();\n    ClassManager[classId] = _super;\n    desc = { writable: true, enumerable: false, configurable: true };\n    Class.id = classId;\n    desc.value = classId;\n    Object.defineProperty(prototype, '__pid', desc);\n\n    return Class;\n};\n\njsb.registerNativeRef = function (owner, target) {\n    if (owner && target && owner !== target) {\n        var refs = owner.__nativeRefs;\n        if (!refs) {\n            refs = owner.__nativeRefs = [];\n        }\n        var index = refs.indexOf(target);\n        if (index === -1) {\n            owner.__nativeRefs.push(target);\n        }\n    }\n};\n\njsb.unregisterNativeRef = function (owner, target) {\n    if (owner && target && owner !== target) {\n        var refs = owner.__nativeRefs;\n        if (!refs) {\n            return;\n        }\n        var index = refs.indexOf(target);\n        if (index !== -1) {\n            owner.__nativeRefs.splice(index, 1);\n        }\n    }\n};\n\njsb.unregisterAllNativeRefs = function (owner) {\n    if (!owner) return;\n    owner.__nativeRefs.length = 0;\n};\n\njsb.unregisterChildRefsForNode = function (node, recursive) {\n    if (!(node instanceof cc.Node)) return;\n    recursive = !!recursive;\n    var children = node.getChildren(), i, l, child;\n    for (i = 0, l = children.length; i < l; ++i) {\n        child = children[i];\n        jsb.unregisterNativeRef(node, child);\n        if (recursive) {\n            jsb.unregisterChildRefsForNode(child, recursive);\n        }\n    }\n};\n"]}