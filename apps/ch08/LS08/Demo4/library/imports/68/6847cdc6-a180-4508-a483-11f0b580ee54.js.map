{"version":3,"sources":["../../../../../../../../../assets/frameworks/cocos2d-html5/extensions/cocostudio/armature/animation/assets/frameworks/cocos2d-html5/extensions/cocostudio/armature/animation/CCTween.js"],"names":["ccs","Tween","ProcessBase","extend","_tweenData","_to","_from","_between","_movementBoneData","_bone","_frameTweenEasing","_betweenDuration","_totalDuration","_toIndex","_fromIndex","_animation","_passLastFrame","ctor","bone","prototype","call","TweenType","LINEAR","init","FrameData","getTweenData","displayIndex","getArmature","getAnimation","play","movementBoneData","durationTo","durationTween","loop","tweenEasing","_loopType","ANIMATION_TYPE_TO_LOOP_FRONT","ANIMATION_TYPE_NO_LOOP","difMovement","setMovementBoneData","_rawDuration","duration","nextKeyFrame","getFrameData","getArmatureData","dataVersion","CONST_VERSION_COMBINED","TransformHelp","nodeSub","getBoneData","scaleX","scaleY","ANIMATION_TYPE_SINGLE_FRAME","setBetween","frameList","length","_durationTween","scale","delay","tweenNodeTo","updateFrameData","gotoAndPlay","frameIndex","gotoFrame","_isPlaying","_isComplete","_isPause","_currentPercent","_curFrameIndex","_currentFrame","_nextFrameIndex","gotoAndPause","pause","updateHandler","locCurrentPercent","locLoopType","ANIMATION_TYPE_MAX","ANIMATION_TYPE_LOOP_FRONT","fmodf","ANIMATION_TYPE_TO_LOOP_BACK","Math","sin","cc","PI","TWEEN_EASING_MAX","from","to","limit","undefined","copy","subtract","isTween","arriveKeyFrame","keyFrameData","locBone","displayManager","getDisplayManager","getForceChangeDisplay","changeDisplayWithIndex","zOrder","updateZOrder","setBlendFunc","blendFunc","childAramture","getChildArmature","movement","percent","node","locFrom","locBetween","x","y","skewX","skewY","setTransformDirty","isUseColorInfo","tweenColorTo","a","r","g","b","updateColor","currentPercent","playedTime","locTotalDuration","locBetweenDuration","locToIndex","frames","frameID","strEvent","isIgnoreFrameEvent","frameEvent","tweenType","_tweenEasing","TweenFunction","tweenTo","easingParams","setAnimation","animation","data","_p","defineGetterSetter","create"],"mappings":"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","file":"CCTween.js","sourceRoot":"../../../../../../../../../assets/frameworks/cocos2d-html5/extensions/cocostudio/armature/animation","sourcesContent":["/****************************************************************************\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * The tween class for Armature.\n * @class\n * @extends ccs.ProcessBase\n *\n * @param {ccs.Bone} The bone to be animated\n *\n * @property {ccs.ArmatureAnimation}    animation   - The animation\n */\nccs.Tween = ccs.ProcessBase.extend(/** @lends ccs.Tween# */{\n    _tweenData:null,\n    _to:null,\n    _from:null,\n    _between:null,\n    _movementBoneData:null,\n    _bone:null,\n    _frameTweenEasing:0,\n    _betweenDuration:0,\n    _totalDuration:0,\n    _toIndex:0,\n    _fromIndex:0,\n    _animation:null,\n    _passLastFrame:false,\n\n    ctor:function (bone) {\n        ccs.ProcessBase.prototype.ctor.call(this);\n        this._frameTweenEasing = ccs.TweenType.LINEAR;\n\n        ccs.Tween.prototype.init.call(this, bone);\n    },\n\n    /**\n     * initializes a ccs.Tween with a CCBone\n     * @param {ccs.Bone} bone\n     * @return {Boolean}\n     */\n    init:function (bone) {\n        this._from = new ccs.FrameData();\n        this._between = new ccs.FrameData();\n\n        this._bone = bone;\n        this._tweenData = this._bone.getTweenData();\n        this._tweenData.displayIndex = -1;\n\n        this._animation = (this._bone !== null && this._bone.getArmature() !== null) ?\n            this._bone.getArmature().getAnimation() :\n            null;\n        return true;\n    },\n\n    /**\n     * Plays the tween.\n     * @param {ccs.MovementBoneData} movementBoneData\n     * @param {Number} durationTo\n     * @param {Number} durationTween\n     * @param {Boolean} loop\n     * @param {ccs.TweenType} tweenEasing\n     */\n    play:function (movementBoneData, durationTo, durationTween, loop, tweenEasing) {\n        ccs.ProcessBase.prototype.play.call(this, durationTo, durationTween, loop, tweenEasing);\n        this._loopType = (loop)?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP;\n\n        this._totalDuration = 0;\n        this._betweenDuration = 0;\n        this._fromIndex = this._toIndex = 0;\n\n        var difMovement = movementBoneData !== this._movementBoneData;\n\n        this.setMovementBoneData(movementBoneData);\n        this._rawDuration = this._movementBoneData.duration;\n\n        var nextKeyFrame = this._movementBoneData.getFrameData(0);\n        this._tweenData.displayIndex = nextKeyFrame.displayIndex;\n\n        if (this._bone.getArmature().getArmatureData().dataVersion >= ccs.CONST_VERSION_COMBINED)        {\n            ccs.TransformHelp.nodeSub(this._tweenData, this._bone.getBoneData());\n            this._tweenData.scaleX += 1;\n            this._tweenData.scaleY += 1;\n        }\n\n        if (this._rawDuration === 0) {\n            this._loopType = ccs.ANIMATION_TYPE_SINGLE_FRAME;\n            if (durationTo === 0)\n                this.setBetween(nextKeyFrame, nextKeyFrame);\n            else\n                this.setBetween(this._tweenData, nextKeyFrame);\n            this._frameTweenEasing = ccs.TweenType.LINEAR;\n        }\n        else if (this._movementBoneData.frameList.length > 1) {\n            this._durationTween = durationTween * this._movementBoneData.scale;\n            if (loop && this._movementBoneData.delay !== 0)\n                this.setBetween(this._tweenData, this.tweenNodeTo(this.updateFrameData(1 - this._movementBoneData.delay), this._between));\n            else {\n                if (!difMovement || durationTo === 0)\n                    this.setBetween(nextKeyFrame, nextKeyFrame);\n                else\n                    this.setBetween(this._tweenData, nextKeyFrame);\n            }\n        }\n        this.tweenNodeTo(0);\n    },\n\n    /**\n     * Goes to specified frame and plays frame.\n     * @param {Number} frameIndex\n     */\n    gotoAndPlay: function (frameIndex) {\n        ccs.ProcessBase.prototype.gotoFrame.call(this, frameIndex);\n\n        this._totalDuration = 0;\n        this._betweenDuration = 0;\n        this._fromIndex = this._toIndex = 0;\n\n        this._isPlaying = true;\n        this._isComplete = this._isPause = false;\n\n        this._currentPercent = this._curFrameIndex / (this._rawDuration-1);\n        this._currentFrame = this._nextFrameIndex * this._currentPercent;\n    },\n\n    /**\n     * Goes to specified frame and pauses frame.\n     * @param {Number} frameIndex\n     */\n    gotoAndPause: function (frameIndex) {\n        this.gotoAndPlay(frameIndex);\n        this.pause();\n    },\n\n    /**\n     * update will call this handler, you can handle your logic here\n     */\n    updateHandler:function () {\n        var locCurrentPercent = this._currentPercent == null ? 1 : this._currentPercent;\n        var locLoopType = this._loopType;\n        if (locCurrentPercent >= 1) {\n            switch (locLoopType) {\n                case ccs.ANIMATION_TYPE_SINGLE_FRAME:\n                    locCurrentPercent = 1;\n                    this._isComplete = true;\n                    this._isPlaying = false;\n                    break;\n                case ccs.ANIMATION_TYPE_NO_LOOP:\n                    locLoopType = ccs.ANIMATION_TYPE_MAX;\n                    if (this._durationTween <= 0)\n                        locCurrentPercent = 1;\n                    else\n                        locCurrentPercent = (locCurrentPercent - 1) * this._nextFrameIndex / this._durationTween;\n                    if (locCurrentPercent >= 1) {\n                        locCurrentPercent = 1;\n                        this._isComplete = true;\n                        this._isPlaying = false;\n                        break;\n                    } else {\n                        this._nextFrameIndex = this._durationTween;\n                        this._currentFrame = locCurrentPercent * this._nextFrameIndex;\n                        this._totalDuration = 0;\n                        this._betweenDuration = 0;\n                        this._fromIndex = this._toIndex = 0;\n                        break;\n                    }\n                case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:\n                    locLoopType = ccs.ANIMATION_TYPE_LOOP_FRONT;\n                    this._nextFrameIndex = this._durationTween > 0 ? this._durationTween : 1;\n\n                    if (this._movementBoneData.delay !== 0) {\n                        this._currentFrame = (1 - this._movementBoneData.delay) * this._nextFrameIndex;\n                        locCurrentPercent = this._currentFrame / this._nextFrameIndex;\n                    } else {\n                        locCurrentPercent = 0;\n                        this._currentFrame = 0;\n                    }\n\n                    this._totalDuration = 0;\n                    this._betweenDuration = 0;\n                    this._fromIndex = this._toIndex = 0;\n                    break;\n                case ccs.ANIMATION_TYPE_MAX:\n                    locCurrentPercent = 1;\n                    this._isComplete = true;\n                    this._isPlaying = false;\n                    break;\n                default:\n                    this._currentFrame = ccs.fmodf(this._currentFrame, this._nextFrameIndex);\n                    break;\n            }\n        }\n\n        if (locCurrentPercent < 1 && locLoopType < ccs.ANIMATION_TYPE_TO_LOOP_BACK)\n            locCurrentPercent = Math.sin(locCurrentPercent * cc.PI / 2);\n\n        this._currentPercent = locCurrentPercent;\n        this._loopType = locLoopType;\n\n        if (locLoopType > ccs.ANIMATION_TYPE_TO_LOOP_BACK)\n            locCurrentPercent = this.updateFrameData(locCurrentPercent);\n        if (this._frameTweenEasing !== ccs.TweenType.TWEEN_EASING_MAX)\n            this.tweenNodeTo(locCurrentPercent);\n    },\n\n    /**\n     * Calculate the between value of _from and _to, and give it to between frame data\n     * @param {ccs.FrameData} from\n     * @param {ccs.FrameData} to\n     * @param {Boolean} [limit=true]\n     */\n    setBetween:function (from, to, limit) {   //TODO set tweenColorTo to protected in v3.1\n        if(limit === undefined)\n            limit = true;\n        do {\n            if (from.displayIndex < 0 && to.displayIndex >= 0) {\n                this._from.copy(to);\n                this._between.subtract(to, to, limit);\n                break;\n            }\n            if (to.displayIndex < 0 && from.displayIndex >= 0) {\n                this._from.copy(from);\n                this._between.subtract(to, to, limit);\n                break;\n            }\n            this._from.copy(from);\n            this._between.subtract(from, to, limit);\n        } while (0);\n        if (!from.isTween){\n            this._tweenData.copy(from);\n            this._tweenData.isTween = true;\n        }\n        this.arriveKeyFrame(from);\n    },\n\n    /**\n     * Update display index and process the key frame event when arrived a key frame\n     * @param {ccs.FrameData} keyFrameData\n     */\n    arriveKeyFrame:function (keyFrameData) {                         //TODO set tweenColorTo to protected in v3.1\n        if (keyFrameData) {\n            var locBone = this._bone;\n            var displayManager = locBone.getDisplayManager();\n\n            //! Change bone's display\n            var displayIndex = keyFrameData.displayIndex;\n\n            if (!displayManager.getForceChangeDisplay())\n                displayManager.changeDisplayWithIndex(displayIndex, false);\n\n            //! Update bone zorder, bone's zorder is determined by frame zorder and bone zorder\n            this._tweenData.zOrder = keyFrameData.zOrder;\n            locBone.updateZOrder();\n\n            //! Update blend type\n            this._bone.setBlendFunc(keyFrameData.blendFunc);\n\n            var childAramture = locBone.getChildArmature();\n            if (childAramture) {\n                if (keyFrameData.movement !== \"\")\n                    childAramture.getAnimation().play(keyFrameData.movement);\n            }\n        }\n    },\n\n    /**\n     * According to the percent to calculate current CCFrameData with tween effect\n     * @param {Number} percent\n     * @param {ccs.FrameData} [node]\n     * @return {ccs.FrameData}\n     */\n    tweenNodeTo:function (percent, node) {         //TODO set tweenColorTo to protected in v3.1\n        if (!node)\n            node = this._tweenData;\n\n        var locFrom = this._from;\n        var locBetween = this._between;\n        if (!locFrom.isTween)\n            percent = 0;\n        node.x = locFrom.x + percent * locBetween.x;\n        node.y = locFrom.y + percent * locBetween.y;\n        node.scaleX = locFrom.scaleX + percent * locBetween.scaleX;\n        node.scaleY = locFrom.scaleY + percent * locBetween.scaleY;\n        node.skewX = locFrom.skewX + percent * locBetween.skewX;\n        node.skewY = locFrom.skewY + percent * locBetween.skewY;\n\n        this._bone.setTransformDirty(true);\n        if (node && locBetween.isUseColorInfo)\n            this.tweenColorTo(percent, node);\n\n        return node;\n    },\n\n    /**\n     * According to the percent to calculate current color with tween effect\n     * @param {Number} percent\n     * @param {ccs.FrameData} node\n     */\n    tweenColorTo:function(percent,node){    //TODO set tweenColorTo to protected in v3.1\n        var locFrom = this._from;\n        var locBetween = this._between;\n        node.a = locFrom.a + percent * locBetween.a;\n        node.r = locFrom.r + percent * locBetween.r;\n        node.g = locFrom.g + percent * locBetween.g;\n        node.b = locFrom.b + percent * locBetween.b;\n        this._bone.updateColor();\n    },\n\n    /**\n     * Calculate which frame arrived, and if current frame have event, then call the event listener\n     * @param {Number} currentPercent\n     * @return {Number}\n     */\n    updateFrameData:function (currentPercent) {                             //TODO set tweenColorTo to protected in v3.1\n        if (currentPercent > 1 && this._movementBoneData.delay !== 0)\n            currentPercent = ccs.fmodf(currentPercent,1);\n\n        var playedTime = (this._rawDuration-1) * currentPercent;\n\n        var from, to;\n        var locTotalDuration = this._totalDuration,locBetweenDuration = this._betweenDuration, locToIndex = this._toIndex;\n        // if play to current frame's front or back, then find current frame again\n        if (playedTime < locTotalDuration || playedTime >= locTotalDuration + locBetweenDuration) {\n            /*\n             *  get frame length, if this._toIndex >= _length, then set this._toIndex to 0, start anew.\n             *  this._toIndex is next index will play\n             */\n            var frames = this._movementBoneData.frameList;\n            var length = frames.length;\n\n            if (playedTime < frames[0].frameID){\n                from = to = frames[0];\n                this.setBetween(from, to);\n                return this._currentPercent;\n            }\n\n            if (playedTime >= frames[length - 1].frameID) {\n                // If _passLastFrame is true and playedTime >= frames[length - 1]->frameID, then do not need to go on.\n                if (this._passLastFrame) {\n                    from = to = frames[length - 1];\n                    this.setBetween(from, to);\n                    return this._currentPercent;\n                }\n                this._passLastFrame = true;\n            } else\n                this._passLastFrame = false;\n\n            do {\n                this._fromIndex = locToIndex;\n                from = frames[this._fromIndex];\n                locTotalDuration = from.frameID;\n\n                locToIndex = this._fromIndex + 1;\n                if (locToIndex >= length)\n                    locToIndex = 0;\n                to = frames[locToIndex];\n\n                //! Guaranteed to trigger frame event\n                if(from.strEvent && !this._animation.isIgnoreFrameEvent())\n                    this._animation.frameEvent(this._bone, from.strEvent,from.frameID, playedTime);\n\n                if (playedTime === from.frameID|| (this._passLastFrame && this._fromIndex === length-1))\n                    break;\n            } while  (playedTime < from.frameID || playedTime >= to.frameID);\n\n            locBetweenDuration = to.frameID - from.frameID;\n            this._frameTweenEasing = from.tweenEasing;\n            this.setBetween(from, to, false);\n\n            this._totalDuration = locTotalDuration;\n            this._betweenDuration = locBetweenDuration;\n            this._toIndex = locToIndex;\n        }\n        currentPercent = locBetweenDuration === 0 ? 0 : (playedTime - this._totalDuration) / this._betweenDuration;\n\n        /*\n         *  if frame tween easing equal to TWEEN_EASING_MAX, then it will not do tween.\n         */\n        var tweenType = (this._frameTweenEasing !== ccs.TweenType.LINEAR) ? this._frameTweenEasing : this._tweenEasing;\n        if (tweenType !== ccs.TweenType.TWEEN_EASING_MAX && tweenType !== ccs.TweenType.LINEAR && !this._passLastFrame) {\n            currentPercent = ccs.TweenFunction.tweenTo(currentPercent, tweenType, this._from.easingParams);\n        }\n        return currentPercent;\n    },\n\n    /**\n     * Sets Armature animation to ccs.Tween.\n     * @param {ccs.ArmatureAnimation} animation\n     */\n    setAnimation:function (animation) {\n        this._animation = animation;\n    },\n\n    /**\n     * Returns Armature animation of ccs.Tween.\n     * @return {ccs.ArmatureAnimation}\n     */\n    getAnimation:function () {\n        return this._animation;\n    },\n\n    /**\n     * Sets movement bone data to ccs.Tween.\n     * @param data\n     */\n    setMovementBoneData: function(data){\n        this._movementBoneData = data;\n    }\n});\n\nvar _p = ccs.Tween.prototype;\n\n// Extended properties\n/** @expose */\n_p.animation;\ncc.defineGetterSetter(_p, \"animation\", _p.getAnimation, _p.setAnimation);\n\n_p = null;\n\n/**\n * Allocates and initializes a ArmatureAnimation.\n * @param {ccs.Bone} bone\n * @return {ccs.Tween}\n * @deprecated since v3.1, please use new construction instead\n */\nccs.Tween.create = function (bone) {\n    return new ccs.Tween(bone);\n};\n"]}