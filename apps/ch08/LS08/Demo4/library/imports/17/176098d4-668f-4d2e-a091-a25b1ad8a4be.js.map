{"version":3,"sources":["../../../../../../../../../../../assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/studio/parsers/assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/studio/parsers/scene-1.x.js"],"names":["load","baseParser","Parser","extend","getNodeJson","json","parseNode","resourcePath","parser","parsers","getClass","node","call","cc","log","deferred","file","ccs","triggerManager","parse","sceneReader","_node","setPropertyFromJsonDict","x","isUndefined","y","setPosition","bVisible","Boolean","setVisible","nTag","setTag","nZorder","setLocalZOrder","fScaleX","fScaleY","setScaleX","setScaleY","fRotationZ","setRotation","sName","setName","parseChild","objects","i","length","child","options","addChild","componentsParser","component","Sprite","loadTexture","path","type","setTexture","spriteFrame","spriteFrameCache","getSpriteFrame","setSpriteFrame","render","ComRender","addComponent","TMXTiledMap","ParticleSystem","jsonDict","loader","getRes","armature_data","subData","name","armatureDataManager","addArmatureFileInfo","Armature","actionName","getAnimation","play","audio","ComAudio","preloadEffect","attribute","ComAttribute","preloadBackgroundMusic","setFile","bLoop","setLoop","playBackgroundMusic","widget","_load","loadedPlist","cb","plist","addSpriteFrames","parseComponents","forEach","registerParser","Node","size","setContentSize","_parser"],"mappings":"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","file":"scene-1.x.js","sourceRoot":"../../../../../../../../../../../assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/studio/parsers","sourcesContent":["/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n(function(load, baseParser){\n\n    var Parser = baseParser.extend({\n\n        getNodeJson: function(json){\n            return json;\n        },\n\n        parseNode: function(json, resourcePath){\n            var parser = this.parsers[this.getClass(json)];\n            var node = null;\n            if(parser)\n                node = parser.call(this, json, resourcePath);\n            else\n                cc.log(\"Can't find the parser : %s\", this.getClass(json));\n\n            return node;\n        },\n\n        deferred: function(json, resourcePath, node, file){\n            ccs.triggerManager.parse(json[\"Triggers\"]||[]);\n            if(ccs.sceneReader)\n                ccs.sceneReader._node = node;\n        },\n\n        setPropertyFromJsonDict: function(node, json){\n            var x = (cc.isUndefined(json[\"x\"]))?0:json[\"x\"];\n            var y = (cc.isUndefined(json[\"y\"]))?0:json[\"y\"];\n            node.setPosition(x, y);\n\n            var bVisible = Boolean((cc.isUndefined(json[\"visible\"]))?1:json[\"visible\"]);\n            node.setVisible(bVisible);\n\n            var nTag = (cc.isUndefined(json[\"objecttag\"]))?-1:json[\"objecttag\"];\n            node.setTag(nTag);\n\n            var nZorder = (cc.isUndefined(json[\"zorder\"]))?0:json[\"zorder\"];\n            node.setLocalZOrder(nZorder);\n\n            var fScaleX = (cc.isUndefined(json[\"scalex\"]))?1:json[\"scalex\"];\n            var fScaleY = (cc.isUndefined(json[\"scaley\"]))?1:json[\"scaley\"];\n            node.setScaleX(fScaleX);\n            node.setScaleY(fScaleY);\n\n            var fRotationZ = (cc.isUndefined(json[\"rotation\"]))?0:json[\"rotation\"];\n            node.setRotation(fRotationZ);\n\n            var sName = json[\"name\"] || \"\";\n            node.setName(sName);\n        }\n\n    });\n\n    var parser = new Parser();\n\n    parser.parseChild = function(node, objects, resourcePath){\n        for (var i = 0; i < objects.length; i++) {\n            var child,\n                options = objects[i];\n            if(options)\n                child = this.parseNode(options, resourcePath);\n            if(child)\n                node.addChild(child);\n        }\n    };\n\n    var componentsParser = {\n        \"CCSprite\": function(node, component, resourcePath){\n            var child = new cc.Sprite();\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                if(type === 0)\n                    child.setTexture(path);\n                else if(type === 1){\n                    var spriteFrame = cc.spriteFrameCache.getSpriteFrame(path);\n                    child.setSpriteFrame(spriteFrame);\n                }\n            });\n            var render = new ccs.ComRender(child, \"CCSprite\");\n            node.addComponent(render);\n            return render;\n        },\n        \"CCTMXTiledMap\": function(node, component, resourcePath){\n            var child = null;\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                if(type === 0)\n                    child = new cc.TMXTiledMap(path);\n            });\n            var render = new ccs.ComRender(child, \"CCTMXTiledMap\");\n            node.addComponent(render);\n            return render;\n        },\n        \"CCParticleSystemQuad\": function(node, component, resourcePath){\n            var child = null;\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                if(type === 0)\n                    child = new cc.ParticleSystem(path);\n                else\n                    cc.log(\"unknown resourcetype on CCParticleSystemQuad!\");\n                child.setPosition(0, 0);\n            });\n            var render = new ccs.ComRender(child, \"CCParticleSystemQuad\");\n            node.addComponent(render);\n            return render;\n        },\n        \"CCArmature\": function(node, component, resourcePath){\n            var child = null;\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                if(type === 0){\n                    var jsonDict = cc.loader.getRes(path);\n                    if (!jsonDict) cc.log(\"Please load the resource [%s] first!\", path);\n                    var armature_data = jsonDict[\"armature_data\"];\n                    var subData = armature_data[0];\n                    var name = subData[\"name\"];\n                    ccs.armatureDataManager.addArmatureFileInfo(path);\n                    child = new ccs.Armature(name);\n                }\n            });\n            if(child){\n                var render = new ccs.ComRender(child, \"CCArmature\");\n                node.addComponent(render);\n                var actionName = component[\"selectedactionname\"];\n                if (actionName && child.getAnimation())\n                    child.getAnimation().play(actionName);\n\n                return render;\n            }\n\n        },\n        \"CCComAudio\": function(node, component, resourcePath){\n            var audio = null;\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                if(type === 0){\n                    audio = new ccs.ComAudio();\n                    audio.preloadEffect(path);\n                    var name = component[\"name\"];\n                    if(name)\n                        audio.setName(name);\n                    node.addComponent(audio);\n                }\n            });\n        },\n        \"CCComAttribute\": function(node, component, resourcePath){\n            var attribute = null;\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                if(type === 0){\n                    attribute = new ccs.ComAttribute();\n                    if (path !== \"\")\n                        attribute.parse(path);\n                    node.addComponent(attribute);\n                }else\n                    cc.log(\"unknown resourcetype on CCComAttribute!\");\n            });\n            return attribute;\n        },\n        \"CCBackgroundAudio\": function(node, component, resourcePath){\n            var audio = null;\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                if(type === 0){\n                    audio = new ccs.ComAudio();\n                    audio.preloadBackgroundMusic(path);\n                    audio.setFile(path);var bLoop = Boolean(component[\"loop\"] || 0);\n                    audio.setLoop(bLoop);\n                    var name = component[\"name\"];\n                    if(name)\n                        audio.setName(name);\n                    node.addComponent(audio);\n                    audio.playBackgroundMusic(path, bLoop);\n                }\n            });\n        },\n        \"GUIComponent\": function(node, component, resourcePath){\n            var widget = null;\n            loadTexture(component[\"fileData\"], resourcePath, function(path, type){\n                widget = ccs._load(path, \"ccui\");\n            });\n            var render = new ccs.ComRender(widget, \"GUIComponent\");\n            node.addComponent(render);\n            return render;\n        },\n        \"CCScene\": function(){}\n    };\n    var loadedPlist = {};\n    var loadTexture = function(json, resourcePath, cb){\n        if(json != null){\n            var path = json[\"path\"];\n            var type = json[\"resourceType\"];\n            var plist = json[\"plist\"];\n            if(!path)\n                return;\n            if(plist){\n                if(cc.loader.getRes(resourcePath + plist)){\n                    loadedPlist[resourcePath + plist] = true;\n                    cc.spriteFrameCache.addSpriteFrames(resourcePath + plist);\n                }else{\n                    if(!loadedPlist[resourcePath + plist])\n                        cc.log(\"%s need to be preloaded\", resourcePath + plist);\n                }\n            }\n            if(type !== 0)\n                cb(path, type);\n            else\n                cb(resourcePath + path, type);\n        }\n    };\n\n    parser.parseComponents = function(node, json, resourcePath){\n        if(!node || !json)\n            return;\n        json.forEach(function(component){\n            var parser = componentsParser[component[\"classname\"]];\n            var render = null;\n            if(parser)\n                render = parser(node, component, resourcePath);\n            else\n                cc.log(\"Can't find the component parser : %s\", component[\"classname\"]);\n            var name = component[\"name\"];\n            if(render && name){\n                render.setName(name);\n            }\n        });\n    };\n\n    parser.registerParser(\"CCNode\", function(options, resourcePath){\n        var node = new cc.Node();\n        this.setPropertyFromJsonDict(node, options);\n        this.parseChild.call(this, node, options[\"gameobjects\"], resourcePath);\n        this.parseComponents(node, options[\"components\"], resourcePath);\n        var size = options[\"CanvasSize\"];\n        if (size)\n            node.setContentSize(cc.size(size[\"_width\"], size[\"_height\"]));\n\n        return node;\n    });\n\n    load.registerParser(\"scene\", \"*\", parser);\n\n\n})(ccs._load, ccs._parser);\n"]}