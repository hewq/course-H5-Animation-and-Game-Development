{"version":3,"sources":["../../../../../../../../assets/frameworks/cocos2d-html5/external/gaf/Library/assets/frameworks/cocos2d-html5/external/gaf/Library/GAFSprite.js"],"names":["gaf","Sprite","Object","extend","_className","_hasCtx","_hasFilter","ctor","gafSpriteProto","usedScale","_super","cc","assert","_gafproto","_init","frame","getFrame","SpriteFrame","_sprite","_renderCmd","_gafCreateRenderCmd","initWithSpriteFrame","setAnchorPoint","getAnchor","addChild","setOpacityModifyRGB","_renderType","game","RENDER_TYPE_WEBGL","setBlendFunc","gl","ONE","ONE_MINUS_SRC_ALPHA","_applyState","state","parent","_applyStateSuper","_needsCtx","_enableCtx","_applyCtxState","_disableCtx","colorEqual","_realColor","_cascadeColorMult","setColor","getOpacity","a","setOpacity","getBoundingBoxForCurrentFrame","result","getBoundingBox","_rectApplyAffineTransformIn","getNodeToParentTransform","item","RENDER_TYPE_CANVAS","CanvasRenderCmd","WebGLRenderCmd"],"mappings":"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","file":"GAFSprite.js","sourceRoot":"../../../../../../../../assets/frameworks/cocos2d-html5/external/gaf/Library","sourcesContent":["\ngaf.Sprite = gaf.Object.extend\n({\n    _className: \"GAFSprite\",\n\n    _hasCtx: false,\n    _hasFilter: false,\n\n    ctor : function(gafSpriteProto, usedScale)\n    {\n        this._super(usedScale);\n        cc.assert(gafSpriteProto, \"Error! Missing mandatory parameter.\");\n        this._gafproto = gafSpriteProto;\n    },\n\n    // Private\n\n    _init : function()\n    {\n        var frame = this._gafproto.getFrame();\n        cc.assert(frame instanceof cc.SpriteFrame, \"Error. Wrong object type.\");\n\n        // Create sprite with custom render command from frame\n        this._sprite = new cc.Sprite();\n        this._sprite._renderCmd = this._gafCreateRenderCmd(this._sprite);\n        this._sprite.initWithSpriteFrame(frame);\n\n        this._sprite.setAnchorPoint(this._gafproto.getAnchor());\n        this.addChild(this._sprite);\n        //this._sprite.setCascadeColorEnabled(true);\n        //this._sprite.setCascadeOpacityEnabled(true);\n        this._sprite.setOpacityModifyRGB(true);\n\n        if(cc._renderType === cc.game.RENDER_TYPE_WEBGL)\n            this._sprite.setBlendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n    },\n    \n    _applyState : function(state, parent)\n    {\n        this._applyStateSuper(state, parent);\n        if(this._needsCtx)\n        {\n            // Enable ctx state if wasn't enabled\n            if(!this._hasCtx)\n            {\n                this._enableCtx();\n                this._hasCtx = true;\n            }\n            // Set ctx shader\n            this._applyCtxState(state);\n        }\n        else\n        {\n            // Disable ctx state if was enabled\n            if(this._hasCtx)\n            {\n                this._disableCtx();\n                this._hasCtx = false;\n            }\n            // Apply color\n            if(!cc.colorEqual(this._sprite._realColor, this._cascadeColorMult))\n            {\n                this._sprite.setColor(this._cascadeColorMult);\n            }\n            // Apply opacity\n            if(this._sprite.getOpacity() != this._cascadeColorMult.a)\n            {\n                this._sprite.setOpacity(this._cascadeColorMult.a);\n            }\n\n        }\n    },\n\n    _enableCtx: function()\n    {\n        this._sprite._renderCmd._enableCtx();\n    },\n\n    _disableCtx: function()\n    {\n        this._sprite._renderCmd._disableCtx();\n    },\n\n    _applyCtxState: function(state){\n        this._sprite._renderCmd._applyCtxState(this);\n    },\n\n    getBoundingBoxForCurrentFrame: function ()\n    {\n        var result = this._sprite.getBoundingBox();\n        return cc._rectApplyAffineTransformIn(result, this.getNodeToParentTransform());\n    },\n\n    _gafCreateRenderCmd: function(item){\n        if(cc._renderType === cc.game.RENDER_TYPE_CANVAS)\n            return new gaf.Sprite.CanvasRenderCmd(item);\n        else\n            return new gaf.Sprite.WebGLRenderCmd(item);\n    }\n});\n"]}