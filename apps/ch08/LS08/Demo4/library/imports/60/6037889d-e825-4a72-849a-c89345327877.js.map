{"version":3,"sources":["../../../../../../../../../assets/frameworks/cocos2d-html5/extensions/cocostudio/loader/parsers/assets/frameworks/cocos2d-html5/extensions/cocostudio/loader/parsers/timelineParser-1.x.js"],"names":["load","baseParser","loadedPlist","Parser","extend","getNodeJson","json","addSpriteFrame","plists","pngs","resourcePath","length","i","plist","cc","loader","getRes","log","spriteFrameCache","addSpriteFrames","pretreatment","file","parser","generalAttributes","node","options","width","height","x","y","scalex","scaley","rotation","rotationSkewX","rotationSkewY","skewx","skewy","anchorx","anchory","alpha","red","green","blue","zorder","tag","actionTag","visible","setPosition","p","setScaleX","setScaleY","setRotation","setRotationX","setRotationY","setSkewX","setSkewY","setAnchorPoint","setContentSize","size","setLocalZOrder","setVisible","setOpacity","setColor","color","setTag","setUserObject","ccs","ActionTimelineData","parseComponent","dic","component","loadComponent","addComponent","parseChild","parse","widget","children","child","parseNode","ccui","PageView","Layout","addPage","ListView","Widget","pushBackCustomItem","getPositionType","POSITION_PERCENT","position","getPositionPercent","anchor","getAnchorPoint","setPositionPercent","AnchorPointIn","getAnchorPointInPoints","getPositionX","getPositionY","addChild","initNode","Node","initSubGraph","filePath","createNode","initSprite","path","sprite","spriteFrame","getSpriteFrame","Sprite","createWithSpriteFrame","flipX","flipY","setFlippedX","setFlippedY","initParticle","num","particle","ParticleSystemQuad","setTotalParticles","initTMXTiledMap","tmxFile","tmxString","tmx","TMXTiledMap","uiParser","getParser","initWidget","type","parsers","call","register","name","handle","forEach","item","registerParser","_load","_parser"],"mappings":"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","file":"timelineParser-1.x.js","sourceRoot":"../../../../../../../../../assets/frameworks/cocos2d-html5/extensions/cocostudio/loader/parsers","sourcesContent":["/****************************************************************************\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n(function (load, baseParser) {\n\n    var loadedPlist = {};\n\n    var Parser = baseParser.extend({\n\n        getNodeJson: function (json) {\n            return json[\"nodeTree\"];\n        },\n\n        addSpriteFrame: function (plists, pngs, resourcePath) {\n            if (!plists || !pngs || plists.length !== pngs.length)\n                return;\n            for (var i = 0; i < plists.length; i++) {\n                var plist = resourcePath + plists[i];\n                if (!cc.loader.getRes(plist) && !loadedPlist[plist])\n                    cc.log(\"%s need to be preloaded\", plist);\n                else\n                    loadedPlist[plist] = true;\n                cc.spriteFrameCache.addSpriteFrames(\n                    plist,\n                    resourcePath + pngs[i]\n                );\n            }\n        },\n\n        pretreatment: function (json, resourcePath, file) {\n            this.addSpriteFrame(json[\"textures\"], json[\"texturesPng\"], resourcePath);\n        }\n\n    });\n    var parser = new Parser();\n\n    parser.generalAttributes = function (node, options) {\n        var width = options[\"width\"] != null ? options[\"width\"] : 0;\n        var height = options[\"height\"] != null ? options[\"height\"] : 0;\n        var x = options[\"x\"] != null ? options[\"x\"] : 0;\n        var y = options[\"y\"] != null ? options[\"y\"] : 0;\n        var scalex = options[\"scaleX\"] != null ? options[\"scaleX\"] : 1;\n        var scaley = options[\"scaleY\"] != null ? options[\"scaleY\"] : 1;\n        var rotation = options[\"rotation\"] != null ? options[\"rotation\"] : 0;\n        var rotationSkewX = options[\"rotationSkewX\"] != null ? options[\"rotationSkewX\"] : 0;\n        var rotationSkewY = options[\"rotationSkewY\"] != null ? options[\"rotationSkewY\"] : 0;\n        var skewx = options[\"skewX\"] != null ? options[\"skewX\"] : 0;\n        var skewy = options[\"skewY\"] != null ? options[\"skewY\"] : 0;\n        var anchorx = options[\"anchorPointX\"] != null ? options[\"anchorPointX\"] : 0.5;\n        var anchory = options[\"anchorPointY\"] != null ? options[\"anchorPointY\"] : 0.5;\n        var alpha = options[\"opacity\"] != null ? options[\"opacity\"] : 255;\n        var red = options[\"colorR\"] != null ? options[\"colorR\"] : 255;\n        var green = options[\"colorG\"] != null ? options[\"colorG\"] : 255;\n        var blue = options[\"colorB\"] != null ? options[\"colorB\"] : 255;\n        var zorder = options[\"colorR\"] != null ? options[\"colorR\"] : 0;\n        var tag = options[\"tag\"] != null ? options[\"tag\"] : 0;\n        var actionTag = options[\"actionTag\"] != null ? options[\"actionTag\"] : 0;\n        var visible = options[\"visible\"] != null ? options[\"visible\"] : true;\n\n        if (x != 0 || y != 0)\n            node.setPosition(cc.p(x, y));\n        if (scalex != 1)\n            node.setScaleX(scalex);\n        if (scaley != 1)\n            node.setScaleY(scaley);\n        if (rotation != 0)\n            node.setRotation(rotation);\n        if (rotationSkewX != 0)\n            node.setRotationX(rotationSkewX);\n        if (rotationSkewY != 0)\n            node.setRotationY(rotationSkewY);\n        if (skewx != 0)\n            node.setSkewX(skewx);\n        if (skewy != 0)\n            node.setSkewY(skewy);\n        if (anchorx != 0.5 || anchory != 0.5)\n            node.setAnchorPoint(cc.p(anchorx, anchory));\n        if (width != 0 || height != 0)\n            node.setContentSize(cc.size(width, height));\n        if (zorder != 0)\n            node.setLocalZOrder(zorder);\n        if (visible != true)\n            node.setVisible(visible);\n\n        if (alpha != 255) {\n            node.setOpacity(alpha);\n        }\n        if (red != 255 || green != 255 || blue != 255) {\n            node.setColor(cc.color(red, green, blue));\n        }\n\n\n        node.setTag(tag);\n        node.setUserObject(new ccs.ActionTimelineData(actionTag));\n    };\n\n    parser.parseComponent = function (node, options) {\n        if (!options) return;\n        for (var i = 0; i < options.length; ++i) {\n            var dic = options[i];\n            var component = this.loadComponent(dic);\n            if (component) {\n                node.addComponent(component);\n            }\n        }\n    };\n\n    parser.parseChild = function (parse, widget, options, resourcePath) {\n        var children = options[\"children\"];\n        for (var i = 0; i < children.length; i++) {\n            var child = this.parseNode(children[i], resourcePath);\n            if (child) {\n                if (widget instanceof ccui.PageView) {\n                    if (child instanceof ccui.Layout)\n                        widget.addPage(child);\n                } else {\n                    if (widget instanceof ccui.ListView) {\n                        if (child instanceof ccui.Widget)\n                            widget.pushBackCustomItem(child);\n                    } else {\n                        if (!(widget instanceof ccui.Layout) && child instanceof ccui.Widget) {\n                            if (child.getPositionType() === ccui.Widget.POSITION_PERCENT) {\n                                var position = child.getPositionPercent();\n                                var anchor = widget.getAnchorPoint();\n                                child.setPositionPercent(cc.p(position.x + anchor.x, position.y + anchor.y));\n                            }\n                            //To make up for the studio positioning error problem\n                            var AnchorPointIn = widget.getAnchorPointInPoints();\n                            child.setPosition(cc.p(child.getPositionX() + AnchorPointIn.x, child.getPositionY() + AnchorPointIn.y));\n                        }\n                        widget.addChild(child);\n                    }\n                }\n            }\n        }\n    };\n\n    parser.initNode = function (options) {\n        var node = new cc.Node();\n        this.generalAttributes(node, options);\n        return node;\n    };\n    parser.initSubGraph = function (options) {\n        var filePath = options[\"fileName\"];\n\n        var node;\n        if (filePath && \"\" !== filePath) {\n            node = this.createNode(filePath);\n        } else {\n            node = new ccs.Node();\n        }\n        this.generalAttributes(node, options);\n        return node;\n    };\n    parser.initSprite = function (options, resourcePath) {\n        var path = options[\"fileName\"];\n        var sprite;\n        if (path != null) {\n            var spriteFrame = cc.spriteFrameCache.getSpriteFrame(path);\n            if (!spriteFrame) {\n                path = resourcePath + path;\n                sprite = new ccs.Sprite(path);\n            } else {\n                sprite = ccs.Sprite.createWithSpriteFrame(spriteFrame);\n            }\n\n            if (!sprite) {\n                sprite = new cc.Sprite();\n                cc.log(\"filePath is empty. Create a sprite with no texture\");\n            }\n        } else {\n            sprite = new ccs.Sprite();\n        }\n        this.generalAttributes(sprite, options);\n        var flipX = options[\"flipX\"];\n        var flipY = options[\"flipY\"];\n\n        if (flipX != false)\n            sprite.setFlippedX(flipX);\n        if (flipY != false)\n            sprite.setFlippedY(flipY);\n        return sprite;\n    };\n    parser.initParticle = function (options, resourcePath) {\n        var filePath = options[\"plistFile\"];\n        var num = options[\"tmxFile\"];\n        var particle = new cc.ParticleSystemQuad(filePath);\n        particle.setTotalParticles(num);\n        this.generalAttributes(particle, options);\n        return particle;\n    };\n    parser.initTMXTiledMap = function (options, resourcePath) {\n        var tmxFile = options[\"tmxFile\"];\n        var tmxString = options[\"tmxString\"];\n        //todo check path and resourcePath\n        var path = options[\"resourcePath\"];\n\n        var tmx = null;\n        if (tmxFile && \"\" !== tmxFile) {\n            tmx = new cc.TMXTiledMap(tmxFile);\n        } else if (tmxString && \"\" !== tmxString && path && \"\" !== path) {\n            tmx = new cc.TMXTiledMap(tmxString, path);\n        }\n        return tmx;\n    };\n    var uiParser = load.getParser(\"ccui\")[\"*\"];\n    parser.initWidget = function (options, resourcePath) {\n        var type = options[\"classname\"];\n\n        var parser = uiParser.parsers[type];\n        if (!parser)\n            return cc.log(\"%s parser is not found\", type);\n\n        var node = parser.call(uiParser, options, resourcePath);\n        if (node) {\n            var rotationSkewX = options[\"rotationSkewX\"];\n            var rotationSkewY = options[\"rotationSkewY\"];\n            var skewx = options[\"skewX\"];\n            var skewy = options[\"skewY\"];\n            if (rotationSkewX != 0)\n                node.setRotationX(rotationSkewX);\n            if (rotationSkewY != 0)\n                node.setRotationY(rotationSkewY);\n            if (skewx != 0)\n                node.setSkewX(skewx);\n            if (skewy != 0)\n                node.setSkewY(skewy);\n\n            var actionTag = options[\"actionTag\"];\n            node.setUserObject(new ccs.ActionTimelineData(actionTag));\n        }\n        return node;\n    };\n\n    var register = [\n        {name: \"Node\", handle: parser.initNode},\n        {name: \"SubGraph\", handle: parser.initSubGraph},\n        {name: \"Sprite\", handle: parser.initSprite},\n        {name: \"Particle\", handle: parser.initParticle},\n        {name: \"TMXTiledMap\", handle: parser.initTMXTiledMap},\n\n        {name: \"Widget\", handle: parser.initWidget},\n        {name: \"Panel\", handle: parser.initWidget},\n        {name: \"Button\", handle: parser.initWidget},\n        {name: \"CheckBox\", handle: parser.initWidget},\n        {name: \"ImageView\", handle: parser.initWidget},\n        {name: \"LabelAtlas\", handle: parser.initWidget},\n        {name: \"LabelBMFont\", handle: parser.initWidget},\n        {name: \"Label\", handle: parser.initWidget},\n        {name: \"ListView\", handle: parser.initWidget},\n        {name: \"LoadingBar\", handle: parser.initWidget},\n        {name: \"PageView\", handle: parser.initWidget},\n        {name: \"ScrollView\", handle: parser.initWidget},\n        {name: \"Slider\", handle: parser.initWidget},\n        {name: \"TextField\", handle: parser.initWidget}\n    ];\n\n    register.forEach(function (item) {\n        parser.registerParser(item.name, function (options, parse, resourcePath) {\n            var node = item.handle.call(this, options[\"options\"]);\n            this.parseComponent(node, options[\"components\"]);\n            this.parseChild(parse, node, options, resourcePath);\n            return node;\n        });\n    });\n\n    load.registerParser(\"timeline\", \"0.*\", parser);\n    load.registerParser(\"timeline\", \"1.*\", parser);\n\n})(ccs._load, ccs._parser);\n"]}