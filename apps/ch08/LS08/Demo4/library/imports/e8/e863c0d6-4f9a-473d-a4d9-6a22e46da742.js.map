{"version":3,"sources":["../../../../../../../../assets/frameworks/cocos2d-html5/extensions/ccui/uiwidgets/assets/frameworks/cocos2d-html5/extensions/ccui/uiwidgets/UIVideoPlayer.js"],"names":["ccui","VideoPlayer","Widget","extend","_played","_playing","_stopped","ctor","path","prototype","call","_EventList","setURL","_createRenderCmd","RenderCmd","visit","cmd","_renderCmd","div","_div","container","cc","eventManager","_visible","appendChild","_video","_listener","addCustomListener","game","EVENT_RESIZE","resize","hasChild","contains","compareDocumentPosition","removeChild","removeListener","updateStatus","address","updateURL","getURL","_url","play","self","video","pause","currentTime","_polyfill","autoplayAfterOperation","setTimeout","resume","stop","_dispatchEvent","EventType","STOPPED","seekTo","sec","isPlaying","setKeepAspectRatioEnabled","enable","log","isKeepAspectRatioEnabled","setFullScreenEnabled","screen","requestFullScreen","exitFullScreen","isFullScreenEnabled","setEventListener","event","callback","removeEventListener","src","onPlayEvent","list","PLAYING","i","length","setContentSize","w","h","undefined","height","width","changeSize","cleanup","removeDom","stopAllActions","unscheduleAllCallbacks","onEnter","elements","indexOf","push","onExit","index","splice","pauseElements","EVENT_HIDE","node","EVENT_SHOW","pop","PAUSED","COMPLETED","devicePixelRatio","canPlayType","dom","document","createElement","sys","OS_IOS","os","browserType","BROWSER_TYPE_FIREFOX","style","innerHTML","head","polyfill","_renderType","RENDER_TYPE_WEBGL","Node","WebGLRenderCmd","CanvasRenderCmd","_rootCtor","initStyle","proto","Object","create","constructor","transform","parentCmd","recursive","originTransform","updateMatrix","_worldTransform","view","_scaleX","_scaleY","isRetinaEnabled","flags","_dirtyFlags","locFlag","_dirtyFlag","transformDirty","getParentRenderCmd","orderDirty","_node","_parent","t","scaleX","scaleY","dpr","getDevicePixelRatio","_loaded","containerStyle","offsetX","parseInt","paddingLeft","offsetY","paddingBottom","cw","_contentSize","ch","a","b","c","d","tx","ty","matrix","source","extname","loader","resPath","test","join","bindEvent","cb","setDirtyFlag","addEventListener","preload","replace","position","bottom","left","className","contentSize"],"mappings":"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","file":"UIVideoPlayer.js","sourceRoot":"../../../../../../../../assets/frameworks/cocos2d-html5/extensions/ccui/uiwidgets","sourcesContent":["/****************************************************************************\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @class\n * @extends ccui.Widget\n * @brief Displays a video file.\n *\n * @note VideoPlayer displays a video file based on DOM element\n * VideoPlayer will be rendered above all other graphical elements.\n *\n * @property {String}   path - The video path\n */\nccui.VideoPlayer = ccui.Widget.extend(/** @lends ccui.VideoPlayer# */{\n\n    _played: false,\n    _playing: false,\n    _stopped: true,\n\n    ctor: function (path) {\n        ccui.Widget.prototype.ctor.call(this);\n        this._EventList = {};\n        if (path)\n            this.setURL(path);\n    },\n\n    _createRenderCmd: function () {\n        return new ccui.VideoPlayer.RenderCmd(this);\n    },\n\n    visit: function () {\n        var cmd = this._renderCmd,\n            div = cmd._div,\n            container = cc.container,\n            eventManager = cc.eventManager;\n        if (this._visible) {\n            container.appendChild(cmd._video);\n            if (this._listener === null)\n                this._listener = cc.eventManager.addCustomListener(cc.game.EVENT_RESIZE, function () {\n                    cmd.resize();\n                });\n        } else {\n            var hasChild = false;\n            if ('contains' in container) {\n                hasChild = container.contains(cmd._video);\n            } else {\n                hasChild = container.compareDocumentPosition(cmd._video) % 16;\n            }\n            if (hasChild)\n                container.removeChild(cmd._video);\n            eventManager.removeListener(cmd._listener);\n            cmd._listener = null;\n        }\n        cmd.updateStatus();\n        cmd.resize();\n    },\n\n    /**\n     * Set the video address\n     * Automatically replace extname\n     * All supported video formats will be added to the video\n     * @param {String} address\n     */\n    setURL: function (address) {\n        this._renderCmd.updateURL(address);\n    },\n\n    /**\n     * Get the video path\n     * @returns {String}\n     */\n    getURL: function () {\n        return this._renderCmd._url;\n    },\n\n    /**\n     * Play the video\n     */\n    play: function () {\n        var self = this,\n            video = this._renderCmd._video;\n        if (video) {\n            this._played = true;\n            video.pause();\n            if (this._stopped !== false || this._playing !== false || this._played !== true)\n                video.currentTime = 0;\n            if (ccui.VideoPlayer._polyfill.autoplayAfterOperation) {\n                setTimeout(function () {\n                    video.play();\n                    self._playing = true;\n                    self._stopped = false;\n                }, 20);\n            } else {\n                video.play();\n                this._playing = true;\n                this._stopped = false;\n            }\n        }\n    },\n\n    /**\n     * Pause the video\n     */\n    pause: function () {\n        var video = this._renderCmd._video;\n        if (video && this._playing === true && this._stopped === false) {\n            video.pause();\n            this._playing = false;\n        }\n    },\n\n    /**\n     * Resume the video\n     */\n    resume: function () {\n        if (this._stopped === false && this._playing === false && this._played === true) {\n            this.play();\n        }\n    },\n\n    /**\n     * Stop the video\n     */\n    stop: function () {\n        var self = this,\n            video = this._renderCmd._video;\n        if (video) {\n            video.pause();\n            video.currentTime = 0;\n            this._playing = false;\n            this._stopped = true;\n        }\n\n        setTimeout(function () {\n            self._dispatchEvent(ccui.VideoPlayer.EventType.STOPPED);\n        }, 0);\n    },\n    /**\n     * Jump to the specified point in time\n     * @param {Number} sec\n     */\n    seekTo: function (sec) {\n        var video = this._renderCmd._video;\n        if (video) {\n            video.currentTime = sec;\n            if (ccui.VideoPlayer._polyfill.autoplayAfterOperation && this.isPlaying()) {\n                setTimeout(function () {\n                    video.play();\n                }, 20);\n            }\n        }\n    },\n\n    /**\n     * Whether the video is playing\n     * @returns {boolean}\n     */\n    isPlaying: function () {\n        if (ccui.VideoPlayer._polyfill.autoplayAfterOperation && this._playing) {\n            setTimeout(function () {\n                video.play();\n            }, 20);\n        }\n        return this._playing;\n    },\n\n    /**\n     * Whether to keep the aspect ratio\n     */\n    setKeepAspectRatioEnabled: function (enable) {\n        cc.log(\"On the web is always keep the aspect ratio\");\n    },\n    isKeepAspectRatioEnabled: function () {\n        return false;\n    },\n\n    /**\n     * Set whether the full screen\n     * May appear inconsistent in different browsers\n     * @param {boolean} enable\n     */\n    setFullScreenEnabled: function (enable) {\n        var video = this._renderCmd._video;\n        if (video) {\n            if (enable)\n                cc.screen.requestFullScreen(video);\n            else\n                cc.screen.exitFullScreen(video);\n        }\n    },\n\n    /**\n     * Determine whether already full screen\n     */\n    isFullScreenEnabled: function () {\n        cc.log(\"Can't know status\");\n    },\n\n    /**\n     * The binding event\n     * @param {ccui.VideoPlayer.EventType} event\n     * @param {Function} callback\n     */\n    setEventListener: function (event, callback) {\n        this._EventList[event] = callback;\n    },\n\n    /**\n     * Delete events\n     * @param {ccui.VideoPlayer.EventType} event\n     */\n    removeEventListener: function (event) {\n        this._EventList[event] = null;\n    },\n\n    _dispatchEvent: function (event) {\n        var callback = this._EventList[event];\n        if (callback)\n            callback.call(this, this, this._renderCmd._video.src);\n    },\n\n    /**\n     * Trigger playing events\n     */\n    onPlayEvent: function () {\n        var list = this._EventList[ccui.VideoPlayer.EventType.PLAYING];\n        if (list)\n            for (var i = 0; i < list.length; i++)\n                list[i].call(this, this, this._renderCmd._video.src);\n    },\n\n    setContentSize: function (w, h) {\n        ccui.Widget.prototype.setContentSize.call(this, w, h);\n        if (h === undefined) {\n            h = w.height;\n            w = w.width;\n        }\n        this._renderCmd.changeSize(w, h);\n    },\n\n    cleanup: function () {\n        this._renderCmd.removeDom();\n        this.stopAllActions();\n        this.unscheduleAllCallbacks();\n    },\n\n    onEnter: function () {\n        ccui.Widget.prototype.onEnter.call(this);\n        var list = ccui.VideoPlayer.elements;\n        if (list.indexOf(this) === -1)\n            list.push(this);\n    },\n\n    onExit: function () {\n        ccui.Widget.prototype.onExit.call(this);\n        var list = ccui.VideoPlayer.elements;\n        var index = list.indexOf(this);\n        if (index !== -1)\n            list.splice(index, 1);\n    }\n\n});\n\n// VideoHTMLElement list\nccui.VideoPlayer.elements = [];\nccui.VideoPlayer.pauseElements = [];\n\ncc.eventManager.addCustomListener(cc.game.EVENT_HIDE, function () {\n    var list = ccui.VideoPlayer.elements;\n    for (var node, i = 0; i < list.length; i++) {\n        node = list[i];\n        if (list[i]._playing) {\n            node.pause();\n            ccui.VideoPlayer.pauseElements.push(node);\n        }\n    }\n});\ncc.eventManager.addCustomListener(cc.game.EVENT_SHOW, function () {\n    var list = ccui.VideoPlayer.pauseElements;\n    var node = list.pop();\n    while (node) {\n        node.play();\n        node = list.pop();\n    }\n});\n\n/**\n * The VideoPlayer support list of events\n * @type {{PLAYING: string, PAUSED: string, STOPPED: string, COMPLETED: string}}\n */\nccui.VideoPlayer.EventType = {\n    PLAYING: \"play\",\n    PAUSED: \"pause\",\n    STOPPED: \"stop\",\n    COMPLETED: \"complete\"\n};\n\n(function (video) {\n    /**\n     * Adapter various machines\n     * @devicePixelRatio Whether you need to consider devicePixelRatio calculated position\n     * @event To get the data using events\n     */\n    video._polyfill = {\n        devicePixelRatio: false,\n        event: \"canplay\",\n        canPlayType: []\n    };\n\n    (function () {\n        /**\n         * Some old browser only supports Theora encode video\n         * But native does not support this encode,\n         * so it is best to provide mp4 and webm or ogv file\n         */\n        var dom = document.createElement(\"video\");\n        if (dom.canPlayType(\"video/ogg\")) {\n            video._polyfill.canPlayType.push(\".ogg\");\n            video._polyfill.canPlayType.push(\".ogv\");\n        }\n        if (dom.canPlayType(\"video/mp4\"))\n            video._polyfill.canPlayType.push(\".mp4\");\n        if (dom.canPlayType(\"video/webm\"))\n            video._polyfill.canPlayType.push(\".webm\");\n    })();\n\n    if (cc.sys.OS_IOS === cc.sys.os) {\n        video._polyfill.devicePixelRatio = true;\n        video._polyfill.event = \"progress\";\n    }\n    if (cc.sys.browserType === cc.sys.BROWSER_TYPE_FIREFOX) {\n        video._polyfill.autoplayAfterOperation = true;\n    }\n\n    var style = document.createElement(\"style\");\n    style.innerHTML = \".cocosVideo:-moz-full-screen{transform:matrix(1,0,0,1,0,0) !important;}\" +\n        \".cocosVideo:full-screen{transform:matrix(1,0,0,1,0,0) !important;}\" +\n        \".cocosVideo:-webkit-full-screen{transform:matrix(1,0,0,1,0,0) !important;}\";\n    document.head.appendChild(style);\n\n})(ccui.VideoPlayer);\n\n(function (polyfill) {\n\n    var RenderCmd = null;\n    if (cc._renderType === cc.game.RENDER_TYPE_WEBGL) {\n        RenderCmd = cc.Node.WebGLRenderCmd;\n    } else {\n        RenderCmd = cc.Node.CanvasRenderCmd;\n    }\n\n    ccui.VideoPlayer.RenderCmd = function (node) {\n        this._rootCtor(node);\n        this._listener = null;\n        this._url = \"\";\n        this.initStyle();\n    };\n    \n    var proto = ccui.VideoPlayer.RenderCmd.prototype = Object.create(RenderCmd.prototype);\n    proto.constructor = ccui.VideoPlayer.RenderCmd;\n\n    proto.transform = function (parentCmd, recursive) {\n        this.originTransform(parentCmd, recursive);\n        this.updateMatrix(this._worldTransform, cc.view._scaleX, cc.view._scaleY);\n    };\n\n    proto.updateStatus = function () {\n        polyfill.devicePixelRatio = cc.view.isRetinaEnabled();\n        var flags = cc.Node._dirtyFlags, locFlag = this._dirtyFlag;\n        if (locFlag & flags.transformDirty) {\n            //update the transform\n            this.transform(this.getParentRenderCmd(), true);\n            this.updateMatrix(this._worldTransform, cc.view._scaleX, cc.view._scaleY);\n            this._dirtyFlag = this._dirtyFlag & cc.Node._dirtyFlags.transformDirty ^ this._dirtyFlag;\n        }\n\n        if (locFlag & flags.orderDirty) {\n            this._dirtyFlag = this._dirtyFlag & flags.orderDirty ^ this._dirtyFlag;\n        }\n    };\n\n    proto.resize = function (view) {\n        view = view || cc.view;\n        var node = this._node,\n            eventManager = cc.eventManager;\n        if (node._parent && node._visible)\n            this.updateMatrix(this._worldTransform, view._scaleX, view._scaleY);\n        else {\n            eventManager.removeListener(this._listener);\n            this._listener = null;\n        }\n    };\n\n    proto.updateMatrix = function (t, scaleX, scaleY) {\n        var node = this._node;\n        if (polyfill.devicePixelRatio) {\n            var dpr = cc.view.getDevicePixelRatio();\n            scaleX = scaleX / dpr;\n            scaleY = scaleY / dpr;\n        }\n        if (this._loaded === false) return;\n        var containerStyle = cc.game.container.style,\n            offsetX = parseInt(containerStyle.paddingLeft),\n            offsetY = parseInt(containerStyle.paddingBottom),\n            cw = node._contentSize.width,\n            ch = node._contentSize.height;\n        var a = t.a * scaleX,\n            b = t.b,\n            c = t.c,\n            d = t.d * scaleY,\n            tx = offsetX + t.tx * scaleX - cw / 2 + cw * node._scaleX / 2 * scaleX,\n            ty = offsetY + t.ty * scaleY - ch / 2 + ch * node._scaleY / 2 * scaleY;\n        var matrix = \"matrix(\" + a + \",\" + b + \",\" + c + \",\" + d + \",\" + tx + \",\" + -ty + \")\";\n        this._video.style[\"transform\"] = matrix;\n        this._video.style[\"-webkit-transform\"] = matrix;\n    };\n\n    proto.updateURL = function (path) {\n        var source, video, hasChild, container, extname;\n        var node = this._node;\n\n        if (this._url == path)\n            return;\n\n        this._url = path;\n\n        if (cc.loader.resPath && !/^http/.test(path))\n            path = cc.path.join(cc.loader.resPath, path);\n\n        hasChild = false;\n        container = cc.container;\n        if ('contains' in container) {\n            hasChild = container.contains(this._video);\n        } else {\n            hasChild = container.compareDocumentPosition(this._video) % 16;\n        }\n        if (hasChild)\n            container.removeChild(this._video);\n\n        this._video = document.createElement(\"video\");\n        video = this._video;\n        this.bindEvent();\n        var self = this;\n\n        var cb = function () {\n            if (self._loaded == true)\n                return;\n            self._loaded = true;\n            self.changeSize();\n            self.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);\n            video.removeEventListener(polyfill.event, cb);\n            video.currentTime = 0;\n            video.style[\"visibility\"] = \"visible\";\n            //IOS does not display video images\n            video.play();\n            if (!node._played) {\n                video.pause();\n                video.currentTime = 0;\n            }\n        };\n        video.addEventListener(polyfill.event, cb);\n\n        //video.controls = \"controls\";\n        video.preload = \"metadata\";\n        video.style[\"visibility\"] = \"hidden\";\n        this._loaded = false;\n        node._played = false;\n        node._playing = false;\n        node._stopped = true;\n        this.initStyle();\n        this._node.visit();\n\n        source = document.createElement(\"source\");\n        source.src = path;\n        video.appendChild(source);\n\n        extname = cc.path.extname(path);\n        for (var i = 0; i < polyfill.canPlayType.length; i++) {\n            if (extname !== polyfill.canPlayType[i]) {\n                source = document.createElement(\"source\");\n                source.src = path.replace(extname, polyfill.canPlayType[i]);\n                video.appendChild(source);\n            }\n        }\n    };\n\n    proto.bindEvent = function () {\n        var self = this,\n            node = this._node,\n            video = this._video;\n        //binding event\n        video.addEventListener(\"ended\", function () {\n            node._renderCmd.updateMatrix(self._worldTransform, cc.view._scaleX, cc.view._scaleY);\n            node._playing = false;\n            node._dispatchEvent(ccui.VideoPlayer.EventType.COMPLETED);\n        });\n        video.addEventListener(\"play\", function () {\n            node._dispatchEvent(ccui.VideoPlayer.EventType.PLAYING);\n        });\n        video.addEventListener(\"pause\", function () {\n            node._dispatchEvent(ccui.VideoPlayer.EventType.PAUSED);\n        });\n    };\n\n    proto.initStyle = function () {\n        if (!this._video)  return;\n        var video = this._video;\n        video.style.position = \"absolute\";\n        video.style.bottom = \"0px\";\n        video.style.left = \"0px\";\n        video.className = \"cocosVideo\";\n    };\n\n    proto.changeSize = function (w, h) {\n        var contentSize = this._node._contentSize;\n        w = w || contentSize.width;\n        h = h || contentSize.height;\n        var video = this._video;\n        if (video) {\n            if (w !== 0)\n                video.width = w;\n            if (h !== 0)\n                video.height = h;\n        }\n    };\n\n    proto.removeDom = function () {\n        var video = this._video;\n        if (video) {\n            var hasChild = false;\n            if ('contains' in cc.container) {\n                hasChild = cc.container.contains(video);\n            } else {\n                hasChild = cc.container.compareDocumentPosition(video) % 16;\n            }\n            if (hasChild)\n                cc.container.removeChild(video);\n        }\n    };\n\n})(ccui.VideoPlayer._polyfill);\n"]}