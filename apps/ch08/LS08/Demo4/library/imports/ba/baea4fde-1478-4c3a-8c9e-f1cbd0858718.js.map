{"version":3,"sources":["../../../../../../../../../../../assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/studio/parsers/assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/studio/parsers/timelineParser-1.x.js"],"names":["load","baseParser","loadedPlist","Parser","extend","getNodeJson","json","addSpriteFrame","plists","pngs","resourcePath","length","i","plist","cc","loader","getRes","log","spriteFrameCache","addSpriteFrames","pretreatment","file","parser","generalAttributes","node","options","width","height","x","y","scalex","scaley","rotation","rotationSkewX","rotationSkewY","skewx","skewy","anchorx","anchory","alpha","red","green","blue","zorder","tag","actionTag","visible","setPosition","p","setScaleX","setScaleY","setRotation","setRotationX","setRotationY","setSkewX","setSkewY","setAnchorPoint","setContentSize","size","setLocalZOrder","setVisible","setOpacity","setColor","color","setTag","setUserObject","ccs","ActionTimelineData","parseComponent","dic","component","loadComponent","addComponent","parseChild","parse","widget","children","child","parseNode","ccui","PageView","Layout","addPage","ListView","Widget","pushBackCustomItem","getPositionType","POSITION_PERCENT","position","getPositionPercent","anchor","getAnchorPoint","setPositionPercent","AnchorPointIn","getAnchorPointInPoints","getPositionX","getPositionY","addChild","initNode","Node","initSubGraph","filePath","createNode","initSprite","path","sprite","spriteFrame","getSpriteFrame","Sprite","createWithSpriteFrame","flipX","flipY","setFlippedX","setFlippedY","initParticle","num","particle","ParticleSystemQuad","setTotalParticles","initTMXTiledMap","tmxFile","tmxString","tmx","TMXTiledMap","uiParser","getParser","initWidget","type","parsers","call","register","name","handle","forEach","item","registerParser","_load","_parser"],"mappings":";;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA,CAAC,UAASA,IAAT,EAAeC,UAAf,EAA0B;;AAEvB,QAAIC,cAAc,EAAlB;;AAEA,QAAIC,SAASF,WAAWG,MAAX,CAAkB;;AAE3BC,qBAAa,qBAASC,IAAT,EAAc;AACvB,mBAAOA,KAAK,UAAL,CAAP;AACH,SAJ0B;;AAM3BC,wBAAgB,wBAASC,MAAT,EAAiBC,IAAjB,EAAuBC,YAAvB,EAAoC;AAChD,gBAAG,CAACF,MAAD,IAAW,CAACC,IAAZ,IAAoBD,OAAOG,MAAP,KAAkBF,KAAKE,MAA9C,EACI;AACJ,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIJ,OAAOG,MAA3B,EAAmCC,GAAnC,EAAwC;AACpC,oBAAIC,QAAQH,eAAeF,OAAOI,CAAP,CAA3B;AACA,oBAAG,CAACE,GAAGC,MAAH,CAAUC,MAAV,CAAiBH,KAAjB,CAAD,IAA4B,CAACX,YAAYW,KAAZ,CAAhC,EACIC,GAAGG,GAAH,CAAO,yBAAP,EAAkCJ,KAAlC,EADJ,KAGIX,YAAYW,KAAZ,IAAqB,IAArB;AACJC,mBAAGI,gBAAH,CAAoBC,eAApB,CACIN,KADJ,EAEIH,eAAeD,KAAKG,CAAL,CAFnB;AAIH;AACJ,SApB0B;;AAsB3BQ,sBAAc,sBAASd,IAAT,EAAeI,YAAf,EAA6BW,IAA7B,EAAkC;AAC5C,iBAAKd,cAAL,CAAoBD,KAAK,UAAL,CAApB,EAAsCA,KAAK,aAAL,CAAtC,EAA2DI,YAA3D;AACH;;AAxB0B,KAAlB,CAAb;AA2BA,QAAIY,SAAS,IAAInB,MAAJ,EAAb;;AAEAmB,WAAOC,iBAAP,GAA2B,UAASC,IAAT,EAAeC,OAAf,EAAuB;AAC9C,YAAIC,QAAgBD,QAAQ,OAAR,KAA0B,IAA1B,GAAiCA,QAAQ,OAAR,CAAjC,GAAoD,CAAxE;AACA,YAAIE,SAAgBF,QAAQ,QAAR,KAA0B,IAA1B,GAAiCA,QAAQ,QAAR,CAAjC,GAAqD,CAAzE;AACA,YAAIG,IAAgBH,QAAQ,GAAR,KAA0B,IAA1B,GAAiCA,QAAQ,GAAR,CAAjC,GAAgD,CAApE;AACA,YAAII,IAAgBJ,QAAQ,GAAR,KAA0B,IAA1B,GAAiCA,QAAQ,GAAR,CAAjC,GAAgD,CAApE;AACA,YAAIK,SAAgBL,QAAQ,QAAR,KAA0B,IAA1B,GAAiCA,QAAQ,QAAR,CAAjC,GAAqD,CAAzE;AACA,YAAIM,SAAgBN,QAAQ,QAAR,KAA0B,IAA1B,GAAiCA,QAAQ,QAAR,CAAjC,GAAqD,CAAzE;AACA,YAAIO,WAAgBP,QAAQ,UAAR,KAA0B,IAA1B,GAAiCA,QAAQ,UAAR,CAAjC,GAAuD,CAA3E;AACA,YAAIQ,gBAAgBR,QAAQ,eAAR,KAA0B,IAA1B,GAAiCA,QAAQ,eAAR,CAAjC,GAA4D,CAAhF;AACA,YAAIS,gBAAgBT,QAAQ,eAAR,KAA0B,IAA1B,GAAiCA,QAAQ,eAAR,CAAjC,GAA4D,CAAhF;AACA,YAAIU,QAAgBV,QAAQ,OAAR,KAA0B,IAA1B,GAAiCA,QAAQ,OAAR,CAAjC,GAAoD,CAAxE;AACA,YAAIW,QAAgBX,QAAQ,OAAR,KAA0B,IAA1B,GAAiCA,QAAQ,OAAR,CAAjC,GAAoD,CAAxE;AACA,YAAIY,UAAgBZ,QAAQ,cAAR,KAA0B,IAA1B,GAAiCA,QAAQ,cAAR,CAAjC,GAA2D,GAA/E;AACA,YAAIa,UAAgBb,QAAQ,cAAR,KAA0B,IAA1B,GAAiCA,QAAQ,cAAR,CAAjC,GAA2D,GAA/E;AACA,YAAIc,QAAgBd,QAAQ,SAAR,KAA0B,IAA1B,GAAiCA,QAAQ,SAAR,CAAjC,GAAsD,GAA1E;AACA,YAAIe,MAAgBf,QAAQ,QAAR,KAA0B,IAA1B,GAAiCA,QAAQ,QAAR,CAAjC,GAAqD,GAAzE;AACA,YAAIgB,QAAgBhB,QAAQ,QAAR,KAA0B,IAA1B,GAAiCA,QAAQ,QAAR,CAAjC,GAAqD,GAAzE;AACA,YAAIiB,OAAgBjB,QAAQ,QAAR,KAA0B,IAA1B,GAAiCA,QAAQ,QAAR,CAAjC,GAAqD,GAAzE;AACA,YAAIkB,SAAgBlB,QAAQ,QAAR,KAA0B,IAA1B,GAAiCA,QAAQ,QAAR,CAAjC,GAAqD,CAAzE;AACA,YAAImB,MAAgBnB,QAAQ,KAAR,KAA0B,IAA1B,GAAiCA,QAAQ,KAAR,CAAjC,GAAkD,CAAtE;AACA,YAAIoB,YAAgBpB,QAAQ,WAAR,KAA0B,IAA1B,GAAiCA,QAAQ,WAAR,CAAjC,GAAwD,CAA5E;AACA,YAAIqB,UAAgBrB,QAAQ,SAAR,KAA0B,IAA1B,GAAiCA,QAAQ,SAAR,CAAjC,GAAsD,IAA1E;;AAEA,YAAGG,KAAK,CAAL,IAAUC,KAAK,CAAlB,EACIL,KAAKuB,WAAL,CAAiBjC,GAAGkC,CAAH,CAAKpB,CAAL,EAAQC,CAAR,CAAjB;AACJ,YAAGC,UAAU,CAAb,EACIN,KAAKyB,SAAL,CAAenB,MAAf;AACJ,YAAGC,UAAU,CAAb,EACIP,KAAK0B,SAAL,CAAenB,MAAf;AACJ,YAAIC,YAAY,CAAhB,EACIR,KAAK2B,WAAL,CAAiBnB,QAAjB;AACJ,YAAGC,iBAAiB,CAApB,EACIT,KAAK4B,YAAL,CAAkBnB,aAAlB;AACJ,YAAGC,iBAAiB,CAApB,EACIV,KAAK6B,YAAL,CAAkBnB,aAAlB;AACJ,YAAGC,SAAS,CAAZ,EACIX,KAAK8B,QAAL,CAAcnB,KAAd;AACJ,YAAGC,SAAS,CAAZ,EACIZ,KAAK+B,QAAL,CAAcnB,KAAd;AACJ,YAAGC,WAAW,GAAX,IAAkBC,WAAW,GAAhC,EACId,KAAKgC,cAAL,CAAoB1C,GAAGkC,CAAH,CAAKX,OAAL,EAAcC,OAAd,CAApB;AACJ,YAAGZ,SAAS,CAAT,IAAcC,UAAU,CAA3B,EACIH,KAAKiC,cAAL,CAAoB3C,GAAG4C,IAAH,CAAQhC,KAAR,EAAeC,MAAf,CAApB;AACJ,YAAGgB,UAAU,CAAb,EACInB,KAAKmC,cAAL,CAAoBhB,MAApB;AACJ,YAAGG,WAAW,IAAd,EACItB,KAAKoC,UAAL,CAAgBd,OAAhB;;AAEJ,YAAGP,SAAS,GAAZ,EACA;AACIf,iBAAKqC,UAAL,CAAgBtB,KAAhB;AACH;AACD,YAAGC,OAAO,GAAP,IAAcC,SAAS,GAAvB,IAA8BC,QAAQ,GAAzC,EACA;AACIlB,iBAAKsC,QAAL,CAAchD,GAAGiD,KAAH,CAASvB,GAAT,EAAcC,KAAd,EAAqBC,IAArB,CAAd;AACH;;AAGDlB,aAAKwC,MAAL,CAAYpB,GAAZ;AACApB,aAAKyC,aAAL,CAAmB,IAAIC,IAAIC,kBAAR,CAA2BtB,SAA3B,CAAnB;AACH,KA5DD;;AA8DAvB,WAAO8C,cAAP,GAAwB,UAAS5C,IAAT,EAAeC,OAAf,EAAuB;AAC3C,YAAG,CAACA,OAAJ,EAAa;AACb,aAAK,IAAIb,IAAI,CAAb,EAAgBA,IAAIa,QAAQd,MAA5B,EAAoC,EAAEC,CAAtC,EAAwC;AACpC,gBAAIyD,MAAM5C,QAAQb,CAAR,CAAV;AACA,gBAAI0D,YAAY,KAAKC,aAAL,CAAmBF,GAAnB,CAAhB;AACA,gBAAIC,SAAJ,EAAc;AACV9C,qBAAKgD,YAAL,CAAkBF,SAAlB;AACH;AACJ;AACJ,KATD;;AAWAhD,WAAOmD,UAAP,GAAoB,UAASC,KAAT,EAAgBC,MAAhB,EAAwBlD,OAAxB,EAAiCf,YAAjC,EAA8C;AAC9D,YAAIkE,WAAWnD,QAAQ,UAAR,CAAf;AACA,aAAK,IAAIb,IAAI,CAAb,EAAgBA,IAAIgE,SAASjE,MAA7B,EAAqCC,GAArC,EAA0C;AACtC,gBAAIiE,QAAQ,KAAKC,SAAL,CAAeF,SAAShE,CAAT,CAAf,EAA4BF,YAA5B,CAAZ;AACA,gBAAGmE,KAAH,EAAS;AACL,oBAAGF,kBAAkBI,KAAKC,QAA1B,EAAmC;AAC/B,wBAAGH,iBAAiBE,KAAKE,MAAzB,EACIN,OAAOO,OAAP,CAAeL,KAAf;AACP,iBAHD,MAGO;AACH,wBAAGF,kBAAkBI,KAAKI,QAA1B,EAAmC;AAC/B,4BAAGN,iBAAiBE,KAAKK,MAAzB,EACIT,OAAOU,kBAAP,CAA0BR,KAA1B;AACP,qBAHD,MAGO;AACH,4BAAG,EAAEF,kBAAkBI,KAAKE,MAAzB,KAAoCJ,iBAAiBE,KAAKK,MAA7D,EAAqE;AACjE,gCAAGP,MAAMS,eAAN,OAA4BP,KAAKK,MAAL,CAAYG,gBAA3C,EAA6D;AACzD,oCAAIC,WAAWX,MAAMY,kBAAN,EAAf;AACA,oCAAIC,SAASf,OAAOgB,cAAP,EAAb;AACAd,sCAAMe,kBAAN,CAAyB9E,GAAGkC,CAAH,CAAKwC,SAAS5D,CAAT,GAAa8D,OAAO9D,CAAzB,EAA4B4D,SAAS3D,CAAT,GAAa6D,OAAO7D,CAAhD,CAAzB;AACH;AACD;AACA,gCAAIgE,gBAAgBlB,OAAOmB,sBAAP,EAApB;AACAjB,kCAAM9B,WAAN,CAAkBjC,GAAGkC,CAAH,CAAK6B,MAAMkB,YAAN,KAAuBF,cAAcjE,CAA1C,EAA6CiD,MAAMmB,YAAN,KAAuBH,cAAchE,CAAlF,CAAlB;AACH;AACD8C,+BAAOsB,QAAP,CAAgBpB,KAAhB;AACH;AACJ;AACJ;AACJ;AACJ,KA5BD;;AA8BAvD,WAAO4E,QAAP,GAAkB,UAASzE,OAAT,EAAiB;AAC/B,YAAID,OAAO,IAAIV,GAAGqF,IAAP,EAAX;AACA,aAAK5E,iBAAL,CAAuBC,IAAvB,EAA6BC,OAA7B;AACA,eAAOD,IAAP;AACH,KAJD;AAKAF,WAAO8E,YAAP,GAAsB,UAAS3E,OAAT,EAAiB;AACnC,YAAI4E,WAAW5E,QAAQ,UAAR,CAAf;;AAEA,YAAID,IAAJ;AACA,YAAI6E,YAAY,OAAOA,QAAvB,EAAgC;AAC5B7E,mBAAO,KAAK8E,UAAL,CAAgBD,QAAhB,CAAP;AACH,SAFD,MAEK;AACD7E,mBAAO,IAAI0C,IAAIiC,IAAR,EAAP;AACH;AACD,aAAK5E,iBAAL,CAAuBC,IAAvB,EAA6BC,OAA7B;AACA,eAAOD,IAAP;AACH,KAXD;AAYAF,WAAOiF,UAAP,GAAoB,UAAS9E,OAAT,EAAkBf,YAAlB,EAA+B;AAC/C,YAAI8F,OAAO/E,QAAQ,UAAR,CAAX;AACA,YAAIgF,MAAJ;AACA,YAAGD,QAAQ,IAAX,EAAgB;AACZ,gBAAIE,cAAc5F,GAAGI,gBAAH,CAAoByF,cAApB,CAAmCH,IAAnC,CAAlB;AACA,gBAAG,CAACE,WAAJ,EAAgB;AACZF,uBAAO9F,eAAe8F,IAAtB;AACAC,yBAAS,IAAIvC,IAAI0C,MAAR,CAAeJ,IAAf,CAAT;AACH,aAHD,MAGK;AACDC,yBAASvC,IAAI0C,MAAJ,CAAWC,qBAAX,CAAiCH,WAAjC,CAAT;AACH;;AAED,gBAAG,CAACD,MAAJ,EAAW;AACPA,yBAAS,IAAI3F,GAAG8F,MAAP,EAAT;AACA9F,mBAAGG,GAAH,CAAO,oDAAP;AACH;AACJ,SAbD,MAaK;AACDwF,qBAAS,IAAIvC,IAAI0C,MAAR,EAAT;AACH;AACD,aAAKrF,iBAAL,CAAuBkF,MAAvB,EAA+BhF,OAA/B;AACA,YAAIqF,QAAQrF,QAAQ,OAAR,CAAZ;AACA,YAAIsF,QAAQtF,QAAQ,OAAR,CAAZ;;AAEA,YAAGqF,SAAS,KAAZ,EACIL,OAAOO,WAAP,CAAmBF,KAAnB;AACJ,YAAGC,SAAS,KAAZ,EACIN,OAAOQ,WAAP,CAAmBF,KAAnB;AACJ,eAAON,MAAP;AACH,KA5BD;AA6BAnF,WAAO4F,YAAP,GAAsB,UAASzF,OAAT,EAAkBf,YAAlB,EAA+B;AACjD,YAAI2F,WAAW5E,QAAQ,WAAR,CAAf;AACA,YAAI0F,MAAM1F,QAAQ,SAAR,CAAV;AACA,YAAI2F,WAAW,IAAItG,GAAGuG,kBAAP,CAA0BhB,QAA1B,CAAf;AACAe,iBAASE,iBAAT,CAA2BH,GAA3B;AACA,aAAK5F,iBAAL,CAAuB6F,QAAvB,EAAiC3F,OAAjC;AACA,eAAO2F,QAAP;AACH,KAPD;AAQA9F,WAAOiG,eAAP,GAAyB,UAAS9F,OAAT,EAAkBf,YAAlB,EAA+B;AACpD,YAAI8G,UAAU/F,QAAQ,SAAR,CAAd;AACA,YAAIgG,YAAYhG,QAAQ,WAAR,CAAhB;AACA;AACA,YAAI+E,OAAO/E,QAAQ,cAAR,CAAX;;AAEA,YAAIiG,MAAM,IAAV;AACA,YAAIF,WAAW,OAAOA,OAAtB,EAA8B;AAC1BE,kBAAM,IAAI5G,GAAG6G,WAAP,CAAmBH,OAAnB,CAAN;AACH,SAFD,MAEM,IAAIC,aAAa,OAAOA,SAApB,IAAiCjB,IAAjC,IAAyC,OAAOA,IAApD,EAAyD;AAC3DkB,kBAAM,IAAI5G,GAAG6G,WAAP,CAAmBF,SAAnB,EAA8BjB,IAA9B,CAAN;AACH;AACD,eAAOkB,GAAP;AACH,KAbD;AAcA,QAAIE,WAAW5H,KAAK6H,SAAL,CAAe,MAAf,EAAuB,GAAvB,CAAf;AACAvG,WAAOwG,UAAP,GAAoB,UAASrG,OAAT,EAAkBf,YAAlB,EAA+B;AAC/C,YAAIqH,OAAOtG,QAAQ,WAAR,CAAX;;AAEA,YAAIH,SAASsG,SAASI,OAAT,CAAiBD,IAAjB,CAAb;AACA,YAAG,CAACzG,MAAJ,EACI,OAAOR,GAAGG,GAAH,CAAO,wBAAP,EAAiC8G,IAAjC,CAAP;;AAEJ,YAAIvG,OAAOF,OAAO2G,IAAP,CAAYL,QAAZ,EAAsBnG,OAAtB,EAA+Bf,YAA/B,CAAX;AACA,YAAGc,IAAH,EAAQ;AACJ,gBAAIS,gBAAgBR,QAAQ,eAAR,CAApB;AACA,gBAAIS,gBAAgBT,QAAQ,eAAR,CAApB;AACA,gBAAIU,QAAgBV,QAAQ,OAAR,CAApB;AACA,gBAAIW,QAAgBX,QAAQ,OAAR,CAApB;AACA,gBAAGQ,iBAAiB,CAApB,EACIT,KAAK4B,YAAL,CAAkBnB,aAAlB;AACJ,gBAAGC,iBAAiB,CAApB,EACIV,KAAK6B,YAAL,CAAkBnB,aAAlB;AACJ,gBAAGC,SAAS,CAAZ,EACIX,KAAK8B,QAAL,CAAcnB,KAAd;AACJ,gBAAGC,SAAS,CAAZ,EACIZ,KAAK+B,QAAL,CAAcnB,KAAd;;AAEJ,gBAAIS,YAAYpB,QAAQ,WAAR,CAAhB;AACAD,iBAAKyC,aAAL,CAAmB,IAAIC,IAAIC,kBAAR,CAA2BtB,SAA3B,CAAnB;AACH;AACD,eAAOrB,IAAP;AACH,KA1BD;;AA4BA,QAAI0G,WAAW,CACX,EAACC,MAAM,MAAP,EAAeC,QAAQ9G,OAAO4E,QAA9B,EADW,EAEX,EAACiC,MAAM,UAAP,EAAmBC,QAAQ9G,OAAO8E,YAAlC,EAFW,EAGX,EAAC+B,MAAM,QAAP,EAAiBC,QAAQ9G,OAAOiF,UAAhC,EAHW,EAIX,EAAC4B,MAAM,UAAP,EAAmBC,QAAQ9G,OAAO4F,YAAlC,EAJW,EAKX,EAACiB,MAAM,aAAP,EAAsBC,QAAQ9G,OAAOiG,eAArC,EALW,EAOX,EAACY,MAAM,QAAP,EAAiBC,QAAQ9G,OAAOwG,UAAhC,EAPW,EAQX,EAACK,MAAM,OAAP,EAAgBC,QAAQ9G,OAAOwG,UAA/B,EARW,EASX,EAACK,MAAM,QAAP,EAAiBC,QAAQ9G,OAAOwG,UAAhC,EATW,EAUX,EAACK,MAAM,UAAP,EAAmBC,QAAQ9G,OAAOwG,UAAlC,EAVW,EAWX,EAACK,MAAM,WAAP,EAAoBC,QAAQ9G,OAAOwG,UAAnC,EAXW,EAYX,EAACK,MAAM,YAAP,EAAqBC,QAAQ9G,OAAOwG,UAApC,EAZW,EAaX,EAACK,MAAM,aAAP,EAAsBC,QAAQ9G,OAAOwG,UAArC,EAbW,EAcX,EAACK,MAAM,OAAP,EAAgBC,QAAQ9G,OAAOwG,UAA/B,EAdW,EAeX,EAACK,MAAM,UAAP,EAAmBC,QAAQ9G,OAAOwG,UAAlC,EAfW,EAgBX,EAACK,MAAM,YAAP,EAAqBC,QAAQ9G,OAAOwG,UAApC,EAhBW,EAiBX,EAACK,MAAM,UAAP,EAAmBC,QAAQ9G,OAAOwG,UAAlC,EAjBW,EAkBX,EAACK,MAAM,YAAP,EAAqBC,QAAQ9G,OAAOwG,UAApC,EAlBW,EAmBX,EAACK,MAAM,QAAP,EAAiBC,QAAQ9G,OAAOwG,UAAhC,EAnBW,EAoBX,EAACK,MAAM,WAAP,EAAoBC,QAAQ9G,OAAOwG,UAAnC,EApBW,CAAf;;AAuBAI,aAASG,OAAT,CAAiB,UAASC,IAAT,EAAc;AAC3BhH,eAAOiH,cAAP,CAAsBD,KAAKH,IAA3B,EAAiC,UAAS1G,OAAT,EAAkBiD,KAAlB,EAAyBhE,YAAzB,EAAsC;AACnE,gBAAIc,OAAO8G,KAAKF,MAAL,CAAYH,IAAZ,CAAiB,IAAjB,EAAuBxG,QAAQ,SAAR,CAAvB,CAAX;AACA,iBAAK2C,cAAL,CAAoB5C,IAApB,EAA0BC,QAAQ,YAAR,CAA1B;AACA,iBAAKgD,UAAL,CAAgBC,KAAhB,EAAuBlD,IAAvB,EAA6BC,OAA7B,EAAsCf,YAAtC;AACA,mBAAOc,IAAP;AACH,SALD;AAMH,KAPD;;AASAxB,SAAKuI,cAAL,CAAoB,UAApB,EAAgC,KAAhC,EAAuCjH,MAAvC;AACAtB,SAAKuI,cAAL,CAAoB,UAApB,EAAgC,KAAhC,EAAuCjH,MAAvC;AAEH,CA5QD,EA4QG4C,IAAIsE,KA5QP,EA4QctE,IAAIuE,OA5QlB","file":"timelineParser-1.x.js","sourceRoot":"../../../../../../../../../../../assets/frameworks/cocos2d-x/cocos/scripting/js-bindings/script/studio/parsers","sourcesContent":["/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n(function(load, baseParser){\n\n    var loadedPlist = {};\n\n    var Parser = baseParser.extend({\n\n        getNodeJson: function(json){\n            return json[\"nodeTree\"];\n        },\n\n        addSpriteFrame: function(plists, pngs, resourcePath){\n            if(!plists || !pngs || plists.length !== pngs.length)\n                return;\n            for (var i = 0; i < plists.length; i++) {\n                var plist = resourcePath + plists[i];\n                if(!cc.loader.getRes(plist) && !loadedPlist[plist])\n                    cc.log(\"%s need to be preloaded\", plist);\n                else\n                    loadedPlist[plist] = true;\n                cc.spriteFrameCache.addSpriteFrames(\n                    plist,\n                    resourcePath + pngs[i]\n                );\n            }\n        },\n\n        pretreatment: function(json, resourcePath, file){\n            this.addSpriteFrame(json[\"textures\"], json[\"texturesPng\"], resourcePath);\n        }\n\n    });\n    var parser = new Parser();\n\n    parser.generalAttributes = function(node, options){\n        var width         = options[\"width\"]        !=null ? options[\"width\"] : 0;\n        var height        = options[\"height\"]       !=null ? options[\"height\"] : 0;\n        var x             = options[\"x\"]            !=null ? options[\"x\"] : 0;\n        var y             = options[\"y\"]            !=null ? options[\"y\"] : 0;\n        var scalex        = options[\"scaleX\"]       !=null ? options[\"scaleX\"] : 1;\n        var scaley        = options[\"scaleY\"]       !=null ? options[\"scaleY\"] : 1;\n        var rotation      = options[\"rotation\"]     !=null ? options[\"rotation\"] : 0;\n        var rotationSkewX = options[\"rotationSkewX\"]!=null ? options[\"rotationSkewX\"] : 0;\n        var rotationSkewY = options[\"rotationSkewY\"]!=null ? options[\"rotationSkewY\"] : 0;\n        var skewx         = options[\"skewX\"]        !=null ? options[\"skewX\"] : 0;\n        var skewy         = options[\"skewY\"]        !=null ? options[\"skewY\"] : 0;\n        var anchorx       = options[\"anchorPointX\"] !=null ? options[\"anchorPointX\"] : 0.5;\n        var anchory       = options[\"anchorPointY\"] !=null ? options[\"anchorPointY\"] : 0.5;\n        var alpha         = options[\"opacity\"]      !=null ? options[\"opacity\"] : 255;\n        var red           = options[\"colorR\"]       !=null ? options[\"colorR\"] : 255;\n        var green         = options[\"colorG\"]       !=null ? options[\"colorG\"] : 255;\n        var blue          = options[\"colorB\"]       !=null ? options[\"colorB\"] : 255;\n        var zorder        = options[\"colorR\"]       !=null ? options[\"colorR\"] : 0;\n        var tag           = options[\"tag\"]          !=null ? options[\"tag\"] : 0;\n        var actionTag     = options[\"actionTag\"]    !=null ? options[\"actionTag\"] : 0;\n        var visible       = options[\"visible\"]      !=null ? options[\"visible\"] : true;\n\n        if(x != 0 || y != 0)\n            node.setPosition(cc.p(x, y));\n        if(scalex != 1)\n            node.setScaleX(scalex);\n        if(scaley != 1)\n            node.setScaleY(scaley);\n        if (rotation != 0)\n            node.setRotation(rotation);\n        if(rotationSkewX != 0)\n            node.setRotationX(rotationSkewX);\n        if(rotationSkewY != 0)\n            node.setRotationY(rotationSkewY);\n        if(skewx != 0)\n            node.setSkewX(skewx);\n        if(skewy != 0)\n            node.setSkewY(skewy);\n        if(anchorx != 0.5 || anchory != 0.5)\n            node.setAnchorPoint(cc.p(anchorx, anchory));\n        if(width != 0 || height != 0)\n            node.setContentSize(cc.size(width, height));\n        if(zorder != 0)\n            node.setLocalZOrder(zorder);\n        if(visible != true)\n            node.setVisible(visible);\n\n        if(alpha != 255)\n        {\n            node.setOpacity(alpha);\n        }\n        if(red != 255 || green != 255 || blue != 255)\n        {\n            node.setColor(cc.color(red, green, blue));\n        }\n\n\n        node.setTag(tag);\n        node.setUserObject(new ccs.ActionTimelineData(actionTag));\n    };\n\n    parser.parseComponent = function(node, options){\n        if(!options) return;\n        for (var i = 0; i < options.length; ++i){\n            var dic = options[i];\n            var component = this.loadComponent(dic);\n            if (component){\n                node.addComponent(component);\n            }\n        }\n    };\n\n    parser.parseChild = function(parse, widget, options, resourcePath){\n        var children = options[\"children\"];\n        for (var i = 0; i < children.length; i++) {\n            var child = this.parseNode(children[i], resourcePath);\n            if(child){\n                if(widget instanceof ccui.PageView){\n                    if(child instanceof ccui.Layout)\n                        widget.addPage(child);\n                } else {\n                    if(widget instanceof ccui.ListView){\n                        if(child instanceof ccui.Widget)\n                            widget.pushBackCustomItem(child);\n                    } else {\n                        if(!(widget instanceof ccui.Layout) && child instanceof ccui.Widget) {\n                            if(child.getPositionType() === ccui.Widget.POSITION_PERCENT) {\n                                var position = child.getPositionPercent();\n                                var anchor = widget.getAnchorPoint();\n                                child.setPositionPercent(cc.p(position.x + anchor.x, position.y + anchor.y));\n                            }\n                            //To make up for the studio positioning error problem\n                            var AnchorPointIn = widget.getAnchorPointInPoints();\n                            child.setPosition(cc.p(child.getPositionX() + AnchorPointIn.x, child.getPositionY() + AnchorPointIn.y));\n                        }\n                        widget.addChild(child);\n                    }\n                }\n            }\n        }\n    };\n\n    parser.initNode = function(options){\n        var node = new cc.Node();\n        this.generalAttributes(node, options);\n        return node;\n    };\n    parser.initSubGraph = function(options){\n        var filePath = options[\"fileName\"];\n\n        var node;\n        if (filePath && \"\" !== filePath){\n            node = this.createNode(filePath);\n        }else{\n            node = new ccs.Node();\n        }\n        this.generalAttributes(node, options);\n        return node;\n    };\n    parser.initSprite = function(options, resourcePath){\n        var path = options[\"fileName\"];\n        var sprite;\n        if(path != null){\n            var spriteFrame = cc.spriteFrameCache.getSpriteFrame(path);\n            if(!spriteFrame){\n                path = resourcePath + path;\n                sprite = new ccs.Sprite(path);\n            }else{\n                sprite = ccs.Sprite.createWithSpriteFrame(spriteFrame);\n            }\n\n            if(!sprite){\n                sprite = new cc.Sprite();\n                cc.log(\"filePath is empty. Create a sprite with no texture\");\n            }\n        }else{\n            sprite = new ccs.Sprite();\n        }\n        this.generalAttributes(sprite, options);\n        var flipX = options[\"flipX\"];\n        var flipY = options[\"flipY\"];\n\n        if(flipX != false)\n            sprite.setFlippedX(flipX);\n        if(flipY != false)\n            sprite.setFlippedY(flipY);\n        return sprite;\n    };\n    parser.initParticle = function(options, resourcePath){\n        var filePath = options[\"plistFile\"];\n        var num = options[\"tmxFile\"];\n        var particle = new cc.ParticleSystemQuad(filePath);\n        particle.setTotalParticles(num);\n        this.generalAttributes(particle, options);\n        return particle;\n    };\n    parser.initTMXTiledMap = function(options, resourcePath){\n        var tmxFile = options[\"tmxFile\"];\n        var tmxString = options[\"tmxString\"];\n        //todo check path and resourcePath\n        var path = options[\"resourcePath\"];\n\n        var tmx = null;\n        if (tmxFile && \"\" !== tmxFile){\n            tmx = new cc.TMXTiledMap(tmxFile);\n        }else if (tmxString && \"\" !== tmxString && path && \"\" !== path){\n            tmx = new cc.TMXTiledMap(tmxString, path);\n        }\n        return tmx;\n    };\n    var uiParser = load.getParser(\"ccui\")[\"*\"];\n    parser.initWidget = function(options, resourcePath){\n        var type = options[\"classname\"];\n\n        var parser = uiParser.parsers[type];\n        if(!parser)\n            return cc.log(\"%s parser is not found\", type);\n\n        var node = parser.call(uiParser, options, resourcePath);\n        if(node){\n            var rotationSkewX = options[\"rotationSkewX\"];\n            var rotationSkewY = options[\"rotationSkewY\"];\n            var skewx         = options[\"skewX\"];\n            var skewy         = options[\"skewY\"];\n            if(rotationSkewX != 0)\n                node.setRotationX(rotationSkewX);\n            if(rotationSkewY != 0)\n                node.setRotationY(rotationSkewY);\n            if(skewx != 0)\n                node.setSkewX(skewx);\n            if(skewy != 0)\n                node.setSkewY(skewy);\n\n            var actionTag = options[\"actionTag\"];\n            node.setUserObject(new ccs.ActionTimelineData(actionTag));\n        }\n        return node;\n    };\n\n    var register = [\n        {name: \"Node\", handle: parser.initNode},\n        {name: \"SubGraph\", handle: parser.initSubGraph},\n        {name: \"Sprite\", handle: parser.initSprite},\n        {name: \"Particle\", handle: parser.initParticle},\n        {name: \"TMXTiledMap\", handle: parser.initTMXTiledMap},\n\n        {name: \"Widget\", handle: parser.initWidget},\n        {name: \"Panel\", handle: parser.initWidget},\n        {name: \"Button\", handle: parser.initWidget},\n        {name: \"CheckBox\", handle: parser.initWidget},\n        {name: \"ImageView\", handle: parser.initWidget},\n        {name: \"LabelAtlas\", handle: parser.initWidget},\n        {name: \"LabelBMFont\", handle: parser.initWidget},\n        {name: \"Label\", handle: parser.initWidget},\n        {name: \"ListView\", handle: parser.initWidget},\n        {name: \"LoadingBar\", handle: parser.initWidget},\n        {name: \"PageView\", handle: parser.initWidget},\n        {name: \"ScrollView\", handle: parser.initWidget},\n        {name: \"Slider\", handle: parser.initWidget},\n        {name: \"TextField\", handle: parser.initWidget}\n    ];\n\n    register.forEach(function(item){\n        parser.registerParser(item.name, function(options, parse, resourcePath){\n            var node = item.handle.call(this, options[\"options\"]);\n            this.parseComponent(node, options[\"components\"]);\n            this.parseChild(parse, node, options, resourcePath);\n            return node;\n        });\n    });\n\n    load.registerParser(\"timeline\", \"0.*\", parser);\n    load.registerParser(\"timeline\", \"1.*\", parser);\n\n})(ccs._load, ccs._parser);\n"]}