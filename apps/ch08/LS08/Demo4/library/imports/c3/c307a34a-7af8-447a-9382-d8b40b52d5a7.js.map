{"version":3,"sources":["../../../../../../../../../assets/frameworks/cocos2d-html5/extensions/cocostudio/armature/utils/assets/frameworks/cocos2d-html5/extensions/cocostudio/armature/utils/CCDataReaderHelper.js"],"names":["ccs","CONST_VERSION","CONST_VERSION_2_0","CONST_VERSION_COMBINED","CONST_ARMATURES","CONST_ARMATURE","CONST_BONE","CONST_DISPLAY","CONST_ANIMATIONS","CONST_ANIMATION","CONST_MOVEMENT","CONST_FRAME","CONST_TEXTURE_ATLAS","CONST_SUB_TEXTURE","CONST_SKELETON","CONST_A_NAME","CONST_A_DURATION","CONST_A_FRAME_INDEX","CONST_A_DURATION_TO","CONST_A_DURATION_TWEEN","CONST_A_LOOP","CONST_A_MOVEMENT_SCALE","CONST_A_MOVEMENT_DELAY","CONST_A_DISPLAY_INDEX","CONST_A_PLIST","CONST_A_PARENT","CONST_A_SKEW_X","CONST_A_SKEW_Y","CONST_A_SCALE_X","CONST_A_SCALE_Y","CONST_A_Z","CONST_A_EVENT","CONST_A_SOUND","CONST_A_SOUND_EFFECT","CONST_A_TWEEN_EASING","CONST_A_EASING_PARAM","CONST_A_TWEEN_ROTATE","CONST_A_IS_ARMATURE","CONST_A_DISPLAY_TYPE","CONST_A_MOVEMENT","CONST_A_X","CONST_A_Y","CONST_A_COCOS2DX_X","CONST_A_COCOS2DX_Y","CONST_A_WIDTH","CONST_A_HEIGHT","CONST_A_PIVOT_X","CONST_A_PIVOT_Y","CONST_A_COCOS2D_PIVOT_X","CONST_A_COCOS2D_PIVOT_Y","CONST_A_BLEND_TYPE","CONST_A_BLEND_SRC","CONST_A_BLEND_DST","CONST_A_ALPHA","CONST_A_RED","CONST_A_GREEN","CONST_A_BLUE","CONST_A_ALPHA_OFFSET","CONST_A_RED_OFFSET","CONST_A_GREEN_OFFSET","CONST_A_BLUE_OFFSET","CONST_A_COLOR_TRANSFORM","CONST_A_TWEEN_FRAME","CONST_CONTOUR","CONST_CONTOUR_VERTEX","CONST_FL_NAN","CONST_FRAME_DATA","CONST_MOVEMENT_BONE_DATA","CONST_MOVEMENT_DATA","CONST_ANIMATION_DATA","CONST_DISPLAY_DATA","CONST_SKIN_DATA","CONST_BONE_DATA","CONST_ARMATURE_DATA","CONST_CONTOUR_DATA","CONST_TEXTURE_DATA","CONST_VERTEX_POINT","CONST_COLOR_INFO","CONST_CONFIG_FILE_PATH","CONST_CONTENT_SCALE","DataInfo","asyncStruct","configFileQueue","contentScale","filename","baseFilePath","flashToolVersion","cocoStudioVersion","dataReaderHelper","ConfigType","DragonBone_XML","CocoStudio_JSON","CocoStudio_Binary","_configFileList","_flashToolVersion","_positionReadScale","_asyncRefCount","_asyncRefTotalCount","_dataQueue","setPositionReadScale","scale","getPositionReadScale","addDataFromFile","filePath","indexOf","push","basefilePath","_initBaseFilePath","str","cc","path","extname","toLowerCase","dataInfo","addDataFromXML","addDataFromJson","addDataFromBinaryCache","addDataFromFileAsync","imagePath","plistPath","selector","target","_asyncCallBack","self","fun","director","getScheduler","schedule","removeConfigFile","configFile","locFileList","len","length","it","i","arrayRemoveObject","addDataFromCache","skeleton","log","parseFloat","getAttribute","armaturesXML","querySelectorAll","armatureDataManager","armatureData","decodeArmature","addArmatureData","name","animationsXML","animationData","decodeAnimation","addAnimationData","texturesXML","textureData","decodeTexture","addTextureData","armatureXML","ArmatureData","init","bonesXML","boneXML","parentName","parentXML","j","boneData","decodeBone","addBoneData","decodeArmatureFromJSON","json","dataVersion","boneDataList","decodeBoneFromJson","BoneData","zOrder","parseInt","displaysXML","displayXML","displayData","decodeBoneDisplay","addDisplayData","decodeNodeFromJson","displayDataList","locDisplayData","decodeBoneDisplayFromJson","isArmature","ArmatureDisplayData","displayType","DISPLAY_TYPE_ARMATURE","SpriteDisplayData","DISPLAY_TYPE_SPRITE","displayName","dicArray","dic","skinData","x","y","scaleX","scaleY","skewX","skewY","DISPLAY_TYPE_PARTICLE","ParticleDisplayData","plist","animationXML","aniData","AnimationData","getArmatureData","movementsXML","movementXML","movementData","decodeMovement","addMovement","decodeAnimationFromJson","movementDataList","locMovementData","decodeMovementFromJson","MovementData","duration","durationTo","durationTween","loop","tweenEasing","Boolean","easing","TweenType","SINE_EASEINOUT","LINEAR","movBonesXml","movBoneXml","boneName","getMovementBoneData","getBoneData","moveBoneData","decodeMovementBone","addMovementBoneData","movementBoneList","locMovementBoneData","decodeMovementBoneFromJson","parentXml","movBoneData","MovementBoneData","delay","parentTotalDuration","currentDuration","parentFrameXML","parentXMLList","parentFramesXML","framesXML","totalDuration","ii","frameXML","boneFrameData","decodeFrame","addFrameData","frameID","frames","frameList","pi","Math","PI","difSkewX","difSkewY","frameData","FrameData","copy","movementBoneData","framesData","decodeFrameFromJson","VERSION_CHANGE_ROTATION_RANGE","parentFrameXml","scale_x","scale_y","skew_x","skew_y","tweenRotate","displayIndex","blendType","strMovement","movement","strEvent","event","strSound","sound","strSoundEffect","soundEffect","isTween","undefined","degreesToRadians","blendFunc","BLEND_TYPE_NORMAL","src","BLEND_SRC","dst","BLEND_DST","BLEND_TYPE_ADD","SRC_ALPHA","ONE","BLEND_TYPE_MULTIPLY","DST_COLOR","ONE_MINUS_SRC_ALPHA","BLEND_TYPE_SCREEN","ONE_MINUS_DST_COLOR","colorTransformXML","alpha","red","green","blue","alphaOffset","redOffset","greenOffset","blueOffset","a","r","g","b","isUseColorInfo","_easing","helpNode","BaseData","TransformHelp","transformFromParent","bd_src","bd_dst","twEPs","easingParams","textureXML","TextureData","px","py","width","height","anchorPointX","anchorPointY","pivotX","pivotY","contoursXML","addContourData","decodeContour","decodeTextureFromJson","contourDataList","decodeContourFromJson","contourXML","contourData","ContourData","vertexDatasXML","vertexDataXML","vertex","p","vertexList","vertexPointList","addDataFromJsonCache","armatureDataArr","animationDataArr","textureDataArr","autoLoad","isAutoLoadSpriteFile","autoLoadSpriteFile","configFiles","locFilePath","locPos","locPlistPath","locImagePath","lastIndexOf","substring","addSpriteFrameFromFile","node","colorDic","VERSION_COLOR_READING","clear","percent","isFunction","call","pos","substr","xml","xmlStr","loader","getRes","Error","skeletonXML","saxParser","parse","documentElement","fileContent"],"mappings":"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","file":"CCDataReaderHelper.js","sourceRoot":"../../../../../../../../../assets/frameworks/cocos2d-html5/extensions/cocostudio/armature/utils","sourcesContent":["/****************************************************************************\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @ignore\n */\nccs.CONST_VERSION = \"version\";\nccs.CONST_VERSION_2_0 = 2.0;\nccs.CONST_VERSION_COMBINED = 0.3;\n\nccs.CONST_ARMATURES = \"armatures\";\nccs.CONST_ARMATURE = \"armature\";\nccs.CONST_BONE = \"b\";\nccs.CONST_DISPLAY = \"d\";\n\nccs.CONST_ANIMATIONS = \"animations\";\nccs.CONST_ANIMATION = \"animation\";\nccs.CONST_MOVEMENT = \"mov\";\nccs.CONST_FRAME = \"f\";\n\nccs.CONST_TEXTURE_ATLAS = \"TextureAtlas\";\nccs.CONST_SUB_TEXTURE = \"SubTexture\";\n\nccs.CONST_SKELETON = \"skeleton\";\n\nccs.CONST_A_NAME = \"name\";\nccs.CONST_A_DURATION = \"dr\";\nccs.CONST_A_FRAME_INDEX = \"fi\";\nccs.CONST_A_DURATION_TO = \"to\";\nccs.CONST_A_DURATION_TWEEN = \"drTW\";\nccs.CONST_A_LOOP = \"lp\";\nccs.CONST_A_MOVEMENT_SCALE = \"sc\";\nccs.CONST_A_MOVEMENT_DELAY = \"dl\";\nccs.CONST_A_DISPLAY_INDEX = \"dI\";\n\nccs.CONST_A_PLIST = \"plist\";\n\nccs.CONST_A_PARENT = \"parent\";\nccs.CONST_A_SKEW_X = \"kX\";\nccs.CONST_A_SKEW_Y = \"kY\";\nccs.CONST_A_SCALE_X = \"cX\";\nccs.CONST_A_SCALE_Y = \"cY\";\nccs.CONST_A_Z = \"z\";\nccs.CONST_A_EVENT = \"evt\";\nccs.CONST_A_SOUND = \"sd\";\nccs.CONST_A_SOUND_EFFECT = \"sdE\";\nccs.CONST_A_TWEEN_EASING = \"twE\";\nccs.CONST_A_EASING_PARAM = \"twEP\";\nccs.CONST_A_TWEEN_ROTATE = \"twR\";\nccs.CONST_A_IS_ARMATURE = \"isArmature\";\nccs.CONST_A_DISPLAY_TYPE = \"displayType\";\nccs.CONST_A_MOVEMENT = \"mov\";\n\nccs.CONST_A_X = \"x\";\nccs.CONST_A_Y = \"y\";\n\nccs.CONST_A_COCOS2DX_X = \"cocos2d_x\";\nccs.CONST_A_COCOS2DX_Y = \"cocos2d_y\";\n\nccs.CONST_A_WIDTH = \"width\";\nccs.CONST_A_HEIGHT = \"height\";\nccs.CONST_A_PIVOT_X = \"pX\";\nccs.CONST_A_PIVOT_Y = \"pY\";\n\nccs.CONST_A_COCOS2D_PIVOT_X = \"cocos2d_pX\";\nccs.CONST_A_COCOS2D_PIVOT_Y = \"cocos2d_pY\";\n\nccs.CONST_A_BLEND_TYPE = \"bd\";\nccs.CONST_A_BLEND_SRC = \"bd_src\";\nccs.CONST_A_BLEND_DST = \"bd_dst\";\n\nccs.CONST_A_ALPHA = \"a\";\nccs.CONST_A_RED = \"r\";\nccs.CONST_A_GREEN = \"g\";\nccs.CONST_A_BLUE = \"b\";\nccs.CONST_A_ALPHA_OFFSET = \"aM\";\nccs.CONST_A_RED_OFFSET = \"rM\";\nccs.CONST_A_GREEN_OFFSET = \"gM\";\nccs.CONST_A_BLUE_OFFSET = \"bM\";\nccs.CONST_A_COLOR_TRANSFORM = \"colorTransform\";\nccs.CONST_A_TWEEN_FRAME = \"tweenFrame\";\n\nccs.CONST_CONTOUR = \"con\";\nccs.CONST_CONTOUR_VERTEX = \"con_vt\";\n\nccs.CONST_FL_NAN = \"NaN\";\n\nccs.CONST_FRAME_DATA = \"frame_data\";\nccs.CONST_MOVEMENT_BONE_DATA = \"mov_bone_data\";\nccs.CONST_MOVEMENT_DATA = \"mov_data\";\nccs.CONST_ANIMATION_DATA = \"animation_data\";\nccs.CONST_DISPLAY_DATA = \"display_data\";\nccs.CONST_SKIN_DATA = \"skin_data\";\nccs.CONST_BONE_DATA = \"bone_data\";\nccs.CONST_ARMATURE_DATA = \"armature_data\";\nccs.CONST_CONTOUR_DATA = \"contour_data\";\nccs.CONST_TEXTURE_DATA = \"texture_data\";\nccs.CONST_VERTEX_POINT = \"vertex\";\nccs.CONST_COLOR_INFO = \"color\";\n\nccs.CONST_CONFIG_FILE_PATH = \"config_file_path\";\nccs.CONST_CONTENT_SCALE = \"content_scale\";\n\n/**\n * @ignore\n * @constructor\n */\nccs.DataInfo = function () {\n    this.asyncStruct = null;\n    this.configFileQueue = [];\n    this.contentScale = 1;\n    this.filename = \"\";\n    this.baseFilePath = \"\";\n    this.flashToolVersion = 0;\n    this.cocoStudioVersion = 0\n};\n\n/**\n * ccs.dataReaderHelper is a singleton object for reading CocoStudio data\n * @class\n * @name ccs.dataReaderHelper\n */\nccs.dataReaderHelper = /** @lends ccs.dataReaderHelper# */{\n    ConfigType: {\n        DragonBone_XML: 0,\n        CocoStudio_JSON: 1,\n        CocoStudio_Binary: 2\n    },\n\n    _configFileList: [],\n    _flashToolVersion: ccs.CONST_VERSION_2_0,\n//    _cocoStudioVersion: ccs.CONST_VERSION_COMBINED,\n    _positionReadScale: 1,\n    _asyncRefCount: 0,\n    _asyncRefTotalCount: 0,\n\n    _dataQueue: null,\n\n    //LoadData don't need\n\n    setPositionReadScale: function (scale) {\n        this._positionReadScale = scale;\n    },\n\n    getPositionReadScale: function () {\n        return this._positionReadScale;\n    },\n\n    /**\n     * Add armature data from file.\n     * @param {String} filePath\n     */\n    addDataFromFile: function (filePath) {\n        /*\n         * Check if file is already added to ArmatureDataManager, if then return.\n         */\n        if (this._configFileList.indexOf(filePath) !== -1)\n            return;\n        this._configFileList.push(filePath);\n\n        //! find the base file path\n        var basefilePath = this._initBaseFilePath(filePath);\n\n        // Read content from file\n        // Here the reader into the next process\n\n        var str = cc.path.extname(filePath).toLowerCase();\n\n        var dataInfo = new ccs.DataInfo();\n        dataInfo.filename = filePath;\n        dataInfo.basefilePath = basefilePath;\n        if (str === \".xml\")\n            ccs.dataReaderHelper.addDataFromXML(filePath, dataInfo);\n        else if (str === \".json\" || str === \".exportjson\")\n            ccs.dataReaderHelper.addDataFromJson(filePath, dataInfo);\n        else if(str === \".csb\")\n            ccs.dataReaderHelper.addDataFromBinaryCache(filePath, dataInfo);\n    },\n\n    /**\n     * Adds data from file with Async.\n     * @param {String} imagePath\n     * @param {String} plistPath\n     * @param {String} filePath\n     * @param {function} selector\n     * @param {Object} [target]\n     */\n    addDataFromFileAsync: function (imagePath, plistPath, filePath, selector, target) {\n        /*\n         * Check if file is already added to ArmatureDataManager, if then return.\n         */\n        if (this._configFileList.indexOf(filePath) !== -1) {\n            if (target && selector) {\n                if (this._asyncRefTotalCount === 0 && this._asyncRefCount === 0)\n                    this._asyncCallBack(selector,target, 1);\n                else\n                    this._asyncCallBack(selector, target, (this._asyncRefTotalCount - this._asyncRefCount) / this._asyncRefTotalCount);\n            }\n            return;\n        }\n//        this._configFileList.push(filePath);\n\n        //! find the base file path\n//        var basefilePath = this._initBaseFilePath(filePath);\n\n        this._asyncRefTotalCount++;\n        this._asyncRefCount++;\n        var self = this;\n        var fun = function () {\n            self.addDataFromFile(filePath);\n            self._asyncRefCount--;\n            self._asyncCallBack(selector,target, (self._asyncRefTotalCount - self._asyncRefCount) / self._asyncRefTotalCount);\n        };\n        cc.director.getScheduler().schedule(fun, this, 0.1, false, 0, false, \"armatrueDataHelper\");\n    },\n\n    /**\n     * Removes config file from config file list.\n     * @param {String} configFile\n     */\n    removeConfigFile: function (configFile) {\n//        cc.arrayRemoveObject(this._configFileList, configFile);\n        var locFileList = this._configFileList;\n        var len = locFileList.length;\n        var it = locFileList[len];\n        for (var i = 0;i<len; i++){\n            if (locFileList[i] === configFile)\n                it = i;\n        }\n\n        if (it !== locFileList[len])\n            cc.arrayRemoveObject(locFileList, configFile);\n    },\n\n    /**\n     * Translate XML export from Dragon Bone flash tool to data, and save them. When you add a new xml, the data already saved will be keeped.\n     * @param {Object} skeleton\n     * @param {ccs.DataInfo} dataInfo\n     */\n    addDataFromCache: function (skeleton, dataInfo) {\n        if (!skeleton) {\n            cc.log(\"XML error  or  XML is empty.\");\n            return;\n        }\n        dataInfo.flashToolVersion = parseFloat(skeleton.getAttribute(ccs.CONST_VERSION));\n\n        /*\n         * Begin decode armature data from xml\n         */\n        var armaturesXML = skeleton.querySelectorAll(ccs.CONST_SKELETON + \" > \" + ccs.CONST_ARMATURES + \" >  \" + ccs.CONST_ARMATURE + \"\");\n        var armatureDataManager = ccs.armatureDataManager, i;\n        for (i = 0; i < armaturesXML.length; i++) {\n            var armatureData = this.decodeArmature(armaturesXML[i], dataInfo);\n            armatureDataManager.addArmatureData(armatureData.name, armatureData, dataInfo.filename);\n        }\n\n        /*\n         * Begin decode animation data from xml\n         */\n        var animationsXML = skeleton.querySelectorAll(ccs.CONST_SKELETON + \" > \" + ccs.CONST_ANIMATIONS + \" >  \" + ccs.CONST_ANIMATION + \"\");\n        for (i = 0; i < animationsXML.length; i++) {\n            var animationData = this.decodeAnimation(animationsXML[i], dataInfo);\n            armatureDataManager.addAnimationData(animationData.name, animationData, dataInfo.filename);\n        }\n\n        var texturesXML = skeleton.querySelectorAll(ccs.CONST_SKELETON + \" > \" + ccs.CONST_TEXTURE_ATLAS + \" >  \" + ccs.CONST_SUB_TEXTURE + \"\");\n        for (i = 0; i < texturesXML.length; i++) {\n            var textureData = this.decodeTexture(texturesXML[i], dataInfo);\n            armatureDataManager.addTextureData(textureData.name, textureData, dataInfo.filename);\n        }\n    },\n\n    /**\n     * decode xml armature data.\n     * @param {XMLDocument} armatureXML\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.ArmatureData}\n     */\n    decodeArmature: function (armatureXML, dataInfo) {\n        var armatureData = new ccs.ArmatureData();\n        armatureData.init();\n        armatureData.name = armatureXML.getAttribute(ccs.CONST_A_NAME);\n\n        var bonesXML = armatureXML.querySelectorAll(ccs.CONST_ARMATURE + \" > \" + ccs.CONST_BONE);\n\n        for (var i = 0; i < bonesXML.length; i++) {\n            /*\n             *  If this bone have parent, then get the parent bone xml\n             */\n            var boneXML = bonesXML[i];\n            var parentName = boneXML.getAttribute(ccs.CONST_A_PARENT);\n            var parentXML = null;\n            if (parentName) {\n                //parentXML = armatureXML.querySelectorAll(ccs.CONST_ARMATURE+\" > \"+ccs.CONST_BONE);\n                for (var j = 0; j < bonesXML.length; j++) {\n                    parentXML = bonesXML[j];\n                    if (parentName == bonesXML[j].getAttribute(ccs.CONST_A_NAME)) {\n                        //todo\n                        break;\n                    }\n                }\n            }\n            var boneData = this.decodeBone(boneXML, parentXML, dataInfo);\n            armatureData.addBoneData(boneData);\n        }\n        return armatureData;\n    },\n\n    /**\n     * decode json armature data.\n     * @param {Object} json\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.ArmatureData}\n     */\n    decodeArmatureFromJSON: function (json, dataInfo) {\n        var armatureData = new ccs.ArmatureData();\n        armatureData.init();\n\n        var name = json[ccs.CONST_A_NAME];\n        if (name) {\n            armatureData.name = name;\n        }\n\n        dataInfo.cocoStudioVersion = armatureData.dataVersion = json[ccs.CONST_VERSION] || 0.1;\n\n        var boneDataList = json[ccs.CONST_BONE_DATA];\n        for (var i = 0; i < boneDataList.length; i++) {\n            var boneData = this.decodeBoneFromJson(boneDataList[i], dataInfo);\n            armatureData.addBoneData(boneData);\n        }\n        return armatureData;\n    },\n\n    /**\n     * decode xml bone data.\n     * @param {XMLDocument} boneXML\n     * @param {XMLDocument} parentXML\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.BoneData}\n     */\n    decodeBone: function (boneXML, parentXML, dataInfo) {\n        var boneData = new ccs.BoneData();\n        boneData.init();\n\n        boneData.name = boneXML.getAttribute(ccs.CONST_A_NAME);\n        boneData.parentName = boneXML.getAttribute(ccs.CONST_A_PARENT) || \"\";\n\n        boneData.zOrder = parseInt(boneXML.getAttribute(ccs.CONST_A_Z)) || 0;\n\n        var displaysXML = boneXML.querySelectorAll(ccs.CONST_BONE + \" > \" + ccs.CONST_DISPLAY);\n        for (var i = 0; i < displaysXML.length; i++) {\n            var displayXML = displaysXML[i];\n            var displayData = this.decodeBoneDisplay(displayXML, dataInfo);\n            boneData.addDisplayData(displayData);\n        }\n        return boneData;\n    },\n\n    /**\n     * decode json bone data.\n     * @param {Object} json json bone data.\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.BoneData}\n     */\n    decodeBoneFromJson: function (json, dataInfo) {\n        var boneData = new ccs.BoneData();\n        boneData.init();\n\n        this.decodeNodeFromJson(boneData, json, dataInfo);\n\n        boneData.name = json[ccs.CONST_A_NAME] || \"\";\n\n        boneData.parentName = json[ccs.CONST_A_PARENT] || \"\";\n        var displayDataList = json[ccs.CONST_DISPLAY_DATA] || [];\n        for (var i = 0; i < displayDataList.length; i++) {\n            var locDisplayData = this.decodeBoneDisplayFromJson(displayDataList[i], dataInfo);\n            boneData.addDisplayData(locDisplayData);\n        }\n        return boneData;\n    },\n\n    /**\n     * decode xml display data of bone\n     * @param {XMLDocument} displayXML\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.DisplayData}\n     */\n    decodeBoneDisplay: function (displayXML, dataInfo) {\n        var isArmature = parseFloat(displayXML.getAttribute(ccs.CONST_A_IS_ARMATURE)) || 0;\n        var displayData = null;\n\n        if (isArmature === 1) {\n            displayData = new ccs.ArmatureDisplayData();\n            displayData.displayType = ccs.DISPLAY_TYPE_ARMATURE;\n        } else {\n            displayData = new ccs.SpriteDisplayData();\n            displayData.displayType = ccs.DISPLAY_TYPE_SPRITE;\n        }\n\n        var displayName = displayXML.getAttribute(ccs.CONST_A_NAME) || \"\";\n        if (displayName) {\n            displayData.displayName = displayName;\n        }\n        return displayData;\n    },\n\n    /**\n     * Decodes json display data of bone.\n     * @param {Object} json\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.DisplayData}\n     */\n    decodeBoneDisplayFromJson: function (json, dataInfo) {\n        var displayType = json[ccs.CONST_A_DISPLAY_TYPE] || ccs.DISPLAY_TYPE_SPRITE;\n        var displayData = null;\n\n        switch (displayType) {\n            case ccs.DISPLAY_TYPE_SPRITE:\n                displayData = new ccs.SpriteDisplayData();\n\n                var name = json[ccs.CONST_A_NAME];\n                if(name != null){\n                    displayData.displayName =  name;\n                }\n\n                var dicArray = json[ccs.CONST_SKIN_DATA] || [];\n                var dic = dicArray[0];\n                if (dic) {\n                    var skinData = displayData.skinData;\n                    skinData.x = dic[ccs.CONST_A_X] * this._positionReadScale;\n                    skinData.y = dic[ccs.CONST_A_Y] * this._positionReadScale;\n                    skinData.scaleX = dic[ccs.CONST_A_SCALE_X] == null ? 1 : dic[ccs.CONST_A_SCALE_X];\n                    skinData.scaleY = dic[ccs.CONST_A_SCALE_Y] == null ? 1 : dic[ccs.CONST_A_SCALE_Y];\n                    skinData.skewX = dic[ccs.CONST_A_SKEW_X] == null ? 1 : dic[ccs.CONST_A_SKEW_X];\n                    skinData.skewY = dic[ccs.CONST_A_SKEW_Y] == null ? 1 : dic[ccs.CONST_A_SKEW_Y];\n\n                    skinData.x *= dataInfo.contentScale;\n                    skinData.y *= dataInfo.contentScale;\n                }\n                break;\n            case ccs.DISPLAY_TYPE_ARMATURE:\n                displayData = new ccs.ArmatureDisplayData();\n                var name = json[ccs.CONST_A_NAME];\n                if(name != null){\n                    displayData.displayName = json[ccs.CONST_A_NAME];\n                }\n                break;\n            case ccs.DISPLAY_TYPE_PARTICLE:\n                displayData = new ccs.ParticleDisplayData();\n                var plist = json[ccs.CONST_A_PLIST];\n                if(plist != null){\n                    if(dataInfo.asyncStruct){\n                        displayData.displayName = dataInfo.asyncStruct.basefilePath + plist;\n                    }else{\n                        displayData.displayName = dataInfo.basefilePath + plist;\n                    }\n                }\n                break;\n            default:\n                displayData = new ccs.SpriteDisplayData();\n                break;\n        }\n        displayData.displayType = displayType;\n        return displayData;\n    },\n\n    /**\n     * Decodes xml animation data.\n     * @param {XMLDocument} animationXML\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.AnimationData}\n     */\n    decodeAnimation: function (animationXML, dataInfo) {\n        var aniData = new ccs.AnimationData();\n        var name = animationXML.getAttribute(ccs.CONST_A_NAME);\n        var armatureData = ccs.armatureDataManager.getArmatureData(name);\n        aniData.name = name;\n\n        var movementsXML = animationXML.querySelectorAll(ccs.CONST_ANIMATION + \" > \" + ccs.CONST_MOVEMENT);\n        var movementXML = null;\n\n        for (var i = 0; i < movementsXML.length; i++) {\n            movementXML = movementsXML[i];\n            var movementData = this.decodeMovement(movementXML, armatureData, dataInfo);\n            aniData.addMovement(movementData);\n        }\n        return aniData;\n    },\n\n    /**\n     * Decodes animation json data.\n     * @param {Object} json\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.AnimationData}\n     */\n    decodeAnimationFromJson: function (json, dataInfo) {\n        var aniData = new ccs.AnimationData();\n        var name = json[ccs.CONST_A_NAME];\n        if(name){\n            aniData.name = json[ccs.CONST_A_NAME];\n        }\n\n        var movementDataList = json[ccs.CONST_MOVEMENT_DATA] || [];\n        for (var i = 0; i < movementDataList.length; i++) {\n            var locMovementData = this.decodeMovementFromJson(movementDataList[i], dataInfo);\n            aniData.addMovement(locMovementData);\n        }\n        return aniData;\n    },\n\n    /**\n     * Decodes xml movement data.\n     * @param {XMLDocument} movementXML\n     * @param {ccs.ArmatureData} armatureData\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.MovementData}\n     */\n    decodeMovement: function (movementXML, armatureData, dataInfo) {\n        var movementData = new ccs.MovementData();\n        movementData.name = movementXML.getAttribute(ccs.CONST_A_NAME);\n\n        var duration, durationTo, durationTween, loop, tweenEasing = 0;\n\n        duration = movementXML.getAttribute(ccs.CONST_A_DURATION);\n        movementData.duration = duration == null ? 0 : parseFloat(duration);\n\n        durationTo = movementXML.getAttribute(ccs.CONST_A_DURATION_TO);\n        movementData.durationTo = durationTo == null ? 0 : parseFloat(durationTo);\n\n        durationTween = movementXML.getAttribute(ccs.CONST_A_DURATION_TWEEN);\n        movementData.durationTween = durationTween == null ? 0 : parseFloat(durationTween);\n\n        loop = movementXML.getAttribute(ccs.CONST_A_LOOP);\n        movementData.loop = loop ? Boolean(parseFloat(loop)) : true;\n\n        var easing = movementXML.getAttribute(ccs.CONST_A_TWEEN_EASING);\n        if (easing) {\n            if (easing != ccs.CONST_FL_NAN) {\n                tweenEasing = easing == null ? 0 : parseFloat(easing);\n                movementData.tweenEasing = tweenEasing === 2 ? ccs.TweenType.SINE_EASEINOUT : tweenEasing;\n            } else\n                movementData.tweenEasing = ccs.TweenType.LINEAR;\n        }\n\n        var movBonesXml = movementXML.querySelectorAll(ccs.CONST_MOVEMENT + \" > \" + ccs.CONST_BONE);\n        var movBoneXml = null;\n        for (var i = 0; i < movBonesXml.length; i++) {\n            movBoneXml = movBonesXml[i];\n            var boneName = movBoneXml.getAttribute(ccs.CONST_A_NAME);\n\n            if (movementData.getMovementBoneData(boneName))\n                continue;\n\n            var boneData = armatureData.getBoneData(boneName);\n            var parentName = boneData.parentName;\n\n            var parentXML = null;\n            if (parentName !== \"\") {\n                for (var j = 0; j < movBonesXml.length; j++) {\n                    parentXML = movBonesXml[j];\n                    if (parentName === parentXML.getAttribute(ccs.CONST_A_NAME))\n                        break;\n                }\n            }\n            var moveBoneData = this.decodeMovementBone(movBoneXml, parentXML, boneData, dataInfo);\n            movementData.addMovementBoneData(moveBoneData);\n        }\n        return movementData;\n    },\n\n    /**\n     * Decodes json movement data.\n     * @param {Object} json\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.MovementData}\n     */\n    decodeMovementFromJson: function (json, dataInfo) {\n        var movementData = new ccs.MovementData();\n\n        movementData.loop = json[ccs.CONST_A_LOOP] == null ? false : json[ccs.CONST_A_LOOP];\n        movementData.durationTween = json[ccs.CONST_A_DURATION_TWEEN] || 0;\n        movementData.durationTo = json[ccs.CONST_A_DURATION_TO] || 0;\n        movementData.duration = json[ccs.CONST_A_DURATION] || 0;\n\n        if(json[ccs.CONST_A_DURATION] == null){\n            movementData.scale = 1;\n        }else{\n            movementData.scale = json[ccs.CONST_A_MOVEMENT_SCALE] == null ? 1 : json[ccs.CONST_A_MOVEMENT_SCALE];\n        }\n\n        movementData.tweenEasing = json[ccs.CONST_A_TWEEN_EASING] == null ? ccs.TweenType.LINEAR : json[ccs.CONST_A_TWEEN_EASING];\n        var name = json[ccs.CONST_A_NAME];\n        if(name)\n            movementData.name = name;\n\n        var movementBoneList = json[ccs.CONST_MOVEMENT_BONE_DATA] || [];\n        for (var i = 0; i < movementBoneList.length; i++) {\n            var locMovementBoneData = this.decodeMovementBoneFromJson(movementBoneList[i], dataInfo);\n            movementData.addMovementBoneData(locMovementBoneData);\n        }\n        return movementData;\n    },\n\n    /**\n     * Decodes xml data of bone's movement.\n     * @param {XMLDocument} movBoneXml\n     * @param {XMLDocument} parentXml\n     * @param {ccs.BoneData} boneData\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.MovementBoneData}\n     */\n    decodeMovementBone: function (movBoneXml, parentXml, boneData, dataInfo) {\n        var movBoneData = new ccs.MovementBoneData();\n        movBoneData.init();\n\n        var scale, delay;\n        if (movBoneXml) {\n            scale = parseFloat(movBoneXml.getAttribute(ccs.CONST_A_MOVEMENT_SCALE)) || 0;\n            movBoneData.scale = scale;\n\n            delay = parseFloat(movBoneXml.getAttribute(ccs.CONST_A_MOVEMENT_DELAY)) || 0;\n            if (delay > 0)\n                delay -= 1;\n            movBoneData.delay = delay;\n        }\n\n        var length = 0, parentTotalDuration = 0,currentDuration = 0;\n        var parentFrameXML = null,parentXMLList = [];\n\n        /*\n         *  get the parent frame xml list, we need get the origin data\n         */\n        if (parentXml != null) {\n            var parentFramesXML = parentXml.querySelectorAll(ccs.CONST_BONE + \" > \" + ccs.CONST_FRAME);\n            for (var i = 0; i < parentFramesXML.length; i++)\n                parentXMLList.push(parentFramesXML[i]);\n            length = parentXMLList.length;\n        }\n\n        movBoneData.name = movBoneXml.getAttribute(ccs.CONST_A_NAME);\n\n        var framesXML = movBoneXml.querySelectorAll(ccs.CONST_BONE + \" > \" + ccs.CONST_FRAME);\n\n        var j = 0, totalDuration = 0;\n        for (var ii = 0; ii < framesXML.length; ii++) {\n            var frameXML = framesXML[ii];\n            if (parentXml) {\n                /*\n                 *  in this loop we get the corresponding parent frame xml\n                 */\n                while (j < length && (parentFrameXML ? (totalDuration < parentTotalDuration || totalDuration >= parentTotalDuration + currentDuration) : true)) {\n                    parentFrameXML = parentXMLList[j];\n                    parentTotalDuration += currentDuration;\n                    currentDuration = parseFloat(parentFrameXML.getAttribute(ccs.CONST_A_DURATION));\n                    j++;\n                }\n            }\n            var boneFrameData = this.decodeFrame(frameXML, parentFrameXML, boneData, dataInfo);\n            movBoneData.addFrameData(boneFrameData);\n            boneFrameData.frameID = totalDuration;\n            totalDuration += boneFrameData.duration;\n            movBoneData.duration = totalDuration;\n        }\n\n        //Change rotation range from (-180 -- 180) to (-infinity -- infinity)\n        var frames = movBoneData.frameList, pi = Math.PI;\n        for (var i = frames.length - 1; i >= 0; i--) {\n            if (i > 0) {\n                var difSkewX = frames[i].skewX - frames[i - 1].skewX;\n                var difSkewY = frames[i].skewY - frames[i - 1].skewY;\n\n                if (difSkewX < -pi || difSkewX > pi) {\n                    frames[i - 1].skewX = difSkewX < 0 ? frames[i - 1].skewX - 2 * pi : frames[i - 1].skewX + 2 * pi;\n                }\n\n                if (difSkewY < -pi || difSkewY > pi) {\n                    frames[i - 1].skewY = difSkewY < 0 ? frames[i - 1].skewY - 2 * pi : frames[i - 1].skewY + 2 * pi;\n                }\n            }\n        }\n\n        var frameData = new ccs.FrameData();\n        frameData.copy(movBoneData.frameList[movBoneData.frameList.length - 1]);\n        frameData.frameID = movBoneData.duration;\n        movBoneData.addFrameData(frameData);\n        return movBoneData;\n    },\n\n    /**\n     * Decodes json data of bone's movement.\n     * @param {Object} json\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.MovementBoneData}\n     */\n    decodeMovementBoneFromJson: function (json, dataInfo) {\n        var movementBoneData = new ccs.MovementBoneData();\n        movementBoneData.init();\n        movementBoneData.delay = json[ccs.CONST_A_MOVEMENT_DELAY] || 0;\n\n        var name = json[ccs.CONST_A_NAME];\n        if(name)\n            movementBoneData.name = name;\n\n        var framesData = json[ccs.CONST_FRAME_DATA] || [];\n        var length = framesData.length;\n        for (var i = 0; i < length; i++) {\n            var dic = json[ccs.CONST_FRAME_DATA][i];\n            var frameData = this.decodeFrameFromJson(dic, dataInfo);\n            movementBoneData.addFrameData(frameData);\n\n            if (dataInfo.cocoStudioVersion < ccs.CONST_VERSION_COMBINED){\n                frameData.frameID = movementBoneData.duration;\n                movementBoneData.duration += frameData.duration;\n            }\n        }\n\n        if (dataInfo.cocoStudioVersion < ccs.VERSION_CHANGE_ROTATION_RANGE) {\n            //! Change rotation range from (-180 -- 180) to (-infinity -- infinity)\n            var frames = movementBoneData.frameList;\n            var pi = Math.PI;\n            for (var i = frames.length - 1; i >= 0; i--) {\n                if (i > 0) {\n                    var difSkewX = frames[i].skewX - frames[i - 1].skewX;\n                    var difSkewY = frames[i].skewY - frames[i - 1].skewY;\n\n                    if (difSkewX < -pi || difSkewX > pi) {\n                        frames[i - 1].skewX = difSkewX < 0 ? frames[i - 1].skewX - 2 * pi : frames[i - 1].skewX + 2 * pi;\n                    }\n\n                    if (difSkewY < -pi || difSkewY > pi) {\n                        frames[i - 1].skewY = difSkewY < 0 ? frames[i - 1].skewY - 2 * pi : frames[i - 1].skewY + 2 * pi;\n                    }\n                }\n            }\n        }\n\n        if (dataInfo.cocoStudioVersion < ccs.CONST_VERSION_COMBINED) {\n            if (movementBoneData.frameList.length > 0) {\n                var frameData = new ccs.FrameData();\n                frameData.copy(movementBoneData.frameList[movementBoneData.frameList.length - 1]);\n                movementBoneData.addFrameData(frameData);\n                frameData.frameID = movementBoneData.duration;\n            }\n        }\n        return movementBoneData;\n    },\n\n    /**\n     * Decodes xml data of frame.\n     * @param {XMLDocument} frameXML\n     * @param {XMLDocument} parentFrameXml\n     * @param {ccs.BoneData} boneData\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.FrameData}\n     */\n    decodeFrame: function (frameXML, parentFrameXml, boneData, dataInfo) {\n        var x = 0, y = 0, scale_x = 0, scale_y = 0, skew_x = 0, skew_y = 0, tweenRotate = 0;\n        var duration = 0, displayIndex = 0, zOrder = 0, tweenEasing = 0, blendType = 0;\n\n        var frameData = new ccs.FrameData();\n        frameData.strMovement = frameXML.getAttribute(ccs.CONST_A_MOVEMENT) || \"\";\n        frameData.movement = frameData.strMovement;\n        frameData.strEvent = frameXML.getAttribute(ccs.CONST_A_EVENT) || \"\";\n        frameData.event = frameData.strEvent;\n        frameData.strSound = frameXML.getAttribute(ccs.CONST_A_SOUND) || \"\";\n        frameData.sound = frameData.strSound;\n        frameData.strSoundEffect = frameXML.getAttribute(ccs.CONST_A_SOUND_EFFECT) || \"\";\n        frameData.soundEffect = frameData.strSoundEffect;\n\n        var isTween = frameXML.getAttribute(ccs.CONST_A_TWEEN_FRAME);\n        frameData.isTween = !(isTween !== undefined && (isTween === \"false\" || isTween === \"0\"));\n\n        if (dataInfo.flashToolVersion >= ccs.CONST_VERSION_2_0) {\n            x = frameXML.getAttribute(ccs.CONST_A_COCOS2DX_X);\n            if(x){\n                frameData.x = parseFloat(x);\n                frameData.x *= this._positionReadScale;\n            }\n            y = frameXML.getAttribute(ccs.CONST_A_COCOS2DX_Y);\n            if(y){\n                frameData.y = -parseFloat(y);\n                frameData.y *= this._positionReadScale;\n            }\n        } else {\n            x = frameXML.getAttribute(ccs.CONST_A_X);\n            if(x) {\n                frameData.x = parseFloat(x);\n                frameData.x *= this._positionReadScale;\n            }\n            y = frameXML.getAttribute(ccs.CONST_A_Y);\n            if(y) {\n                frameData.y = -parseFloat(y);\n                frameData.y *= this._positionReadScale;\n            }\n        }\n\n        scale_x = frameXML.getAttribute(ccs.CONST_A_SCALE_X);\n        if( scale_x != null )\n            frameData.scaleX = parseFloat(scale_x);\n        scale_y = frameXML.getAttribute(ccs.CONST_A_SCALE_Y);\n        if( scale_y != null )\n            frameData.scaleY = parseFloat(scale_y);\n        skew_x = frameXML.getAttribute(ccs.CONST_A_SKEW_X);\n        if( skew_x != null )\n            frameData.skewX = cc.degreesToRadians(parseFloat(skew_x));\n        skew_y = frameXML.getAttribute(ccs.CONST_A_SKEW_Y);\n        if( skew_y != null )\n            frameData.skewY = cc.degreesToRadians(-parseFloat(skew_y));\n\n        duration = frameXML.getAttribute(ccs.CONST_A_DURATION);\n        if( duration != null )\n            frameData.duration = parseFloat(duration);\n        displayIndex = frameXML.getAttribute(ccs.CONST_A_DISPLAY_INDEX);\n        if( displayIndex != null )\n            frameData.displayIndex = parseFloat(displayIndex);\n        zOrder = frameXML.getAttribute(ccs.CONST_A_Z);\n        if( zOrder != null )\n            frameData.zOrder = parseInt(zOrder);\n        tweenRotate = frameXML.getAttribute(ccs.CONST_A_TWEEN_ROTATE);\n        if( tweenRotate != null )\n            frameData.tweenRotate = parseFloat(tweenRotate);\n\n        blendType = frameXML.getAttribute(ccs.CONST_A_BLEND_TYPE);\n        if ( blendType != null ) {\n            var blendFunc = frameData.blendFunc;\n            switch (blendType) {\n                case ccs.BLEND_TYPE_NORMAL:\n                    blendFunc.src = cc.BLEND_SRC;\n                    blendFunc.dst = cc.BLEND_DST;\n                    break;\n                case ccs.BLEND_TYPE_ADD:\n                    blendFunc.src = cc.SRC_ALPHA;\n                    blendFunc.dst = cc.ONE;\n                    break;\n                case ccs.BLEND_TYPE_MULTIPLY:\n                    blendFunc.src = cc.DST_COLOR;\n                    blendFunc.dst = cc.ONE_MINUS_SRC_ALPHA;\n                    break;\n                case ccs.BLEND_TYPE_SCREEN:\n                    blendFunc.src = cc.ONE;\n                    blendFunc.dst = cc.ONE_MINUS_DST_COLOR;\n                    break;\n                default:\n                    frameData.blendFunc.src = cc.BLEND_SRC;\n                    frameData.blendFunc.dst = cc.BLEND_DST;\n                    break;\n            }\n        }\n\n        var colorTransformXML = frameXML.querySelectorAll(ccs.CONST_FRAME + \" > \" + ccs.CONST_A_COLOR_TRANSFORM);\n        if (colorTransformXML && colorTransformXML.length > 0) {\n            colorTransformXML = colorTransformXML[0];\n            var alpha, red, green, blue;\n            var alphaOffset, redOffset, greenOffset, blueOffset;\n\n            alpha = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_ALPHA)) || 0;\n            red = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_RED)) || 0;\n            green = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_GREEN)) || 0;\n            blue = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_BLUE)) || 0;\n\n            alphaOffset = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_ALPHA_OFFSET)) || 0;\n            redOffset = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_RED_OFFSET)) || 0;\n            greenOffset = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_GREEN_OFFSET)) || 0;\n            blueOffset = parseFloat(colorTransformXML.getAttribute(ccs.CONST_A_BLUE_OFFSET)) || 0;\n\n            frameData.a = 2.55 * alphaOffset + alpha;\n            frameData.r = 2.55 * redOffset + red;\n            frameData.g = 2.55 * greenOffset + green;\n            frameData.b = 2.55 * blueOffset + blue;\n\n            frameData.isUseColorInfo = true;\n        }\n\n        var _easing = frameXML.getAttribute(ccs.CONST_A_TWEEN_EASING);\n        if(_easing != null) {\n            if(_easing != ccs.CONST_FL_NAN){\n                tweenEasing = frameXML.getAttribute(ccs.CONST_A_TWEEN_EASING);\n                if( tweenEasing )\n                    frameData.tweenEasing = (tweenEasing === 2) ? ccs.TweenType.SINE_EASEINOUT : tweenEasing;\n            } else\n                frameData.tweenEasing = ccs.TweenType.LINEAR;\n        }\n\n        if (parentFrameXml) {\n            //*  recalculate frame data from parent frame data, use for translate matrix\n            var helpNode = new ccs.BaseData();\n            if (dataInfo.flashToolVersion >= ccs.CONST_VERSION_2_0) {\n                helpNode.x = parseFloat(parentFrameXml.getAttribute(ccs.CONST_A_COCOS2DX_X));\n                helpNode.y = parseFloat(parentFrameXml.getAttribute(ccs.CONST_A_COCOS2DX_Y));\n            } else {\n                helpNode.x = parseFloat(parentFrameXml.getAttribute(ccs.CONST_A_X));\n                helpNode.y = parseFloat(parentFrameXml.getAttribute(ccs.CONST_A_Y));\n            }\n            helpNode.skewX = parseFloat(parentFrameXml.getAttribute(ccs.CONST_A_SKEW_X));\n            helpNode.skewY = parseFloat(parentFrameXml.getAttribute(ccs.CONST_A_SKEW_Y));\n\n            helpNode.y = -helpNode.y;\n            helpNode.skewX = cc.degreesToRadians(helpNode.skewX);\n            helpNode.skewY = cc.degreesToRadians(-helpNode.skewY);\n            ccs.TransformHelp.transformFromParent(frameData, helpNode);\n        }\n        return frameData;\n    },\n\n    /**\n     * Decodes json data of frame.\n     * @param {Object} json\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.FrameData}\n     */\n    decodeFrameFromJson: function (json, dataInfo) {\n        var frameData = new ccs.FrameData();\n\n        this.decodeNodeFromJson(frameData, json, dataInfo);\n\n        frameData.tweenEasing = json[ccs.CONST_A_TWEEN_EASING] || ccs.TweenType.LINEAR;\n        frameData.displayIndex = json[ccs.CONST_A_DISPLAY_INDEX];\n        var bd_src = json[ccs.CONST_A_BLEND_SRC] == null ? cc.BLEND_SRC : json[ccs.CONST_A_BLEND_SRC];\n        var bd_dst = json[ccs.CONST_A_BLEND_DST] == null ? cc.BLEND_DST : json[ccs.CONST_A_BLEND_DST];\n        frameData.blendFunc.src = bd_src;\n        frameData.blendFunc.dst = bd_dst;\n        frameData.isTween = json[ccs.CONST_A_TWEEN_FRAME] == null ? true : json[ccs.CONST_A_TWEEN_FRAME];\n\n        var event = json[ccs.CONST_A_EVENT];\n        if(event != null){\n            frameData.strEvent = event;\n            frameData.event = event;\n        }\n\n        if (dataInfo.cocoStudioVersion < ccs.CONST_VERSION_COMBINED)\n            frameData.duration = json[ccs.CONST_A_DURATION] == null ? 1 : json[ccs.CONST_A_DURATION];\n        else\n            frameData.frameID = json[ccs.CONST_A_FRAME_INDEX];\n\n        var twEPs = json[ccs.CONST_A_EASING_PARAM] || [];\n        for (var i = 0; i < twEPs.length; i++) {\n            frameData.easingParams[i] = twEPs[i];\n        }\n\n        return frameData;\n    },\n\n    /**\n     * Decodes xml data of texture\n     * @param {XMLDocument} textureXML\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.TextureData}\n     */\n    decodeTexture: function (textureXML, dataInfo) {\n        var textureData = new ccs.TextureData();\n        textureData.init();\n\n        if (textureXML.getAttribute(ccs.CONST_A_NAME)) {\n            textureData.name = textureXML.getAttribute(ccs.CONST_A_NAME);\n        }\n\n        var px, py;\n\n        if (dataInfo.flashToolVersion >= ccs.CONST_VERSION_2_0) {\n            px = parseFloat(textureXML.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_X)) || 0;\n            py = parseFloat(textureXML.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_Y)) || 0;\n        } else {\n            px = parseFloat(textureXML.getAttribute(ccs.CONST_A_PIVOT_X)) || 0;\n            py = parseFloat(textureXML.getAttribute(ccs.CONST_A_PIVOT_Y)) || 0;\n        }\n\n        var width = parseFloat(textureXML.getAttribute(ccs.CONST_A_WIDTH)) || 0;\n        var height = parseFloat(textureXML.getAttribute(ccs.CONST_A_HEIGHT)) || 0;\n\n        var anchorPointX = px / width;\n        var anchorPointY = (height - py) / height;\n\n        textureData.pivotX = anchorPointX;\n        textureData.pivotY = anchorPointY;\n\n        var contoursXML = textureXML.querySelectorAll(ccs.CONST_SUB_TEXTURE + \" > \" + ccs.CONST_CONTOUR);\n        for (var i = 0; i < contoursXML.length; i++) {\n            textureData.addContourData(this.decodeContour(contoursXML[i], dataInfo));\n        }\n        return textureData;\n    },\n\n    /**\n     * Decodes json data of Texture.\n     * @param json\n     * @returns {ccs.TextureData}\n     */\n    decodeTextureFromJson: function (json) {\n        var textureData = new ccs.TextureData();\n        textureData.init();\n\n        var name = json[ccs.CONST_A_NAME];\n        if(name != null)\n            textureData.name = name;\n\n        textureData.width = json[ccs.CONST_A_WIDTH] || 0;\n        textureData.height = json[ccs.CONST_A_HEIGHT] || 0;\n        textureData.pivotX = json[ccs.CONST_A_PIVOT_X] || 0;\n        textureData.pivotY = json[ccs.CONST_A_PIVOT_Y] || 0;\n\n        var contourDataList = json[ccs.CONST_CONTOUR_DATA] || [];\n        for (var i = 0; i < contourDataList.length; i++) {\n            textureData.contourDataList.push(this.decodeContourFromJson(contourDataList[i]));\n        }\n        return textureData;\n    },\n\n    /**\n     * Decodes xml data of contour.\n     * @param {XMLDocument} contourXML\n     * @param {ccs.DataInfo} dataInfo\n     * @returns {ccs.ContourData}\n     */\n    decodeContour: function (contourXML, dataInfo) {\n        var contourData = new ccs.ContourData();\n        contourData.init();\n\n        var vertexDatasXML = contourXML.querySelectorAll(ccs.CONST_CONTOUR + \" > \" + ccs.CONST_CONTOUR_VERTEX);\n        var vertexDataXML;\n        for (var i = 0; i < vertexDatasXML.length; i++) {\n            vertexDataXML = vertexDatasXML[i];\n            var vertex = cc.p(0, 0);\n            vertex.x = parseFloat(vertexDataXML.getAttribute(ccs.CONST_A_X)) || 0;\n            vertex.y = parseFloat(vertexDataXML.getAttribute(ccs.CONST_A_Y)) || 0;\n\n            vertex.y = - vertex.y;\n            contourData.vertexList.push(vertex);\n        }\n        return contourData;\n    },\n\n    /**\n     * Decodes json data of contour.\n     * @param {Object} json\n     * @returns {ccs.ContourData}\n     */\n    decodeContourFromJson: function (json) {\n        var contourData = new ccs.ContourData();\n        contourData.init();\n\n        var vertexPointList = json[ccs.CONST_VERTEX_POINT] || [];\n        var len = vertexPointList.length;\n        for (var i = 0; i < len; i++) {\n            var dic = vertexPointList[i];\n            var vertex = cc.p(0, 0);\n            vertex.x = dic[ccs.CONST_A_X] || 0;\n            vertex.y = dic[ccs.CONST_A_Y] || 0;\n            contourData.vertexList.push(vertex);\n        }\n        return contourData;\n    },\n\n    /**\n     * Adds json armature data to armature data manager.\n     * @param {Object} dic json armature data\n     * @param {ccs.DataInfo} dataInfo\n     */\n    addDataFromJsonCache: function (dic, dataInfo) {\n        dataInfo.contentScale = dic[ccs.CONST_CONTENT_SCALE] == null ? 1 : dic[ccs.CONST_CONTENT_SCALE];\n\n        // Decode armatures\n        var armatureDataArr = dic[ccs.CONST_ARMATURE_DATA] || [], i;\n        var armatureData;\n        for (i = 0; i < armatureDataArr.length; i++) {\n            armatureData = this.decodeArmatureFromJSON(armatureDataArr[i], dataInfo);\n            ccs.armatureDataManager.addArmatureData(armatureData.name, armatureData, dataInfo.filename);\n        }\n\n        // Decode animations\n        var animationDataArr = dic[ccs.CONST_ANIMATION_DATA] || [];\n        var animationData;\n        for (i = 0; i < animationDataArr.length; i++) {\n            animationData = this.decodeAnimationFromJson(animationDataArr[i], dataInfo);\n            ccs.armatureDataManager.addAnimationData(animationData.name, animationData, dataInfo.filename);\n        }\n\n        // Decode textures\n        var textureDataArr = dic[ccs.CONST_TEXTURE_DATA] || [];\n        var textureData;\n        for (i = 0; i < textureDataArr.length; i++) {\n            textureData = this.decodeTextureFromJson(textureDataArr[i], dataInfo);\n            ccs.armatureDataManager.addTextureData(textureData.name, textureData, dataInfo.filename);\n        }\n\n        // Auto load sprite file\n        var autoLoad = dataInfo.asyncStruct == null ? ccs.armatureDataManager.isAutoLoadSpriteFile() : dataInfo.asyncStruct.autoLoadSpriteFile;\n//        if (isLoadSpriteFrame) {\n        if (autoLoad) {\n            var configFiles = dic[ccs.CONST_CONFIG_FILE_PATH] || [];\n            var locFilePath, locPos, locPlistPath, locImagePath;\n            for (i = 0; i < configFiles.length; i++) {\n                locFilePath = configFiles[i];\n                locPos = locFilePath.lastIndexOf(\".\");\n                locFilePath = locFilePath.substring(0, locPos);\n                locPlistPath = dataInfo.basefilePath + locFilePath + \".plist\";\n                locImagePath = dataInfo.basefilePath + locFilePath + \".png\";\n                ccs.armatureDataManager.addSpriteFrameFromFile(locPlistPath, locImagePath, dataInfo.filename);\n            }\n        }\n\n        armatureData = null;\n        animationData = null;\n    },\n\n    /**\n     * Decodes json data of node.\n     * @param node\n     * @param json\n     * @param dataInfo\n     */\n    decodeNodeFromJson: function (node, json, dataInfo) {\n        node.x = json[ccs.CONST_A_X] * this._positionReadScale;\n        node.y = json[ccs.CONST_A_Y] * this._positionReadScale;\n\n        node.x *= dataInfo.contentScale;\n        node.y *= dataInfo.contentScale;\n\n        node.zOrder = json[ccs.CONST_A_Z];\n\n        node.skewX = json[ccs.CONST_A_SKEW_X] || 0;\n        node.skewY = json[ccs.CONST_A_SKEW_Y] || 0;\n        node.scaleX = json[ccs.CONST_A_SCALE_X] == null ? 1 : json[ccs.CONST_A_SCALE_X];\n        node.scaleY = json[ccs.CONST_A_SCALE_Y] == null ? 1 : json[ccs.CONST_A_SCALE_Y];\n\n        var colorDic;\n        if (dataInfo.cocoStudioVersion < ccs.VERSION_COLOR_READING) {\n            colorDic = json[0];\n            if (colorDic){\n                node.a = colorDic[ccs.CONST_A_ALPHA] == null ? 255 : colorDic[ccs.CONST_A_ALPHA];\n                node.r = colorDic[ccs.CONST_A_RED] == null ? 255 : colorDic[ccs.CONST_A_RED];\n                node.g = colorDic[ccs.CONST_A_GREEN] == null ? 255 : colorDic[ccs.CONST_A_GREEN];\n                node.b = colorDic[ccs.CONST_A_BLUE] == null ? 255 : colorDic[ccs.CONST_A_BLUE];\n                node.isUseColorInfo = true;\n            }\n        } else {\n            colorDic = json[ccs.CONST_COLOR_INFO] || null;\n            if (colorDic){\n                node.a = colorDic[ccs.CONST_A_ALPHA] == null ? 255 : colorDic[ccs.CONST_A_ALPHA];\n                node.r = colorDic[ccs.CONST_A_RED] == null ? 255 : colorDic[ccs.CONST_A_RED];\n                node.g = colorDic[ccs.CONST_A_GREEN] == null ? 255 : colorDic[ccs.CONST_A_GREEN];\n                node.b = colorDic[ccs.CONST_A_BLUE] == null ? 255 : colorDic[ccs.CONST_A_BLUE];\n                node.isUseColorInfo = true;\n            }\n        }\n    },\n\n    clear: function () {\n        this._configFileList = [];\n        this._asyncRefCount = 0;\n        this._asyncRefTotalCount = 0;\n    },\n\n    _asyncCallBack: function (selector, target, percent) {\n        if(selector && cc.isFunction(selector))\n            selector.call(target, percent);\n        if(target && selector && typeof selector === 'string')\n            target[selector](percent);\n    },\n    /**\n     * find the base file path\n     * @param filePath\n     * @returns {String}\n     * @private\n     */\n    _initBaseFilePath: function (filePath) {\n        var path = filePath;\n        var pos = path.lastIndexOf(\"/\");\n        if (pos > -1)\n            path = path.substr(0, pos + 1);\n        else\n            path = \"\";\n        return path;\n    },\n\n    /**\n     * Adds xml armature data to armature data manager.\n     * @param {XMLDocument} xml\n     * @param {ccs.DataInfo} dataInfo\n     */\n    addDataFromXML: function (xml, dataInfo) {\n        /*\n         *  Need to get the full path of the xml file, or the Tiny XML can't find the xml at IOS\n         */\n        var xmlStr = cc.loader.getRes(xml);\n        if (!xmlStr) throw new Error(\"Please load the resource first : \" + xml);\n        var skeletonXML = cc.saxParser.parse(xmlStr);\n        var skeleton = skeletonXML.documentElement;\n        if (skeleton)\n            this.addDataFromCache(skeleton, dataInfo);\n    },\n\n    /**\n     * Adds json armature data to armature data manager.\n     * @param {String} filePath\n     * @param {ccs.DataInfo} dataInfo\n     */\n    addDataFromJson: function (filePath, dataInfo) {\n        var fileContent = cc.loader.getRes(filePath);\n        this.addDataFromJsonCache(fileContent, dataInfo);\n    }\n};"]}