{"version":3,"sources":["../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/core/assets/frameworks/cocos2d-html5/cocos2d/core/CCDrawingPrimitivesWebGL.js"],"names":["cc","DrawingPrimitiveWebGL","Class","extend","_renderContext","_initialized","_shader","_colorLocation","_colorArray","_pointSizeLocation","_pointSize","ctor","ctx","WebGLRenderingContext","Error","Float32Array","lazy_init","_t","shaderCache","programForKey","SHADER_POSITION_UCOLOR","_addUniformLocation","_glProgramState","GLProgramState","getOrCreateWithGLProgram","drawInit","drawPoint","point","glContext","apply","setUniformForModelViewAndProjectionMatrixWithMat4","enableVertexAttribArray","VERTEX_ATTRIB_POSITION","setUniformLocationWith4fv","setUniformLocationWith1f","pointBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","x","y","STATIC_DRAW","vertexAttribPointer","FLOAT","drawArrays","POINTS","deleteBuffer","incrementGLDraws","drawPoints","points","numberOfPoints","length","_pointsToTypeArray","typeArr","i","drawLine","origin","destination","LINES","drawRect","p","drawSolidRect","color","vertices","drawSolidPoly","drawPoly","numOfVertices","closePolygon","LINE_LOOP","LINE_STRIP","poli","setDrawColor","r","g","b","a","TRIANGLE_FAN","drawCircle","center","radius","angle","segments","drawLineToCenter","additionalSegment","coef","Math","PI","rads","j","cos","k","sin","drawQuadBezier","control","t","pow","drawCubicBezier","control1","control2","drawCatmullRom","drawCardinalSpline","config","tension","lt","deltaT","dt","newPos","cardinalSplineAt","getControlPointAt","setPointSize","pointSize","contentScaleFactor","setLineWidth","width","lineWidth"],"mappings":"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","file":"CCDrawingPrimitivesWebGL.js","sourceRoot":"../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/core","sourcesContent":["/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * Canvas of DrawingPrimitive implement version use for WebGlMode\n * @class\n * @extends cc.Class\n */\ncc.DrawingPrimitiveWebGL = cc.Class.extend(/** @lends cc.DrawingPrimitiveWebGL# */{\n    _renderContext:null,\n    _initialized:false,\n    _shader: null,\n    _colorLocation: \"u_color\",\n    _colorArray: null,\n    _pointSizeLocation: \"u_pointSize\",\n    _pointSize:-1,\n    /**\n     * contructor of cc.DrawingPrimitiveWebGL\n     * @param ctx rendercontext\n     */\n    ctor:function (ctx) {\n        if (ctx == null)\n            ctx = cc._renderContext;\n\n        if (!ctx instanceof  WebGLRenderingContext)\n            throw new Error(\"Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext\");\n\n        this._renderContext = ctx;\n        this._colorArray = new Float32Array([1.0, 1.0, 1.0, 1.0]);\n    },\n\n    lazy_init:function () {\n        var _t = this;\n        if (!_t._initialized) {\n            //\n            // Position and 1 color passed as a uniform (to similate glColor4ub )\n            //\n            _t._shader = cc.shaderCache.programForKey(cc.SHADER_POSITION_UCOLOR);\n            _t._shader._addUniformLocation(this._colorLocation);\n            _t._shader._addUniformLocation(this._pointSizeLocation);\n            _t._glProgramState = cc.GLProgramState.getOrCreateWithGLProgram(_t._shader);\n\n            _t._initialized = true;\n        }\n    },\n\n    /**\n     * initlialize context\n     */\n    drawInit:function () {\n        this._initialized = false;\n    },\n\n    /**\n     * draws a point given x and y coordinate measured in points\n     * @param {cc.Point} point\n     */\n    drawPoint:function (point) {\n        this.lazy_init();\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n        this._shader.setUniformLocationWith1f(this._pointSizeLocation, this._pointSize);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array([point.x, point.y]), glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n\n        glContext.drawArrays(glContext.POINTS, 0, 1);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * draws an array of points.\n     * @param {Array} points point of array\n     * @param {Number} numberOfPoints\n     */\n    drawPoints:function (points, numberOfPoints) {\n        if (!points || points.length === 0)\n            return;\n\n        this.lazy_init();\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n        this._shader.setUniformLocationWith1f(this._pointSizeLocation, this._pointSize);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, this._pointsToTypeArray(points), glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n\n        glContext.drawArrays(glContext.POINTS, 0, points.length);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    _pointsToTypeArray:function (points) {\n        var typeArr = new Float32Array(points.length * 2);\n        for (var i = 0; i < points.length; i++) {\n            typeArr[i * 2] = points[i].x;\n            typeArr[i * 2 + 1] = points[i].y;\n        }\n        return typeArr;\n    },\n\n    /**\n     * draws a line given the origin and destination point measured in points\n     * @param {cc.Point} origin\n     * @param {cc.Point} destination\n     */\n    drawLine:function (origin, destination) {\n        this.lazy_init();\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, this._pointsToTypeArray([origin, destination]), glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n\n        glContext.drawArrays(glContext.LINES, 0, 2);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * draws a rectangle given the origin and destination point measured in points.\n     * @param {cc.Point} origin\n     * @param {cc.Point} destination\n     */\n    drawRect:function (origin, destination) {\n        this.drawLine(cc.p(origin.x, origin.y), cc.p(destination.x, origin.y));\n        this.drawLine(cc.p(destination.x, origin.y), cc.p(destination.x, destination.y));\n        this.drawLine(cc.p(destination.x, destination.y), cc.p(origin.x, destination.y));\n        this.drawLine(cc.p(origin.x, destination.y), cc.p(origin.x, origin.y));\n    },\n\n    /**\n     * draws a solid rectangle given the origin and destination point measured in points.\n     * @param {cc.Point} origin\n     * @param {cc.Point} destination\n     * @param {cc.Color} color\n     */\n    drawSolidRect:function (origin, destination, color) {\n        var vertices = [\n            origin,\n            cc.p(destination.x, origin.y),\n            destination,\n            cc.p(origin.x, destination.y)\n        ];\n\n        this.drawSolidPoly(vertices, 4, color);\n    },\n\n    /**\n     * draws a polygon given a pointer to cc.Point coordiantes and the number of vertices measured in points.\n     * @param {Array} vertices a pointer to cc.Point coordiantes\n     * @param {Number} numOfVertices the number of vertices measured in points\n     * @param {Boolean} closePolygon The polygon can be closed or open\n     */\n    drawPoly:function (vertices, numOfVertices, closePolygon) {\n        this.lazy_init();\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, this._pointsToTypeArray(vertices), glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n\n        if (closePolygon)\n            glContext.drawArrays(glContext.LINE_LOOP, 0, vertices.length);\n        else\n            glContext.drawArrays(glContext.LINE_STRIP, 0, vertices.length);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * draws a solid polygon given a pointer to CGPoint coordiantes, the number of vertices measured in points, and a color.\n     * @param {Array} poli\n     * @param {Number} numberOfPoints\n     * @param {cc.Color} color\n     */\n    drawSolidPoly:function (poli, numberOfPoints, color) {\n        this.lazy_init();\n        if (color)\n            this.setDrawColor(color.r, color.g, color.b, color.a);\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, this._pointsToTypeArray(poli), glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n        glContext.drawArrays(glContext.TRIANGLE_FAN, 0, poli.length);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * draws a circle given the center, radius and number of segments.\n     * @param {cc.Point} center center of circle\n     * @param {Number} radius\n     * @param {Number} angle angle in radians\n     * @param {Number} segments\n     * @param {Boolean} drawLineToCenter\n     */\n    drawCircle:function (center, radius, angle, segments, drawLineToCenter) {\n        this.lazy_init();\n\n        var additionalSegment = 1;\n        if (drawLineToCenter)\n            additionalSegment++;\n\n        var coef = 2.0 * Math.PI / segments;\n\n        var vertices = new Float32Array((segments + 2) * 2);\n        if (!vertices)\n            return;\n\n        for (var i = 0; i <= segments; i++) {\n            var rads = i * coef;\n            var j = radius * Math.cos(rads + angle) + center.x;\n            var k = radius * Math.sin(rads + angle) + center.y;\n\n            vertices[i * 2] = j;\n            vertices[i * 2 + 1] = k;\n        }\n        vertices[(segments + 1) * 2] = center.x;\n        vertices[(segments + 1) * 2 + 1] = center.y;\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, vertices, glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n\n        glContext.drawArrays(glContext.LINE_STRIP, 0, segments + additionalSegment);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * draws a quad bezier path\n     * @param {cc.Point} origin\n     * @param {cc.Point} control\n     * @param {cc.Point} destination\n     * @param {Number} segments\n     */\n    drawQuadBezier:function (origin, control, destination, segments) {\n        this.lazy_init();\n\n        var vertices = new Float32Array((segments + 1) * 2);\n\n        var t = 0.0;\n        for (var i = 0; i < segments; i++) {\n            vertices[i * 2] = Math.pow(1 - t, 2) * origin.x + 2.0 * (1 - t) * t * control.x + t * t * destination.x;\n            vertices[i * 2 + 1] = Math.pow(1 - t, 2) * origin.y + 2.0 * (1 - t) * t * control.y + t * t * destination.y;\n            t += 1.0 / segments;\n        }\n        vertices[segments * 2] = destination.x;\n        vertices[segments * 2 + 1] = destination.y;\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, vertices, glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n\n        glContext.drawArrays(glContext.LINE_STRIP, 0, segments + 1);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * draws a cubic bezier path\n     * @param {cc.Point} origin\n     * @param {cc.Point} control1\n     * @param {cc.Point} control2\n     * @param {cc.Point} destination\n     * @param {Number} segments\n     */\n    drawCubicBezier:function (origin, control1, control2, destination, segments) {\n        this.lazy_init();\n\n        var vertices = new Float32Array((segments + 1) * 2);\n\n        var t = 0;\n        for (var i = 0; i < segments; i++) {\n            vertices[i * 2] = Math.pow(1 - t, 3) * origin.x + 3.0 * Math.pow(1 - t, 2) * t * control1.x + 3.0 * (1 - t) * t * t * control2.x + t * t * t * destination.x;\n            vertices[i * 2 + 1] = Math.pow(1 - t, 3) * origin.y + 3.0 * Math.pow(1 - t, 2) * t * control1.y + 3.0 * (1 - t) * t * t * control2.y + t * t * t * destination.y;\n            t += 1.0 / segments;\n        }\n        vertices[segments * 2] = destination.x;\n        vertices[segments * 2 + 1] = destination.y;\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, vertices, glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n        glContext.drawArrays(glContext.LINE_STRIP, 0, segments + 1);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * draw a catmull rom line\n     * @param {Array} points\n     * @param {Number} segments\n     */\n    drawCatmullRom:function (points, segments) {\n        this.drawCardinalSpline(points, 0.5, segments);\n    },\n\n    /**\n     * draw a cardinal spline path\n     * @param {Array} config\n     * @param {Number} tension\n     * @param {Number} segments\n     */\n    drawCardinalSpline:function (config, tension, segments) {\n        this.lazy_init();\n\n        var vertices = new Float32Array((segments + 1) * 2);\n        var p, lt, deltaT = 1.0 / config.length;\n        for (var i = 0; i < segments + 1; i++) {\n            var dt = i / segments;\n\n            // border\n            if (dt === 1) {\n                p = config.length - 1;\n                lt = 1;\n            } else {\n                p = 0 | (dt / deltaT);\n                lt = (dt - deltaT * p) / deltaT;\n            }\n\n            var newPos = cc.cardinalSplineAt(\n                cc.getControlPointAt(config, p - 1),\n                cc.getControlPointAt(config, p),\n                cc.getControlPointAt(config, p + 1),\n                cc.getControlPointAt(config, p + 2),\n                tension, lt);\n            // Interpolate\n\n            vertices[i * 2] = newPos.x;\n            vertices[i * 2 + 1] = newPos.y;\n        }\n\n        var glContext = this._renderContext;\n        this._glProgramState.apply();\n        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();\n        glContext.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);\n        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);\n\n        var pointBuffer = glContext.createBuffer();\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, pointBuffer);\n        glContext.bufferData(glContext.ARRAY_BUFFER, vertices, glContext.STATIC_DRAW);\n        glContext.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, glContext.FLOAT, false, 0, 0);\n        glContext.drawArrays(glContext.LINE_STRIP, 0, segments + 1);\n        glContext.deleteBuffer(pointBuffer);\n\n        cc.incrementGLDraws(1);\n    },\n\n    /**\n     * set the drawing color with 4 unsigned bytes\n     * @param {Number} r red value (0 to 255)\n     * @param {Number} g green value (0 to 255)\n     * @param {Number} b blue value (0 to 255)\n     * @param {Number} a Alpha value (0 to 255)\n     */\n    setDrawColor:function (r, g, b, a) {\n        this._colorArray[0] = r / 255.0;\n        this._colorArray[1] = g / 255.0;\n        this._colorArray[2] = b / 255.0;\n        this._colorArray[3] = a / 255.0;\n    },\n\n    /**\n     * set the point size in points. Default 1.\n     * @param {Number} pointSize\n     */\n    setPointSize:function (pointSize) {\n        this._pointSize = pointSize * cc.contentScaleFactor();\n    },\n\n    /**\n     * set the line width. Default 1.\n     * @param {Number} width\n     */\n    setLineWidth:function (width) {\n        if(this._renderContext.lineWidth)\n            this._renderContext.lineWidth(width);\n    }\n});"]}