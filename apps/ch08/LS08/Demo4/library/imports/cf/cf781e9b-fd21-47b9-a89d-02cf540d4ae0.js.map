{"version":3,"sources":["../../../../../../../assets/frameworks/cocos2d-html5/extensions/runtime/assets/frameworks/cocos2d-html5/extensions/runtime/CCLoaderLayer.js"],"names":["INT_MAX","Number","MAX_VALUE","GROUP_JSON_PATH","cc","LoaderLayer","Layer","extend","_backgroundSprite","_progressBackgroundSprite","_progressBarSprite","_logoSprite","_titleSprite","_groupname","_callback","_selector","_preloadCount","_isPreloadFromFailed","_progressOriginalWidth","_isLandScape","_scaleFactor","ctor","config","_super","setConfig","onEnter","initView","_finalConfig","onExit","logo","action","release","title","_contentLayer","winSize","width","height","_useDefaultSource","backgroundSprite","Sprite","background","res","addChild","x","y","anchorX","anchorY","scaleX","scaleY","show","titleSprite","defaultTitlePosition","pAdd","visibleRect","center","p","setPosition","position","runAction","logoSprite","defaultLogoPosition","top","progressBar","progressBarSprite","progressBackgroundSprite","barBackgroundRes","_isDefaultProgress","_barPoint","barPoint","setTextureRect","rect","offset","deltaProgressWithX","deltaProgressWithY","defaultProgressPosition","bottom","_setProgress","tips","tipsLabel","LabelTTF","fontSize","setColor","color","setScale","getPosition","percent","setTipsString","str","setString","getProgressBar","getTipsLabel","getLogoSprite","getTitleSprite","updateGroup","groupname","callback","target","_resetLoadingLabel","_preloadSource","log","sys","isNative","Loader","preload","_preload_native","_preload_html5","groupIndex","groups","isString","indexOf","isArray","i","length","group","files","preCount","push","concat","self","loader","load","result","count","loadedCount","checkGroupName","groupName","status","isCompleted","stage","isFailed","tipsProgress","removeFromParent","JSON","stringify","_config","runtime","design_resolution","policy","view","setDesignResolutionSize","ResolutionPolicy","call","_target","_addToScene","isLandscape","isLargeThanResource","orientation","director","getRunningScene","barShadow","loaderlayer","statusStr","network","preloadstatus","DOWNLOAD","UNZIP","toFixed","progressCallback","progress","layer","res_engine_loaded","loaderLayer","preloadCb","conirmfunc","cancelfunc","errorCode","callPreload","end","_NetworkErrorDialog","_show","runScene","Scene","Dialog","confirmBtn","normalRes","pressRes","cancelBtn","Math","min","getRes","warn","setUseDefaultSource","retain","_initData","uConfig","clone","uTitle","uLogo","uProgress","uTips","sequence","spawn","moveBy","easing","easeIn","scaleTo","delayTime","easeOut","repeatForever","_defaultConfig","_menuItemConfirm","_menuItemCancel","_messageLabel","_eventListener","removeAllChildren","useDefaultSource","getWinSize","Scale9Sprite","_setScale","menuItemConfirm","_createMenuItemSprite","_confirmCallback","menuItemCancel","_cancelCallback","menu","Menu","messageLabel","text","setDimensions","dimensions","size","EaseIn","create","scale","EaseOut","spriteNormal","spritePress","menuLabel","textColor","menuItem","MenuItemSprite","s9Sprite","setContentSize","EventListener","event","TOUCH_ONE_BY_ONE","swallowTouches","onTouchBegan","touch","eventManager","addListener","_dialog","removeListener","_clearDialog","confirmCb","cancelCb","conf","dialog","uConfirmBtn","uCancelBtn","uMessageLabel","networkError","spaceError","verifyError","type","networkDialog","getParent","_setConfig","key","setOption","promptype","NO_NETWORK","MOBILE","WIFI","LoaderScene","_preload","arr","cb","isGroups","splice"],"mappings":";;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;AAuBA,CAAC,YAAY;;AAEb,QAAIA,UAAUC,OAAOC,SAArB;AACA,QAAIC,kBAAkB,YAAtB;;AAEAC,OAAGC,WAAH,GAAiBD,GAAGE,KAAH,CAASC,MAAT,CAAgB;AAC7BC,2BAAmB,IADU;AAE7BC,mCAA2B,IAFE;AAG7BC,4BAAoB,IAHS;AAI7BC,qBAAa,IAJgB;AAK7BC,sBAAc,IALe;AAM7BC,oBAAY,IANiB;AAO7BC,mBAAW,IAPkB;AAQ7BC,mBAAW,IARkB;AAS7BC,uBAAe,CATc;AAU7BC,8BAAsB,KAVO;AAW7BC,gCAAwB,CAXK;AAY7BC,sBAAc,KAZe;AAa7BC,sBAAc,IAbe;;AAe7BC,cAAM,cAAUC,MAAV,EAAkB;AACpB,iBAAKC,MAAL;AACA,gBAAID,MAAJ,EAAY;AACRlB,mBAAGC,WAAH,CAAemB,SAAf,CAAyBF,MAAzB;AACH;AACJ,SApB4B;AAqB7BG,iBAAS,mBAAY;AACjB,iBAAKF,MAAL;AACA,iBAAKG,QAAL;AACA,gBAAIJ,SAASlB,GAAGC,WAAH,CAAesB,YAA5B;AACA,gBAAIL,OAAOG,OAAX,EAAoB;AAChBH,uBAAOG,OAAP,CAAe,IAAf;AACH;AACJ,SA5B4B;AA6B7BG,gBAAQ,kBAAY;AAChB,iBAAKL,MAAL;AACA,gBAAID,SAASlB,GAAGC,WAAH,CAAesB,YAA5B;AACA,gBAAIL,OAAOO,IAAP,CAAYC,MAAhB,EAAwB;AACpBR,uBAAOO,IAAP,CAAYC,MAAZ,CAAmBC,OAAnB;AACH;AACD,gBAAGT,OAAOU,KAAP,CAAaF,MAAhB,EAAuB;AACnBR,uBAAOU,KAAP,CAAaF,MAAb,CAAoBC,OAApB;AACH;AACD,gBAAIT,OAAOM,MAAX,EAAmB;AACfN,uBAAOM,MAAP,CAAc,IAAd;AACH;AACJ,SAzC4B;AA0C7BF,kBAAU,oBAAY;AAClB,gBAAIJ,SAASlB,GAAGC,WAAH,CAAesB,YAA5B;AACA,iBAAKM,aAAL,GAAqB,IAAI7B,GAAGE,KAAP,EAArB;AACA,iBAAKa,YAAL,GAAoBf,GAAG8B,OAAH,CAAWC,KAAX,GAAmB/B,GAAG8B,OAAH,CAAWE,MAAlD;AACA,iBAAKhB,YAAL,GAAoB,CAAChB,GAAGC,WAAH,CAAegC,iBAAhB,GAAoC,CAApC,GAAwCjC,GAAG8B,OAAH,CAAWC,KAAX,GAAmB/B,GAAG8B,OAAH,CAAWE,MAA9B,GAAuChC,GAAG8B,OAAH,CAAWC,KAAX,GAAmB,GAA1D,GAAgE/B,GAAG8B,OAAH,CAAWC,KAAX,GAAmB,GAA/I;;AAEA;AACA,iBAAKG,gBAAL,GAAwB,IAAIlC,GAAGmC,MAAP,CAAcjB,OAAOkB,UAAP,CAAkBC,GAAhC,CAAxB;AACA,iBAAKC,QAAL,CAAc,KAAKJ,gBAAnB;AACA,iBAAKA,gBAAL,CAAsBK,CAAtB,GAA0B,CAA1B,EAA6B,KAAKL,gBAAL,CAAsBM,CAAtB,GAA0B,CAAvD,EAA0D,KAAKN,gBAAL,CAAsBO,OAAtB,GAAgC,CAA1F,EAA6F,KAAKP,gBAAL,CAAsBQ,OAAtB,GAAgC,CAA7H;AACA,gBAAI1C,GAAGC,WAAH,CAAegC,iBAAnB,EAAsC;AAClC,qBAAKC,gBAAL,CAAsBS,MAAtB,GAA+B3C,GAAG8B,OAAH,CAAWC,KAAX,GAAmB,KAAKG,gBAAL,CAAsBH,KAAxE;AACA,qBAAKG,gBAAL,CAAsBU,MAAtB,GAA+B5C,GAAG8B,OAAH,CAAWE,MAAX,GAAoB,KAAKE,gBAAL,CAAsBF,MAAzE;AACH;;AAED;AACA,gBAAId,OAAOU,KAAP,CAAaiB,IAAjB,EAAuB;AACnB,qBAAKC,WAAL,GAAmB,IAAI9C,GAAGmC,MAAP,CAAcjB,OAAOU,KAAP,CAAaS,GAA3B,CAAnB;AACA,oBAAIU,uBAAuB/C,GAAGgD,IAAH,CAAQhD,GAAGiD,WAAH,CAAeC,MAAvB,EAA+BlD,GAAGmD,CAAH,CAAK,CAAL,EAAQ,KAAKnC,YAAL,GAAoB,CAApB,GAAwB,CAAxB,GAA4B,KAAKD,YAAL,GAAoB,CAAC,EAArB,GAA0B,EAA9D,CAA/B,CAA3B;AACA,qBAAK+B,WAAL,CAAiBM,WAAjB,CAA6BlC,OAAOU,KAAP,CAAayB,QAAb,GAAwBnC,OAAOU,KAAP,CAAayB,QAArC,GAAgDN,oBAA7E;AACA,qBAAKlB,aAAL,CAAmBS,QAAnB,CAA4B,KAAKQ,WAAjC;AACA,oBAAI5B,OAAOU,KAAP,CAAaF,MAAjB,EAAyB;AACrB,yBAAKoB,WAAL,CAAiBQ,SAAjB,CAA2BpC,OAAOU,KAAP,CAAaF,MAAxC;AACH;AACJ;;AAED;AACA,gBAAIR,OAAOO,IAAP,CAAYoB,IAAhB,EAAsB;AAClB,qBAAKU,UAAL,GAAkB,IAAIvD,GAAGmC,MAAP,CAAcjB,OAAOO,IAAP,CAAYY,GAA1B,CAAlB;AACA,oBAAImB,sBAAsBxD,GAAGgD,IAAH,CAAQhD,GAAGiD,WAAH,CAAeQ,GAAvB,EAA4BzD,GAAGmD,CAAH,CAAK,CAAL,EAAQ,KAAKnC,YAAL,GAAoB,CAApB,GAAwB,CAAxB,GAA4B,CAAC,KAAKuC,UAAL,CAAgBvB,MAAjB,GAA0B,CAA1B,IAA+B,KAAKjB,YAAL,GAAoB,EAApB,GAAyB,EAAxD,CAApC,CAA5B,CAA1B;AACA,qBAAKwC,UAAL,CAAgBH,WAAhB,CAA4BlC,OAAOO,IAAP,CAAY4B,QAAZ,GAAuBnC,OAAOO,IAAP,CAAY4B,QAAnC,GAA8CG,mBAA1E;AACA,qBAAK3B,aAAL,CAAmBS,QAAnB,CAA4B,KAAKiB,UAAjC;AACA,oBAAIrC,OAAOO,IAAP,CAAYC,MAAhB,EAAwB;AACpB,yBAAK6B,UAAL,CAAgBD,SAAhB,CAA0BpC,OAAOO,IAAP,CAAYC,MAAtC;AACH;AACJ;;AAED;AACA,gBAAIR,OAAOwC,WAAP,CAAmBb,IAAvB,EAA6B;AACzB,qBAAKc,iBAAL,GAAyB,IAAI3D,GAAGmC,MAAP,CAAcjB,OAAOwC,WAAP,CAAmBrB,GAAjC,CAAzB;AACA,qBAAKvB,sBAAL,GAA8B,KAAK6C,iBAAL,CAAuB5B,KAArD;AACA,qBAAK6B,wBAAL,GAAgC,IAAI5D,GAAGmC,MAAP,CAAcjB,OAAOwC,WAAP,CAAmBG,gBAAjC,CAAhC;AACA,qBAAKF,iBAAL,CAAuBlB,OAAvB,GAAiC,CAAjC;AACA,qBAAKkB,iBAAL,CAAuBjB,OAAvB,GAAiC,CAAjC;AACA,oBAAI1C,GAAGC,WAAH,CAAe6D,kBAAnB,EAAuC;AACnC,yBAAKC,SAAL,GAAiB,IAAI/D,GAAGmC,MAAP,CAAcjB,OAAOwC,WAAP,CAAmBM,QAAjC,CAAjB;AACA,yBAAKL,iBAAL,CAAuBrB,QAAvB,CAAgC,KAAKyB,SAArC;AACH;AACD,oBAAI7C,OAAOwC,WAAP,CAAmBG,gBAAnB,IAAuC,IAA3C,EAAiD;AAC7C,yBAAKD,wBAAL,CAA8BK,cAA9B,CAA6CjE,GAAGkE,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAc,KAAKP,iBAAL,CAAuB5B,KAArC,EAA4C,KAAK4B,iBAAL,CAAuB3B,MAAnE,CAA7C;AACH;AACD,oBAAId,OAAOwC,WAAP,CAAmBS,MAAnB,IAA6B,IAAjC,EAAuC;AACnC,wBAAIC,qBAAqB,CAAC,KAAKR,wBAAL,CAA8B7B,KAA9B,GAAsC,KAAK4B,iBAAL,CAAuB5B,KAA9D,IAAuE,CAAhG;AACA,wBAAIsC,qBAAqB,CAAC,KAAKT,wBAAL,CAA8B5B,MAA9B,GAAuC,KAAK2B,iBAAL,CAAuB3B,MAA/D,IAAyE,CAAlG;AACAd,2BAAOwC,WAAP,CAAmBS,MAAnB,GAA4BnE,GAAGmD,CAAH,CAAKiB,kBAAL,EAAyBC,kBAAzB,CAA5B;AACH;AACD,qBAAKV,iBAAL,CAAuBP,WAAvB,CAAmClC,OAAOwC,WAAP,CAAmBS,MAAtD;AACA,qBAAKP,wBAAL,CAA8BtB,QAA9B,CAAuC,KAAKqB,iBAA5C;AACA,oBAAIW,0BAA0BtE,GAAGgD,IAAH,CAAQhD,GAAGiD,WAAH,CAAesB,MAAvB,EAA+BvE,GAAGmD,CAAH,CAAK,CAAL,EAAQ,KAAKQ,iBAAL,CAAuB3B,MAAvB,GAAgC,CAAhC,GAAoC,KAAKjB,YAAzC,GAAwD,EAAxD,GAA6D,EAArE,CAA/B,CAA9B;AACA,qBAAK6C,wBAAL,CAA8BR,WAA9B,CAA0ClC,OAAOwC,WAAP,CAAmBL,QAAnB,GAA8BnC,OAAOwC,WAAP,CAAmBL,QAAjD,GAA4DiB,uBAAtG;AACA,qBAAKzC,aAAL,CAAmBS,QAAnB,CAA4B,KAAKsB,wBAAjC;AACA,qBAAKY,YAAL,CAAkB,CAAlB;AACH;;AAED;AACA,gBAAItD,OAAOuD,IAAP,CAAY5B,IAAhB,EAAsB;AAClB,qBAAK6B,SAAL,GAAiB,IAAI1E,GAAG2E,QAAP,CAAgB,MAAhB,EAAwB,OAAxB,EAAiCzD,OAAOuD,IAAP,CAAYG,QAA7C,CAAjB;AACA,qBAAKF,SAAL,CAAeG,QAAf,CAAwB3D,OAAOuD,IAAP,CAAYK,KAAZ,GAAoB5D,OAAOuD,IAAP,CAAYK,KAAhC,GAAwC9E,GAAG8E,KAAH,CAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB,CAAhE;AACA,qBAAKJ,SAAL,CAAetB,WAAf,CAA2BlC,OAAOuD,IAAP,CAAYpB,QAAZ,GAAuBnC,OAAOuD,IAAP,CAAYpB,QAAnC,GAA8C,KAAKO,wBAAL,GAAgC5D,GAAGmD,CAAH,CAAK,KAAKS,wBAAL,CAA8BrB,CAAnC,EAAsC,KAAKqB,wBAAL,CAA8BpB,CAA9B,GAAkC,KAAKoB,wBAAL,CAA8B5B,MAA9B,GAAuC,CAAzE,GAA6E,EAAnH,CAAhC,GAAyJhC,GAAGgD,IAAH,CAAQhD,GAAGiD,WAAH,CAAesB,MAAvB,EAA+BvE,GAAGmD,CAAH,CAAK,CAAL,EAAQ,GAAR,CAA/B,CAAlO;AACA,qBAAKtB,aAAL,CAAmBS,QAAnB,CAA4B,KAAKoC,SAAjC;AACH;AACD,iBAAKpC,QAAL,CAAc,KAAKT,aAAnB;AACA,gBAAI,KAAKb,YAAL,GAAoB,CAAxB,EAA2B;AACvB,qBAAKa,aAAL,CAAmBkD,QAAnB,CAA4B,KAAK/D,YAAjC;AACA,qBAAKa,aAAL,CAAmBuB,WAAnB,CAA+BpD,GAAGgD,IAAH,CAAQ,KAAKnB,aAAL,CAAmBmD,WAAnB,EAAR,EAA0ChF,GAAGmD,CAAH,CAAK,CAAL,EAAQ,CAAC,EAAT,CAA1C,CAA/B;AACH;AAEJ,SAvH4B;AAwH7BqB,sBAAc,sBAAUS,OAAV,EAAmB;AAC7B,gBAAI,KAAKtB,iBAAT,EAA4B;AACxBsB,0BAAU,CAAV,GAAcA,OAAd,GAAwB,CAAxB;AACA,oBAAIlD,QAAQkD,UAAU,KAAKnE,sBAA3B;AACA,qBAAK6C,iBAAL,CAAuBM,cAAvB,CAAsCjE,GAAGkE,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAcnC,KAAd,EAAqB,KAAK4B,iBAAL,CAAuB3B,MAA5C,CAAtC;AACA,oBAAIhC,GAAGC,WAAH,CAAe6D,kBAAnB,EAAuC;AACnC,yBAAKC,SAAL,CAAeX,WAAf,CAA2BpD,GAAGmD,CAAH,CAAK,KAAKQ,iBAAL,CAAuB5B,KAA5B,EAAmC,KAAK4B,iBAAL,CAAuB3B,MAAvB,GAAgC,CAAnE,CAA3B;AACH;AACJ;AACJ,SAjI4B;AAkI7BkD,uBAAe,uBAAUC,GAAV,EAAe;AAC1B,gBAAI,KAAKT,SAAL,IAAkB,IAAtB,EAA4B;AACxB,qBAAKA,SAAL,CAAeU,SAAf,CAAyBD,GAAzB;AACH;AACJ,SAtI4B;AAuI7BE,wBAAgB,0BAAY;AACxB,mBAAO,KAAK1B,iBAAZ;AACH,SAzI4B;AA0I7B2B,sBAAc,wBAAY;AACtB,mBAAO,KAAKZ,SAAZ;AACH,SA5I4B;AA6I7Ba,uBAAe,yBAAY;AACvB,mBAAO,KAAKhC,UAAZ;AACH,SA/I4B;AAgJ7BiC,wBAAgB,0BAAY;AACxB,mBAAO,KAAK1C,WAAZ;AACH,SAlJ4B;AAmJ7B2C,qBAAa,qBAAUC,SAAV,EAAqBC,QAArB,EAA+BC,MAA/B,EAAuC;AAChD,iBAAKnF,UAAL,GAAkBiF,SAAlB;AACA,iBAAKhF,SAAL,GAAiBiF,QAAjB;AACA,iBAAKhF,SAAL,GAAiBiF,MAAjB;AACH,SAvJ4B;AAwJ7BC,4BAAoB,8BAAY;AAC5B,iBAAKX,aAAL,CAAmB,EAAnB;AACA,iBAAKV,YAAL,CAAkB,CAAlB;AACH,SA3J4B;AA4J7BsB,wBAAgB,0BAAY;AACxB9F,eAAG+F,GAAH,CAAO,kDAAkD,KAAKtF,UAA9D;AACA,iBAAKoF,kBAAL;AACA,gBAAI7F,GAAGgG,GAAH,CAAOC,QAAX,EAAqB;AACjBjG,mBAAGkG,MAAH,CAAUC,OAAV,CAAkB,KAAK1F,UAAvB,EAAmC,KAAK2F,eAAxC,EAAyD,IAAzD;AACH,aAFD,MAEO;AACH,qBAAKC,cAAL;AACH;AACJ,SApK4B;AAqK7BA,wBAAgB,0BAAY;AACxB,gBAAIhE,MAAM,EAAV;AACA,gBAAIiE,aAAa,EAAjB;AACA,gBAAIpF,SAASlB,GAAGC,WAAH,CAAesB,YAA5B;AACA,gBAAIgF,SAASvG,GAAGC,WAAH,CAAesG,MAA5B;AACA,gBAAIvG,GAAGwG,QAAH,CAAY,KAAK/F,UAAjB,CAAJ,EAAkC;AAC9B,oBAAI,KAAKA,UAAL,CAAgBgG,OAAhB,CAAwB,GAAxB,KAAgC,CAAC,CAArC,EAAwC;AACpCpE,0BAAM,CAAC,KAAK5B,UAAN,CAAN;AACH,iBAFD,MAEO;AACH4B,0BAAMkE,OAAO,KAAK9F,UAAZ,CAAN;AACH;AACJ,aAND,MAMO,IAAIT,GAAG0G,OAAH,CAAW,KAAKjG,UAAhB,CAAJ,EAAiC;AACpC4B,sBAAM,EAAN;AACA,qBAAK,IAAIsE,IAAI,CAAb,EAAgBA,IAAI,KAAKlG,UAAL,CAAgBmG,MAApC,EAA4CD,GAA5C,EAAiD;AAC7C,wBAAIE,QAAQN,OAAO,KAAK9F,UAAL,CAAgBkG,CAAhB,CAAP,CAAZ;AACA,wBAAIG,QAAQD,SAASA,MAAMC,KAA3B;AACA,wBAAIC,WAAWJ,IAAI,CAAJ,GAAQL,WAAWK,IAAI,CAAf,CAAR,GAA4B,CAA3C;AACAL,+BAAWU,IAAX,CAAgBD,WAAWD,KAAX,GAAmBA,MAAMF,MAAzB,GAAkC,CAAlD;AACAvE,0BAAMA,IAAI4E,MAAJ,CAAWH,KAAX,CAAN;AACH;AACJ;AACD,gBAAII,OAAO,IAAX;AACA;AACAlH,eAAGmH,MAAH,CAAUC,IAAV,CAAe/E,GAAf,EAAoB,UAAUgF,MAAV,EAAkBC,KAAlB,EAAyBC,WAAzB,EAAsC;AACtD,oBAAIC,iBAAiB,SAAjBA,cAAiB,CAAUD,WAAV,EAAuB;AACxC,yBAAK,IAAIZ,IAAI,CAAb,EAAgBA,IAAIL,WAAWM,MAA/B,EAAuCD,GAAvC,EAA4C;AACxC,4BAAIL,WAAWK,CAAX,KAAiBY,WAArB,EAAkC;AAC9B,mCAAOL,KAAKzG,UAAL,CAAgBkG,CAAhB,CAAP;AACH;AACJ;AACJ,iBAND;AAOA,oBAAIc,YAAYD,eAAeD,WAAf,CAAhB;AACA,oBAAIG,SAAS;AACTD,+BAAWA,SADF;AAETE,iCAAa,KAFJ;AAGT1C,6BAAUsC,cAAcD,KAAd,GAAsB,GAAvB,GAA8B,CAH9B,EAGgC;AACzCM,2BAAO,CAJE,EAIC;AACVC,8BAAU;AALD,iBAAb;AAOA,oBAAIH,OAAOzC,OAAP,IAAkB,CAAtB,EAAyB;AACrBiC,yBAAK1C,YAAL,CAAkBkD,OAAOzC,OAAP,GAAiB,GAAnC;AACH;AACD/D,uBAAOuD,IAAP,CAAYqD,YAAZ,CAAyBJ,MAAzB,EAAiCR,IAAjC;AACH,aApBD,EAoBG,YAAY;AACXA,qBAAKa,gBAAL;AACAb,qBAAKtG,aAAL;AACA,oBAAIsG,KAAKxG,SAAT,EAAoB;AAChB,wBAAIwG,KAAKvG,SAAT,EAAoB;AAChBuG,6BAAKxG,SAAL,CAAewG,KAAKvG,SAApB,EAA+B,IAA/B;AACH,qBAFD,MAEO;AACHuG,6BAAKxG,SAAL,CAAe,IAAf;AACH;AACJ;AACJ,aA9BD;AA+BH,SA3N4B;AA4N7B0F,yBAAiB,yBAAUsB,MAAV,EAAkB;AAC/B1H,eAAG+F,GAAH,CAAOiC,KAAKC,SAAL,CAAeP,MAAf,CAAP;AACA,gBAAIxG,SAASlB,GAAGC,WAAH,CAAesB,YAA5B;AACA,gBAAImG,OAAOzC,OAAX,EAAoB;AAChB,qBAAKT,YAAL,CAAkBkD,OAAOzC,OAAP,GAAiB,GAAnC;AACH;AACD,gBAAI/D,OAAOuD,IAAP,CAAYqD,YAAhB,EAA8B;AAC1B5G,uBAAOuD,IAAP,CAAYqD,YAAZ,CAAyBJ,MAAzB,EAAiC,IAAjC;AACH;AACD,gBAAIA,OAAOC,WAAP,IAAsBD,OAAOG,QAAjC,EAA2C;AACvC,qBAAKjH,aAAL;;AAEA,oBAAI8G,OAAOC,WAAX,EAAwB;AACpB3H,uBAAG+F,GAAH,CAAO,iBAAP;AACA,yBAAKlF,oBAAL,GAA4B,KAA5B;AACH;AACD,oBAAI6G,OAAOG,QAAX,EAAqB;AACjB7H,uBAAG+F,GAAH,CAAO,iBAAP;AACA,yBAAKlF,oBAAL,GAA4B,IAA5B;AACH;;AAED;AACA,oBAAI,KAAKD,aAAL,IAAsB,CAAtB,IAA2B,CAAC,KAAKC,oBAArC,EAA2D;AACvD,yBAAKkH,gBAAL;AACA,wBAAI/H,GAAGC,WAAH,CAAegC,iBAAnB,EAAsC;AAClC,4BAAIiG,UAAUlI,GAAGmI,OAAH,CAAWjH,MAAX,CAAkBkH,iBAAlB,IAAuC,EAACrG,OAAO,GAAR,EAAaC,QAAQ,GAArB,EAA0BqG,QAAQ,UAAlC,EAArD;AACArI,2BAAGsI,IAAH,CAAQC,uBAAR,CAAgCL,QAAQnG,KAAxC,EAA+CmG,QAAQlG,MAAvD,EAA+DhC,GAAGwI,gBAAH,CAAoBN,QAAQG,MAA5B,CAA/D;AACH;AACJ;;AAED;AACA,qBAAK3H,SAAL,CAAe+H,IAAf,CAAoB,KAAKC,OAAzB,EAAkChB,MAAlC;AACH;AACJ,SA7P4B;AA8P7BiB,qBAAa,uBAAY;AACrB,gBAAI,KAAK/H,aAAL,IAAsB,CAAtB,IAA2B,CAAC,KAAKC,oBAArC,EAA2D;AACvD,oBAAIb,GAAGgG,GAAH,CAAOC,QAAP,IAAmBjG,GAAGC,WAAH,CAAegC,iBAAtC,EAAyD;AACrD,wBAAIf,SAASlB,GAAGmI,OAAH,CAAWjH,MAAX,CAAkBkH,iBAA/B;AACA,wBAAIQ,cAAc,KAAlB;AACA,wBAAIC,sBAAsB,KAA1B;AACA,wBAAI3H,MAAJ,EAAY;AACR,4BAAI4H,cAAc9I,GAAGmI,OAAH,CAAWjH,MAAX,CAAkB4H,WAApC;AACA9I,2BAAG+F,GAAH,CAAO,gCAAgC+C,WAAvC;AACA,4BAAIA,eAAe,WAAnB,EAAgC;AAC5BF,0CAAc,IAAd;AACAC,kDAAsB3H,OAAOa,KAAP,GAAe,GAAf,IAAsBb,OAAOc,MAAP,GAAgB,GAA5D;AACH,yBAHD,MAGO;AACH6G,kDAAsB3H,OAAOa,KAAP,GAAe,GAAf,IAAsBb,OAAOc,MAAP,GAAgB,GAA5D;AACH;AACJ;AACDhC,uBAAG+F,GAAH,CAAO,4BAA4B8C,mBAAnC;AACA7I,uBAAGsI,IAAH,CAAQC,uBAAR,CAAgCM,sBAAsB3H,OAAOa,KAA7B,GAAqC6G,cAAc,GAAd,GAAoB,GAAzF,EAA8FC,sBAAsB3H,OAAOc,MAA7B,GAAsC4G,cAAc,GAAd,GAAoB,GAAxJ,EAA6J5I,GAAGwI,gBAAH,CAAoB,cAApB,CAA7J;AACH;AACDxI,mBAAG+I,QAAH,CAAYC,eAAZ,GAA8B1G,QAA9B,CAAuC,IAAvC,EAA6C1C,UAAU,CAAvD;AACH;AACD,iBAAKgB,aAAL;AACH;AApR4B,KAAhB,CAAjB;AAsRAZ,OAAGC,WAAH,CAAeiI,OAAf,GAAyB,EAAC;AACtB9F,oBAAY;AACRC,iBAAK;AADG,SADS;AAIrBT,eAAO;AACHiB,kBAAM,IADH;AAEHR,iBAAK,8BAFF;AAGHgB,sBAAU,IAHP;AAIH3B,oBAAQ;AAJL,SAJc;AAUrBD,cAAM;AACFY,iBAAK,6BADH;AAEFQ,kBAAM,IAFJ;AAGFQ,sBAAU;AAHR,SAVe;AAerBK,qBAAa;AACTb,kBAAM,IADG;AAETR,iBAAK,6BAFI;AAGT8B,oBAAQ,IAHC;AAITd,sBAAU,IAJD;AAKTQ,8BAAkB,4BALT;AAMTG,sBAAU,+BAND;AAOTiF,uBAAW;AAPF,SAfQ;AAwBrBxE,cAAM;AACF5B,kBAAM,IADJ;AAEF+B,sBAAU,EAFR;AAGFvB,sBAAU,IAHR;AAIFyB,mBAAO,IAJL;AAKFgD,0BAAc,sBAAUJ,MAAV,EAAkBwB,WAAlB,EAA+B;AACzC,oBAAGA,YAAY5D,YAAZ,EAAH,EAA8B;AAC1B,wBAAI6D,YAAY,IAAhB;AACA,wBAAIzB,OAAOE,KAAP,IAAgB5H,GAAGoJ,OAAH,CAAWC,aAAX,CAAyBC,QAA7C,EAAuD;AACnDH,qCAAa,IAAb;AACH,qBAFD,MAEO,IAAIzB,OAAOE,KAAP,IAAgB5H,GAAGoJ,OAAH,CAAWC,aAAX,CAAyBE,KAA7C,EAAoD;AACvDJ,qCAAa,IAAb;AACH;AACD,wBAAIzB,OAAOD,SAAX,EAAsB;AAClB0B,qCAAazB,OAAOD,SAApB;AACH;AACD0B,iCAAa,QAAQzB,OAAOzC,OAAP,CAAeuE,OAAf,CAAuB,CAAvB,CAAR,GAAoC,GAAjD;AACAN,gCAAY5D,YAAZ,GAA2BF,SAA3B,CAAqC+D,SAArC;AACH;AACJ;AAnBC,SAxBe;AA6CrBM,0BAAkB,0BAAUC,QAAV,EAAoB,CAErC,CA/CoB;AAgDrBrI,iBAAS,iBAAUsI,KAAV,EAAiB;AACtB3J,eAAG+F,GAAH,CAAO,qBAAP;AACH,SAlDoB;AAmDrBvE,gBAAQ,gBAAUmI,KAAV,EAAiB;AACrB3J,eAAG+F,GAAH,CAAO,oBAAP;AACH;AArDoB,KAAzB;;AAwDA,QAAI6D,oBAAoB,KAAxB;;AAEA5J,OAAGC,WAAH,CAAekG,OAAf,GAAyB,UAAUT,SAAV,EAAqBC,QAArB,EAA+BC,MAA/B,EAAuC;AAC5D,YAAIiE,cAAc,IAAI7J,GAAGC,WAAP,EAAlB;AACA,YAAI6J,YAAY,SAAZA,SAAY,CAAUpC,MAAV,EAAkB;AAC9B,gBAAIA,OAAOG,QAAX,EAAqB;AACjB,oBAAIpD,IAAJ,EAAUsF,UAAV,EAAsBC,UAAtB;AACA,wBAAQtC,OAAOuC,SAAf;AACI,yBAAK,cAAL;AACA;AACIxF,mCAAO,cAAP;AACAsF,yCAAa,sBAAY;AACrBG;AACH,6BAFD;AAGAF,yCAAa,sBAAY;AACrBhK,mCAAG+I,QAAH,CAAYoB,GAAZ;AACH,6BAFD;AAGA;AACH;AACD,yBAAK,YAAL;AACA;AACI1F,mCAAO,cAAP;AACAsF,yCAAa,sBAAY;AACrBG;AACH,6BAFD;AAGAF,yCAAa,sBAAY;AACrBhK,mCAAG+I,QAAH,CAAYoB,GAAZ;AACH,6BAFD;AAGA;AACH;AACD,yBAAK,aAAL;AACA;AACI1F,mCAAO,YAAP;AACAsF,yCAAa,sBAAY;AACrBG;AACH,6BAFD;AAGAF,yCAAa,sBAAY;AACrBhK,mCAAG+I,QAAH,CAAYoB,GAAZ;AACH,6BAFD;AAGA;AACH;AACD;AACA;AACIJ,yCAAaC,aAAa,sBAAY,CAErC,CAFD;AAGH;AAvCL;AAyCAhK,mBAAGoK,mBAAH,CAAuBC,KAAvB,CAA6B3C,OAAOuC,SAApC,EAA+CxF,IAA/C,EAAqDsF,UAArD,EAAiEC,UAAjE;AACH,aA5CD,MA4CO;AACH,oBAAIrE,QAAJ,EAAc;AACV,wBAAIC,MAAJ,EAAY;AACRD,iCAAS8C,IAAT,CAAc7C,MAAd,EAAsB,CAAC8B,OAAOG,QAA9B;AACH,qBAFD,MAEO;AACHlC,iCAAS,CAAC+B,OAAOG,QAAjB;AACH;AACJ;AACJ;AACJ,SAtDD;AAuDA,YAAIqC,cAAc,SAAdA,WAAc,GAAY;AAC1BL,wBAAYpE,WAAZ,CAAwBC,SAAxB,EAAmCoE,SAAnC,EAA8ClE,MAA9C;AACAiE,wBAAYlB,WAAZ;AACAkB,wBAAY/D,cAAZ;AACH,SAJD;;AAMA,YAAI8D,iBAAJ,EAAuB;AACnBM;AACA;AACH;;AAED,YAAI,CAAClK,GAAG+I,QAAH,CAAYC,eAAZ,EAAL,EAAoC;AAChChJ,eAAG+I,QAAH,CAAYuB,QAAZ,CAAqB,IAAItK,GAAGuK,KAAP,EAArB;AACH;;AAED;AACAvK,WAAGmH,MAAH,CAAUC,IAAV,CAAe,CACPrH,eADO,EAEPC,GAAGC,WAAH,CAAesB,YAAf,CAA4Ba,UAA5B,CAAuCC,GAFhC,EAGPrC,GAAGC,WAAH,CAAesB,YAAf,CAA4BK,KAA5B,CAAkCS,GAH3B,EAIPrC,GAAGC,WAAH,CAAesB,YAAf,CAA4BE,IAA5B,CAAiCY,GAJ1B,EAKPrC,GAAGC,WAAH,CAAesB,YAAf,CAA4BmC,WAA5B,CAAwCrB,GALjC,EAMPrC,GAAGC,WAAH,CAAesB,YAAf,CAA4BmC,WAA5B,CAAwCG,gBANjC,EAOP7D,GAAGC,WAAH,CAAesB,YAAf,CAA4BmC,WAA5B,CAAwCM,QAPjC,EAQPhE,GAAGC,WAAH,CAAesB,YAAf,CAA4BmC,WAA5B,CAAwCuF,SARjC,EASPjJ,GAAGwK,MAAH,CAAUjJ,YAAV,CAAuBa,UAAvB,CAAkCC,GAT3B,EAUPrC,GAAGwK,MAAH,CAAUjJ,YAAV,CAAuBkJ,UAAvB,CAAkCC,SAV3B,EAWP1K,GAAGwK,MAAH,CAAUjJ,YAAV,CAAuBkJ,UAAvB,CAAkCE,QAX3B,EAYP3K,GAAGwK,MAAH,CAAUjJ,YAAV,CAAuBqJ,SAAvB,CAAiCF,SAZ1B,EAaP1K,GAAGwK,MAAH,CAAUjJ,YAAV,CAAuBqJ,SAAvB,CAAiCD,QAb1B,CAAf,EAeI,UAAUtD,MAAV,EAAkBC,KAAlB,EAAyBC,WAAzB,EAAsC;AAClC,gBAAItC,UAAWsC,cAAcD,KAAd,GAAsB,GAAvB,GAA8B,CAA5C;AACArC,sBAAU4F,KAAKC,GAAL,CAAS7F,OAAT,EAAkB,GAAlB,CAAV;AACAjF,eAAG+F,GAAH,CAAO,oCAAoCd,OAApC,GAA8C,GAArD;AACH,SAnBL,EAmBO,YAAY;AACX,gBAAIsB,SAASvG,GAAGmH,MAAH,CAAU4D,MAAV,CAAiBhL,eAAjB,CAAb;AACA,gBAAIwG,MAAJ,EAAY;AACRvG,mBAAGC,WAAH,CAAesG,MAAf,GAAwBA,MAAxB;AACH,aAFD,MAGK;AACDvG,mBAAGgL,IAAH,CAAQ,8FAAR;AACH;AACDpB,gCAAoB,IAApB;AACAM;AACH,SA7BL;AA8BH,KAvGD;;AAyGAlK,OAAGC,WAAH,CAAegC,iBAAf,GAAmC,IAAnC;AACAjC,OAAGC,WAAH,CAAe6D,kBAAf,GAAoC,IAApC;AACA9D,OAAGC,WAAH,CAAesB,YAAf,GAA8BvB,GAAGC,WAAH,CAAeiI,OAA7C;AACAlI,OAAGC,WAAH,CAAesG,MAAf,GAAwB,EAAxB;AACAvG,OAAGC,WAAH,CAAegL,mBAAf,GAAqC,UAAUvD,MAAV,EAAkB;AACnD1H,WAAGC,WAAH,CAAegC,iBAAf,GAAmCyF,MAAnC;AACH,KAFD;AAGA1H,OAAGC,WAAH,CAAemB,SAAf,GAA2B,UAAUF,MAAV,EAAkB;AACzC,YAAGA,OAAOU,KAAP,IAAgBV,OAAOU,KAAP,CAAaF,MAAhC,EAAuC;AACnCR,mBAAOU,KAAP,CAAaF,MAAb,CAAoBwJ,MAApB;AACH;AACD,YAAGhK,OAAOO,IAAP,IAAeP,OAAOO,IAAP,CAAYC,MAA9B,EAAqC;AACjCR,mBAAOO,IAAP,CAAYC,MAAZ,CAAmBwJ,MAAnB;AACH;AACD,aAAKC,SAAL,CAAejK,MAAf;AACH,KARD;AASAlB,OAAGC,WAAH,CAAekL,SAAf,GAA2B,UAAUC,OAAV,EAAmB;AAC1C,aAAK7J,YAAL,GAAoBvB,GAAGqL,KAAH,CAAS,KAAKnD,OAAd,CAApB;AACA,YAAIhH,SAAS,KAAKK,YAAlB;AACA,YAAI6J,WAAW,IAAf,EAAqB;AACjB,gBAAIA,QAAQhJ,UAAR,IAAsBgJ,QAAQhJ,UAAR,CAAmBC,GAA7C,EAAkD;AAC9CnB,uBAAOkB,UAAP,CAAkBC,GAAlB,GAAwB+I,QAAQhJ,UAAR,CAAmBC,GAA3C;AACH;AACD,gBAAI+I,QAAQxJ,KAAZ,EAAmB;AACf,oBAAI0J,SAASF,QAAQxJ,KAArB;AACA,oBAAIA,QAAQV,OAAOU,KAAnB;AACAA,sBAAMiB,IAAN,GAAa,OAAOyI,OAAOzI,IAAd,IAAsB,WAAtB,GAAoCyI,OAAOzI,IAA3C,GAAkDjB,MAAMiB,IAArE;AACAjB,sBAAMS,GAAN,GAAYiJ,OAAOjJ,GAAP,GAAaiJ,OAAOjJ,GAApB,GAA0BT,MAAMS,GAA5C;AACAT,sBAAMyB,QAAN,GAAiBiI,OAAOjI,QAAP,GAAkBiI,OAAOjI,QAAzB,GAAoCzB,MAAMyB,QAA3D;AACAzB,sBAAMF,MAAN,GAAe4J,OAAO5J,MAAP,GAAgB4J,OAAO5J,MAAvB,GAAgCE,MAAMF,MAArD;AACA,oBAAIE,MAAMF,MAAV,EAAkB;AACdE,0BAAMF,MAAN,GAAe4J,OAAO5J,MAAtB;AACAE,0BAAMF,MAAN,CAAawJ,MAAb;AACH;AACJ;AACD,gBAAIE,QAAQ3J,IAAZ,EAAkB;AACd,oBAAI8J,QAAQH,QAAQ3J,IAApB;AACA,oBAAIA,OAAOP,OAAOO,IAAlB;AACAA,qBAAKoB,IAAL,GAAY,OAAO0I,MAAM1I,IAAb,IAAqB,WAArB,GAAmC0I,MAAM1I,IAAzC,GAAgDpB,KAAKoB,IAAjE;AACApB,qBAAKY,GAAL,GAAWkJ,MAAMlJ,GAAN,GAAYkJ,MAAMlJ,GAAlB,GAAwBZ,KAAKY,GAAxC;AACAZ,qBAAK4B,QAAL,GAAgBkI,MAAMlI,QAAN,GAAiBkI,MAAMlI,QAAvB,GAAkC5B,KAAK4B,QAAvD;AACA,oBAAI,OAAOkI,MAAM7J,MAAb,IAAuB,WAA3B,EAAwC;AACpCD,yBAAKC,MAAL,GAAc6J,MAAM7J,MAApB;AACA,wBAAID,KAAKC,MAAT,EAAiB;AACbD,6BAAKC,MAAL,CAAYwJ,MAAZ;AACH;AACJ;AACJ;AACD,gBAAIE,QAAQ1H,WAAZ,EAAyB;AACrB,oBAAI8H,YAAYJ,QAAQ1H,WAAxB;AACA,oBAAIgG,WAAWxI,OAAOwC,WAAtB;AACAgG,yBAAS7G,IAAT,GAAgB,OAAO2I,UAAU3I,IAAjB,IAAyB,WAAzB,GAAuC2I,UAAU3I,IAAjD,GAAwD6G,SAAS7G,IAAjF;AACA,oBAAI2I,UAAUnJ,GAAd,EAAmB;AACfqH,6BAASrH,GAAT,GAAemJ,UAAUnJ,GAAzB;AACA,yBAAKyB,kBAAL,GAA0B,KAA1B;AACH;AACD4F,yBAASvF,MAAT,GAAkBqH,UAAUrH,MAAV,GAAmBqH,UAAUrH,MAA7B,GAAsCuF,SAASvF,MAAjE;AACAuF,yBAASrG,QAAT,GAAoBmI,UAAUnI,QAAV,GAAqBmI,UAAUnI,QAA/B,GAA0CqG,SAASrG,QAAvE;AACAqG,yBAAS7F,gBAAT,GAA4B2H,UAAU3H,gBAAV,GAA6B2H,UAAU3H,gBAAvC,GAA0D6F,SAAS7F,gBAA/F;AACH;AACD,gBAAIuH,QAAQ3G,IAAZ,EAAkB;AACd,oBAAIgH,QAAQL,QAAQ3G,IAApB;AACA,oBAAIA,OAAOvD,OAAOuD,IAAlB;AACAA,qBAAK5B,IAAL,GAAY,OAAO4I,MAAM5I,IAAb,IAAqB,WAArB,GAAmC4I,MAAM5I,IAAzC,GAAgD4B,KAAK5B,IAAjE;AACA4B,qBAAKpC,GAAL,GAAWoJ,MAAMpJ,GAAN,GAAYoJ,MAAMpJ,GAAlB,GAAwBoC,KAAKpC,GAAxC;AACAoC,qBAAKN,MAAL,GAAcsH,MAAMtH,MAAN,GAAesH,MAAMtH,MAArB,GAA8BM,KAAKN,MAAjD;AACAM,qBAAKG,QAAL,GAAgB6G,MAAM7G,QAAN,GAAiB6G,MAAM7G,QAAvB,GAAkCH,KAAKG,QAAvD;AACAH,qBAAKpB,QAAL,GAAgBoI,MAAMpI,QAAN,GAAiBoI,MAAMpI,QAAvB,GAAkCoB,KAAKpB,QAAvD;AACAoB,qBAAKK,KAAL,GAAa2G,MAAM3G,KAAN,GAAc2G,MAAM3G,KAApB,GAA4BL,KAAKK,KAA9C;AACA,oBAAIsG,QAAQ3G,IAAR,CAAaqD,YAAb,IAA6B,OAAOsD,QAAQ3G,IAAR,CAAaqD,YAApB,IAAoC,UAArE,EAAiF;AAC7ErD,yBAAKqD,YAAL,GAAoBsD,QAAQ3G,IAAR,CAAaqD,YAAjC;AACH;AACJ;AACD,gBAAI,OAAOsD,QAAQ/J,OAAf,IAA0B,UAA9B,EAA0C;AACtCH,uBAAOG,OAAP,GAAiB+J,QAAQ/J,OAAzB;AACH;AACD,gBAAI,OAAO+J,QAAQ5J,MAAf,IAAyB,UAA7B,EAAyC;AACrCN,uBAAOM,MAAP,GAAgB4J,QAAQ5J,MAAxB;AACH;AACJ;;AAED,YAAI,OAAON,OAAOO,IAAP,CAAYC,MAAnB,IAA6B,WAA7B,IAA4C,KAAKO,iBAArD,EAAwE;AACpEf,mBAAOO,IAAP,CAAYC,MAAZ,GAAqB1B,GAAG0L,QAAH,CACjB1L,GAAG2L,KAAH,CAAS3L,GAAG4L,MAAH,CAAU,GAAV,EAAe5L,GAAGmD,CAAH,CAAK,CAAL,EAAQ,EAAR,CAAf,EAA4B0I,MAA5B,CAAmC7L,GAAG8L,MAAH,CAAU,GAAV,CAAnC,CAAT,EAA6D9L,GAAG+L,OAAH,CAAW,GAAX,EAAgB,IAAhB,EAAsB,IAAtB,EAA4BF,MAA5B,CAAmC7L,GAAG8L,MAAH,CAAU,GAAV,CAAnC,CAA7D,CADiB,EAEjB9L,GAAGgM,SAAH,CAAa,IAAb,CAFiB,EAGjBhM,GAAG2L,KAAH,CAAS3L,GAAG4L,MAAH,CAAU,GAAV,EAAe5L,GAAGmD,CAAH,CAAK,CAAL,EAAQ,CAAC,EAAT,CAAf,EAA6B0I,MAA7B,CAAoC7L,GAAGiM,OAAH,CAAW,GAAX,CAApC,CAAT,EAA+DjM,GAAG+L,OAAH,CAAW,GAAX,EAAgB,IAAhB,EAAsB,IAAtB,EAA4BF,MAA5B,CAAmC7L,GAAGiM,OAAH,CAAW,GAAX,CAAnC,CAA/D,CAHiB,EAInBC,aAJmB,EAArB;AAKAhL,mBAAOO,IAAP,CAAYC,MAAZ,CAAmBwJ,MAAnB;AACH;AACD,YAAI,CAAChK,OAAOuD,IAAP,CAAYK,KAAjB,EAAwB;AACpB5D,mBAAOuD,IAAP,CAAYK,KAAZ,GAAoB9E,GAAG8E,KAAH,CAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB,CAApB;AACH;AACJ,KA5ED;;AA8EA9E,OAAGwK,MAAH,GAAYxK,GAAGE,KAAH,CAASC,MAAT,CAAgB;AACxBgM,wBAAgB,IADQ;AAExBjK,0BAAkB,IAFM;AAGxBkK,0BAAkB,IAHM;AAIxBC,yBAAiB,IAJO;AAKxBC,uBAAe,IALS;AAMxBC,wBAAgB,IANQ;AAOxBvL,sBAAc,IAPU;;AASxBC,cAAM,cAAUC,MAAV,EAAkB;AACpB,iBAAKC,MAAL;AACA,iBAAKC,SAAL,CAAeF,MAAf;AACH,SAZuB;AAaxBE,mBAAW,mBAAUF,MAAV,EAAkB;AACzB,iBAAKsL,iBAAL;AACA,gBAAItL,MAAJ,EAAY;AACRlB,mBAAGwK,MAAH,CAAUpJ,SAAV,CAAoBF,MAApB;AACH;AACJ,SAlBuB;AAmBxBI,kBAAU,oBAAY;AAClB,gBAAImL,mBAAmBzM,GAAGwK,MAAH,CAAUvI,iBAAjC;AACA,gBAAIH,UAAU9B,GAAG+I,QAAH,CAAY2D,UAAZ,EAAd;AACA,iBAAK1L,YAAL,GAAoB,CAACyL,gBAAD,GAAoB,CAApB,GAAwB3K,QAAQC,KAAR,GAAgBD,QAAQE,MAAxB,GAAiCF,QAAQC,KAAR,GAAgB,GAAjD,GAAuDD,QAAQC,KAAR,GAAgB,GAAnH;AACA,gBAAIb,SAASlB,GAAGwK,MAAH,CAAUjJ,YAAvB;;AAEA;AACA,iBAAKW,gBAAL,GAAwB,IAAIlC,GAAG2M,YAAP,CAAoBzL,OAAOkB,UAAP,CAAkBC,GAAtC,CAAxB;AACA,iBAAKuK,SAAL,CAAe,KAAK1K,gBAApB;AACA,gBAAI,KAAKlB,YAAL,GAAoB,CAAxB,EAA2B;AACvB,qBAAKkB,gBAAL,CAAsB6C,QAAtB,CAA+B,KAAK/D,YAApC;AACH;AACD,iBAAKkB,gBAAL,CAAsBkB,WAAtB,CAAkClC,OAAOmC,QAAP,GAAkBnC,OAAOmC,QAAzB,GAAoCrD,GAAGmD,CAAH,CAAKrB,QAAQC,KAAR,GAAgB,CAArB,EAAwBD,QAAQE,MAAR,GAAiB,CAAzC,CAAtE;;AAEA;AACA,iBAAK6K,eAAL,GAAuB,KAAKC,qBAAL,CAA2B5L,OAAOuJ,UAAlC,EAA8C,KAAKsC,gBAAnD,CAAvB;AACA,iBAAKC,cAAL,GAAsB,KAAKF,qBAAL,CAA2B5L,OAAO0J,SAAlC,EAA6C,KAAKqC,eAAlD,CAAtB;AACA,iBAAKD,cAAL,CAAoB5J,WAApB,CAAgClC,OAAO0J,SAAP,CAAiBvH,QAAjB,GAA4BnC,OAAO0J,SAAP,CAAiBvH,QAA7C,GAAwDrD,GAAGmD,CAAH,CAAK,KAAKjB,gBAAL,CAAsBH,KAAtB,GAA8B,CAA9B,GAAkC,KAAKiL,cAAL,CAAoBjL,KAApB,GAA4B,CAA9D,GAAkE,EAAvE,EAA2E,KAAKiL,cAAL,CAAoBhL,MAApB,GAA6B,EAAxG,CAAxF;AACA,iBAAK6K,eAAL,CAAqBzJ,WAArB,CAAiClC,OAAOuJ,UAAP,CAAkBpH,QAAlB,GAA6BnC,OAAOuJ,UAAP,CAAkBpH,QAA/C,GAA0DrD,GAAGmD,CAAH,CAAK,KAAKjB,gBAAL,CAAsBH,KAAtB,GAA8B,CAA9B,GAAkC,KAAK8K,eAAL,CAAqB9K,KAArB,GAA6B,CAA/D,GAAmE,EAAxE,EAA4E,KAAK8K,eAAL,CAAqB7K,MAArB,GAA8B,EAA1G,CAA3F;AACA,gBAAIkL,OAAO,IAAIlN,GAAGmN,IAAP,CAAY,KAAKN,eAAjB,EAAkC,KAAKG,cAAvC,CAAX;AACAE,iBAAK9J,WAAL,CAAiBpD,GAAGmD,CAAH,CAAK,CAAL,EAAQ,CAAR,CAAjB;AACA,iBAAKjB,gBAAL,CAAsBI,QAAtB,CAA+B4K,IAA/B;;AAEA;AACA,gBAAItI,WAAW1D,OAAOkM,YAAP,CAAoBxI,QAApB,GAA+B1D,OAAOkM,YAAP,CAAoBxI,QAAnD,GAA8D,KAAK5D,YAAL,GAAoB,CAApB,GAAwB,KAAK,KAAKA,YAAlC,GAAiD,EAA9H;AACA,iBAAKoM,YAAL,GAAoB,IAAIpN,GAAG2E,QAAP,CAAgBzD,OAAOkM,YAAP,CAAoBC,IAApC,EAA0C,OAA1C,EAAmDzI,QAAnD,CAApB;AACA,iBAAKwI,YAAL,CAAkBE,aAAlB,CAAgCpM,OAAOkM,YAAP,CAAoBG,UAApB,GAAiCrM,OAAOkM,YAAP,CAAoBG,UAArD,GAAkEvN,GAAGwN,IAAH,CAAQ,KAAKtL,gBAAL,CAAsBH,KAAtB,GAA8B,EAAtC,EAA0C,KAAKG,gBAAL,CAAsBF,MAAtB,GAA+B,KAAK6K,eAAL,CAAqBrK,CAApD,GAAwD,EAAlG,CAAlG;AACA,iBAAK4K,YAAL,CAAkBvI,QAAlB,CAA2B3D,OAAOkM,YAAP,CAAoBtI,KAApB,GAA4B5D,OAAOkM,YAAP,CAAoBtI,KAAhD,GAAwD9E,GAAG8E,KAAH,CAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB,CAAnF;AACA,iBAAKsI,YAAL,CAAkBhK,WAAlB,CAA8BlC,OAAOkM,YAAP,CAAoB/J,QAApB,GAA+BnC,OAAOkM,YAAP,CAAoB/J,QAAnD,GAA8DrD,GAAGmD,CAAH,CAAK,KAAKjB,gBAAL,CAAsBH,KAAtB,GAA8B,CAAnC,EAAsC,KAAKG,gBAAL,CAAsBF,MAAtB,GAA+B,KAAKoL,YAAL,CAAkBpL,MAAlB,GAA2B,CAA1D,GAA8D,EAApG,CAA5F;AACA,iBAAKE,gBAAL,CAAsBI,QAAtB,CAA+B,KAAK8K,YAApC;AACA,gBAAI,CAAClM,OAAOQ,MAAZ,EAAoB;AAChB,oBAAIA,SAAS1B,GAAG0L,QAAH,CAAY1L,GAAGyN,MAAH,CAAUC,MAAV,CAAiB1N,GAAG+L,OAAH,CAAW,GAAX,EAAgB,KAAK7J,gBAAL,CAAsByL,KAAtB,GAA8B,IAA9C,CAAjB,EAAsE,GAAtE,CAAZ,EAAwF3N,GAAG4N,OAAH,CAAWF,MAAX,CAAkB1N,GAAG+L,OAAH,CAAW,GAAX,EAAgB,KAAK7J,gBAAL,CAAsByL,KAAtC,CAAlB,EAAgE,GAAhE,CAAxF,CAAb;AACA,qBAAKzL,gBAAL,CAAsBoB,SAAtB,CAAgC5B,MAAhC;AACH,aAHD,MAGO;AACH,qBAAKQ,gBAAL,CAAsBoB,SAAtB,CAAgCpC,OAAOQ,MAAvC;AACH;AACD,iBAAKY,QAAL,CAAc,KAAKJ,gBAAnB;AAEH,SAzDuB;AA0DxB4K,+BAAuB,+BAAUzK,GAAV,EAAesD,QAAf,EAAyB;AAC5C,gBAAIkI,eAAe,IAAI7N,GAAG2M,YAAP,CAAoBtK,IAAIqI,SAAxB,CAAnB;AACA,gBAAIoD,cAAc,IAAI9N,GAAG2M,YAAP,CAAoBtK,IAAIsI,QAAxB,CAAlB;AACA,iBAAKiC,SAAL,CAAeiB,YAAf;AACA,iBAAKjB,SAAL,CAAekB,WAAf;AACA,gBAAIlJ,WAAWvC,IAAIuC,QAAJ,GAAevC,IAAIuC,QAAnB,GAA8B,KAAK5D,YAAL,GAAoB,CAApB,GAAwB,KAAK,KAAKA,YAAlC,GAAiD,EAA9F;AACA,gBAAI+M,YAAY,IAAI/N,GAAG2E,QAAP,CAAgBtC,IAAIgL,IAApB,EAA0B,OAA1B,EAAmCzI,QAAnC,CAAhB;AACAmJ,sBAAUlJ,QAAV,CAAmBxC,IAAI2L,SAAvB;AACA,gBAAIC,WAAW,IAAIjO,GAAGkO,cAAP,CAAsBL,YAAtB,EAAoCC,WAApC,EAAiDnI,QAAjD,EAA2D,IAA3D,CAAf;AACAoI,sBAAU3K,WAAV,CAAsBpD,GAAGmD,CAAH,CAAK8K,SAASlM,KAAT,GAAiB,CAAtB,EAAyBkM,SAASjM,MAAT,GAAkB,CAA3C,CAAtB;AACAiM,qBAAS3L,QAAT,CAAkByL,SAAlB;AACA,mBAAOE,QAAP;AACH,SAtEuB;AAuExBrB,mBAAW,mBAAUuB,QAAV,EAAoB;AAC3B,gBAAI,KAAKnN,YAAL,GAAoB,CAAxB,EAA2B;AACvBmN,yBAASC,cAAT,CAAwBpO,GAAGwN,IAAH,CAAQ,KAAKxM,YAAL,GAAoBmN,SAASpM,KAArC,EAA4C,KAAKf,YAAL,GAAoBmN,SAASnM,MAAzE,CAAxB;AACH;AACJ,SA3EuB;AA4ExB+K,0BAAkB,4BAAY;AAC1B,gBAAI7L,SAASlB,GAAGwK,MAAH,CAAUjJ,YAAvB;AACA,gBAAIL,OAAOuJ,UAAP,CAAkB9E,QAAtB,EAAgC;AAC5B,oBAAIzE,OAAO0E,MAAX,EAAmB;AACf1E,2BAAOuJ,UAAP,CAAkB9E,QAAlB,CAA2B8C,IAA3B,CAAgCvH,OAAO0E,MAAvC,EAA+C,IAA/C;AACH,iBAFD,MAEO;AACH1E,2BAAOuJ,UAAP,CAAkB9E,QAAlB,CAA2B,IAA3B;AACH;AACJ;AACD,iBAAKoC,gBAAL;AACH,SAtFuB;AAuFxBkF,yBAAiB,2BAAY;AACzB,gBAAI/L,SAASlB,GAAGwK,MAAH,CAAUjJ,YAAvB;AACA,gBAAIL,OAAO0J,SAAP,CAAiBjF,QAArB,EAA+B;AAC3B,oBAAIzE,OAAO0E,MAAX,EAAmB;AACf1E,2BAAO0J,SAAP,CAAiBjF,QAAjB,CAA0B8C,IAA1B,CAA+BvH,OAAO0E,MAAtC,EAA8C,IAA9C;AACH,iBAFD,MAEO;AACH1E,2BAAO0J,SAAP,CAAiBjF,QAAjB,CAA0B,IAA1B;AACH;AACJ;AACD,iBAAKoC,gBAAL;AACH,SAjGuB;AAkGxB1G,iBAAS,mBAAY;AACjB,iBAAKF,MAAL;AACA,gBAAID,SAASlB,GAAGwK,MAAH,CAAUjJ,YAAvB;AACA,iBAAKD,QAAL;AACAJ,mBAAOG,OAAP,CAAe,IAAf;AACA,gBAAI6F,OAAO,IAAX;AACAA,iBAAKqF,cAAL,GAAsBvM,GAAGqO,aAAH,CAAiBX,MAAjB,CAAwB;AAC1CY,uBAAOtO,GAAGqO,aAAH,CAAiBE,gBADkB;AAE1CC,gCAAgB,IAF0B;AAG1CC,8BAAc,sBAAUC,KAAV,EAAiBJ,KAAjB,EAAwB;AAClC,2BAAO,IAAP;AACH;AALyC,aAAxB,CAAtB;AAOAtO,eAAG2O,YAAH,CAAgBC,WAAhB,CAA4B1H,KAAKqF,cAAjC,EAAiDrF,IAAjD;AACH,SAhHuB;AAiHxB1F,gBAAQ,kBAAY;AAChB,iBAAKL,MAAL;AACA,gBAAID,SAASlB,GAAGwK,MAAH,CAAUjJ,YAAvB;AACAL,mBAAOM,MAAP,CAAc,IAAd;AACA,iBAAKgL,iBAAL;AACAxM,eAAGwK,MAAH,CAAUqE,OAAV,GAAoB,IAApB;AACA7O,eAAG2O,YAAH,CAAgBG,cAAhB,CAA+B,KAAKvC,cAApC;AACH;AAxHuB,KAAhB,CAAZ;;AA2HAvM,OAAGwK,MAAH,CAAUqE,OAAV,GAAoB,IAApB;AACA7O,OAAGwK,MAAH,CAAUuE,YAAV,GAAyB,YAAY;AACjC,YAAI/O,GAAGwK,MAAH,CAAUqE,OAAV,IAAqB,IAAzB,EAA+B;AAC3B7O,eAAGwK,MAAH,CAAUqE,OAAV,CAAkB9G,gBAAlB;AACA/H,eAAGwK,MAAH,CAAUqE,OAAV,GAAoB,IAApB;AACH;AACJ,KALD;;AAOA7O,OAAGwK,MAAH,CAAU3H,IAAV,GAAiB,UAAU4B,IAAV,EAAgBuK,SAAhB,EAA2BC,QAA3B,EAAqC;AAClD,YAAIjP,GAAGwK,MAAH,CAAUqE,OAAV,IAAqB,IAAzB,EAA+B;AAC3B7O,eAAG+F,GAAH,CAAO,0DAAP;AACA;AACH;;AAED,YAAImJ,IAAJ;AACA,YAAI,OAAOzK,IAAP,IAAe,QAAnB,EAA6B;AACzByK,mBAAO;AACH9B,8BAAc;AACVC,0BAAM5I;AADI,iBADX;AAIHgG,4BAAY;AACR9E,8BAAUqJ;AADF,iBAJT;AAOHpE,2BAAW;AACPjF,8BAAUsJ;AADH;AAPR,aAAP;AAWH,SAZD,MAYO,IAAI,QAAOxK,IAAP,yCAAOA,IAAP,MAAe,QAAnB,EAA6B;AAChCyK,mBAAOzK,IAAP;AACH,SAFM,MAEA;AACHzE,eAAG+F,GAAH,CAAO,iBAAP;AACA;AACH;;AAED/F,WAAGwK,MAAH,CAAUqE,OAAV,GAAoB,IAAI7O,GAAGwK,MAAP,CAAc0E,IAAd,CAApB;AACA,YAAIlP,GAAG+I,QAAH,CAAYC,eAAZ,EAAJ,EAAmC;AAC/BhJ,eAAG+I,QAAH,CAAYC,eAAZ,GAA8B1G,QAA9B,CAAuCtC,GAAGwK,MAAH,CAAUqE,OAAjD,EAA0DjP,OAA1D;AACH,SAFD,MAEO;AACHI,eAAG+F,GAAH,CAAO,4CAAP;AACH;AACJ,KAhCD;AAiCA/F,OAAGwK,MAAH,CAAUvI,iBAAV,GAA8B,IAA9B;AACAjC,OAAGwK,MAAH,CAAUS,mBAAV,GAAgC,UAAUvD,MAAV,EAAkB;AAC9C1H,WAAGwK,MAAH,CAAUvI,iBAAV,GAA8ByF,MAA9B;AACH,KAFD;AAGA1H,OAAGwK,MAAH,CAAU2B,cAAV,GAA2B;AACvB9I,kBAAU,IADa;AAEvBuC,gBAAQ,IAFe;AAGvBlE,gBAAQ,IAHe;AAIvBU,oBAAY;AACRC,iBAAK;AADG,SAJW;AAOvBoI,oBAAY;AACRC,uBAAW,sCADH;AAERC,sBAAU,qCAFF;AAGR0C,kBAAM,IAHE;AAIRW,uBAAW,IAJH;AAKRpJ,sBAAU,IALF;AAMRvB,sBAAU,IANF;AAORsC,sBAAU,oBAAY;AAClB3F,mBAAG+F,GAAH,CAAO,0BAAP;AACH;AATO,SAPW;AAkBvB6E,mBAAW;AACPF,uBAAW,qCADJ;AAEPC,sBAAU,oCAFH;AAGP0C,kBAAM,IAHC;AAIPW,uBAAW,IAJJ;AAKP3K,sBAAU,IALH;AAMPuB,sBAAU,IANH;AAOPe,sBAAU,oBAAY;AAClB3F,mBAAG+F,GAAH,CAAO,yBAAP;AACH;AATM,SAlBY;AA6BvBqH,sBAAc;AACVC,kBAAM,EADI;AAEVvI,mBAAO,IAFG;AAGVyI,wBAAY,IAHF;AAIV3I,sBAAU,IAJA;AAKVvB,sBAAU;AALA,SA7BS;AAoCvBhC,iBAAS,iBAAU8N,MAAV,EAAkB;AACvBnP,eAAG+F,GAAH,CAAO,qBAAP;AACH,SAtCsB;AAuCvBvE,gBAAQ,gBAAU2N,MAAV,EAAkB;AACtBnP,eAAG+F,GAAH,CAAO,oBAAP;AACH;AAzCsB,KAA3B;AA2CA/F,OAAGwK,MAAH,CAAUjJ,YAAV,GAAyBvB,GAAGwK,MAAH,CAAU2B,cAAnC;AACAnM,OAAGwK,MAAH,CAAUpJ,SAAV,GAAsB,UAAUF,MAAV,EAAkB;AACpC,aAAKiK,SAAL,CAAejK,MAAf;AACH,KAFD;AAGAlB,OAAGwK,MAAH,CAAUW,SAAV,GAAsB,UAAUC,OAAV,EAAmB;AACrC,aAAK7J,YAAL,GAAoBvB,GAAGqL,KAAH,CAAS,KAAKc,cAAd,CAApB;AACA,YAAIjL,SAAS,KAAKK,YAAlB;AACA,YAAI6J,WAAW,IAAf,EAAqB;AACjB,gBAAIA,QAAQ/H,QAAZ,EAAsB;AAClBnC,uBAAOmC,QAAP,GAAkB+H,QAAQ/H,QAA1B;AACH;AACD,gBAAI+H,QAAQ1J,MAAZ,EAAoB;AAChBR,uBAAOQ,MAAP,GAAgB0J,QAAQ1J,MAAxB;AACH;AACD,gBAAI0J,QAAQhJ,UAAR,IAAsBgJ,QAAQhJ,UAAR,CAAmBC,GAA7C,EAAkD;AAC9CnB,uBAAOkB,UAAP,GAAoBgJ,QAAQhJ,UAA5B;AACH;AACD,gBAAIgJ,QAAQX,UAAZ,EAAwB;AACpB,oBAAI2E,cAAchE,QAAQX,UAA1B;AACA,oBAAIA,aAAavJ,OAAOuJ,UAAxB;AACAA,2BAAWC,SAAX,GAAuB0E,YAAY1E,SAAZ,GAAwB0E,YAAY1E,SAApC,GAAgDD,WAAWC,SAAlF;AACAD,2BAAWE,QAAX,GAAsByE,YAAYzE,QAAZ,GAAuByE,YAAYzE,QAAnC,GAA8CF,WAAWE,QAA/E;AACAF,2BAAW4C,IAAX,GAAkB,OAAO+B,YAAY/B,IAAnB,IAA2B,WAA3B,GAAyC+B,YAAY/B,IAArD,GAA4D5C,WAAW4C,IAAzF;AACA5C,2BAAWuD,SAAX,GAAuBoB,YAAYpB,SAAZ,GAAwBoB,YAAYpB,SAApC,GAAgDvD,WAAWuD,SAAlF;AACAvD,2BAAW7F,QAAX,GAAsBwK,YAAYxK,QAAZ,GAAuBwK,YAAYxK,QAAnC,GAA8C6F,WAAW7F,QAA/E;AACA6F,2BAAWpH,QAAX,GAAsB+L,YAAY/L,QAAZ,GAAuB+L,YAAY/L,QAAnC,GAA8CoH,WAAWpH,QAA/E;AACAoH,2BAAW9E,QAAX,GAAsByJ,YAAYzJ,QAAZ,GAAuByJ,YAAYzJ,QAAnC,GAA8C8E,WAAW9E,QAA/E;AACH;AACD,gBAAIyF,QAAQR,SAAZ,EAAuB;AACnB,oBAAIyE,aAAajE,QAAQR,SAAzB;AACA,oBAAIA,YAAY1J,OAAO0J,SAAvB;AACAA,0BAAUF,SAAV,GAAsB2E,WAAW3E,SAAX,GAAuB2E,WAAW3E,SAAlC,GAA8CE,UAAUF,SAA9E;AACAE,0BAAUD,QAAV,GAAqB0E,WAAW1E,QAAX,GAAsB0E,WAAW1E,QAAjC,GAA4CC,UAAUD,QAA3E;AACAC,0BAAUyC,IAAV,GAAiB,OAAOgC,WAAWhC,IAAlB,IAA0B,WAA1B,GAAwCgC,WAAWhC,IAAnD,GAA0DzC,UAAUyC,IAArF;AACAzC,0BAAUoD,SAAV,GAAsBqB,WAAWrB,SAAX,GAAuBqB,WAAWrB,SAAlC,GAA8CpD,UAAUoD,SAA9E;AACApD,0BAAUhG,QAAV,GAAqByK,WAAWzK,QAAX,GAAsByK,WAAWzK,QAAjC,GAA4CgG,UAAUhG,QAA3E;AACAgG,0BAAUvH,QAAV,GAAqBgM,WAAWhM,QAAX,GAAsBgM,WAAWhM,QAAjC,GAA4CuH,UAAUvH,QAA3E;AACAuH,0BAAUjF,QAAV,GAAqB0J,WAAW1J,QAAX,GAAsB0J,WAAW1J,QAAjC,GAA4CiF,UAAUjF,QAA3E;AACH;AACD,gBAAIyF,QAAQgC,YAAZ,EAA0B;AACtB,oBAAIkC,gBAAgBlE,QAAQgC,YAA5B;AACA,oBAAIA,eAAelM,OAAOkM,YAA1B;AACAA,6BAAaC,IAAb,GAAoB,OAAOiC,cAAcjC,IAArB,IAA6B,WAA7B,GAA2CiC,cAAcjC,IAAzD,GAAgED,aAAaC,IAAjG;AACAD,6BAAatI,KAAb,GAAqBwK,cAAcxK,KAAd,GAAsBwK,cAAcxK,KAApC,GAA4CsI,aAAatI,KAA9E;AACAsI,6BAAaxI,QAAb,GAAwB0K,cAAc1K,QAAd,GAAyB0K,cAAc1K,QAAvC,GAAkDwI,aAAaxI,QAAvF;AACAwI,6BAAa/J,QAAb,GAAwBiM,cAAcjM,QAAd,GAAyBiM,cAAcjM,QAAvC,GAAkD+J,aAAa/J,QAAvF;AACA+J,6BAAaG,UAAb,GAA0B+B,cAAc/B,UAAd,GAA2B+B,cAAc/B,UAAzC,GAAsDH,aAAaG,UAA7F;AACH;AACD,gBAAInC,QAAQxF,MAAZ,EAAoB;AAChB1E,uBAAO0E,MAAP,GAAgBwF,QAAQxF,MAAxB;AACH;AACD,gBAAI,OAAOwF,QAAQ/J,OAAf,IAA0B,UAA9B,EAA0C;AACtCH,uBAAOG,OAAP,GAAiB+J,QAAQ/J,OAAzB;AACH;AACD,gBAAI,OAAO+J,QAAQ5J,MAAf,IAAyB,UAA7B,EAAyC;AACrCN,uBAAOM,MAAP,GAAgB4J,QAAQ5J,MAAxB;AACH;AACJ;;AAED,YAAI,CAACN,OAAO0J,SAAP,CAAiBoD,SAAtB,EAAiC;AAC7B9M,mBAAO0J,SAAP,CAAiBoD,SAAjB,GAA6BhO,GAAG8E,KAAH,CAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB,CAA7B;AACH;AACD,YAAI,CAAC5D,OAAOuJ,UAAP,CAAkBuD,SAAvB,EAAkC;AAC9B9M,mBAAOuJ,UAAP,CAAkBuD,SAAlB,GAA8BhO,GAAG8E,KAAH,CAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB,CAA9B;AACH;AACJ,KA7DD;;AA+DA9E,OAAGoK,mBAAH,GAAyB,YAAY;AACjCpK,WAAGwK,MAAH,CAAUuE,YAAV;AACA/O,WAAGwK,MAAH,CAAUqE,OAAV,GAAoB,IAAI7O,GAAGwK,MAAP,CAAcxK,GAAGoK,mBAAH,CAAuBlC,OAArC,CAApB;AACA,eAAOlI,GAAGwK,MAAH,CAAUqE,OAAjB;AACH,KAJD;AAKA7O,OAAGoK,mBAAH,CAAuBlC,OAAvB,GAAiC;AAC7BqH,sBAAc,EADe;AAE7BC,oBAAY,EAFiB;AAG7BC,qBAAa;AAHgB,KAAjC;AAKAzP,OAAGoK,mBAAH,CAAuBC,KAAvB,GAA+B,UAAUqF,IAAV,EAAgBjL,IAAhB,EAAsBuK,SAAtB,EAAiCC,QAAjC,EAA2C;AACtE,YAAIU,gBAAgB3P,GAAGoK,mBAAH,EAApB;AACA,YAAIlJ,MAAJ;AACA,gBAAQwO,IAAR;AACI,iBAAK,aAAL;AACA;AACIxO,6BAASlB,GAAGoK,mBAAH,CAAuBlC,OAAvB,CAA+BqH,YAAxC;AACA;AACH;AACD,iBAAK,cAAL;AACA;AACIrO,6BAASlB,GAAGoK,mBAAH,CAAuBlC,OAAvB,CAA+BsH,UAAxC;AACA;AACH;AACD,iBAAK,YAAL;AACA;AACItO,6BAASlB,GAAGoK,mBAAH,CAAuBlC,OAAvB,CAA+BuH,WAAxC;AACA;AACH;AACD;AACA;AACIzP,uBAAG+F,GAAH,CAAO,mBAAP;AACA;AACH;AApBL;AAsBA,YAAI,CAAC4J,cAAcC,SAAd,EAAL,EAAgC;;AAE5B1O,mBAAOuJ,UAAP,GAAoBvJ,OAAOuJ,UAAP,IAAqB,EAAzC;AACAvJ,mBAAOuJ,UAAP,CAAkB9E,QAAlB,GAA6B,YAAY;AACrC,oBAAIqJ,SAAJ,EACIA;AACP,aAHD;;AAKA9N,mBAAO0J,SAAP,GAAmB1J,OAAO0J,SAAP,IAAoB,EAAvC;AACA1J,mBAAO0J,SAAP,CAAiBjF,QAAjB,GAA4B,YAAY;AACpC,oBAAIsJ,QAAJ,EACIA;AACP,aAHD;;AAKA/N,mBAAOkM,YAAP,GAAsBlM,OAAOkM,YAAP,IAAuB,EAA7C;AACA,gBAAI,OAAOlM,OAAOkM,YAAP,CAAoBC,IAA3B,IAAmC,WAAvC,EAAoD;AAChDnM,uBAAOkM,YAAP,CAAoBC,IAApB,GAA2B5I,IAA3B;AACH;;AAEDkL,0BAAcvO,SAAd,CAAwBF,MAAxB;AACA,gBAAIlB,GAAG+I,QAAH,CAAYC,eAAZ,EAAJ,EAAmC;AAC/BhJ,mBAAG+I,QAAH,CAAYC,eAAZ,GAA8B1G,QAA9B,CAAuCqN,aAAvC,EAAsD/P,OAAtD;AACH,aAFD,MAEO;AACHI,mBAAG+F,GAAH,CAAO,4CAAP;AACH;AACJ;AACJ,KAnDD;;AAqDA/F,OAAGoK,mBAAH,CAAuByF,UAAvB,GAAoC,UAAUC,GAAV,EAAe5O,MAAf,EAAuB;AACvD,YAAI4O,OAAO5O,MAAX,EAAmB;AACf,oBAAQ4O,GAAR;AACI,qBAAK,aAAL;AACA;AACI9P,2BAAGoK,mBAAH,CAAuBlC,OAAvB,CAA+BqH,YAA/B,GAA8CrO,MAA9C;AACA;AACH;AACD,qBAAK,cAAL;AACA;AACIlB,2BAAGoK,mBAAH,CAAuBlC,OAAvB,CAA+BsH,UAA/B,GAA4CtO,MAA5C;AACA;AACH;AACD,qBAAK,YAAL;AACA;AACIlB,2BAAGoK,mBAAH,CAAuBlC,OAAvB,CAA+BuH,WAA/B,GAA6CvO,MAA7C;AACA;AACH;AAfL;AAiBH;AACJ,KApBD;;AAsBAlB,OAAGmI,OAAH,GAAanI,GAAGmI,OAAH,IAAc,EAA3B;;AAEAnI,OAAGmI,OAAH,CAAW4H,SAAX,GAAuB,UAAUC,SAAV,EAAqB9O,MAArB,EAA6B;AAChD,YAAIA,MAAJ,EAAY;AACR,oBAAQ8O,SAAR;AACI,qBAAK,sBAAL;AACA;AACIhQ,2BAAGoK,mBAAH,CAAuByF,UAAvB,CAAkC,aAAlC,EAAiD3O,MAAjD;AACA;AACH;AACD,qBAAK,uBAAL;AACA;AACIlB,2BAAGoK,mBAAH,CAAuByF,UAAvB,CAAkC,cAAlC,EAAkD3O,MAAlD;AACA;AACH;AACD,qBAAK,qBAAL;AACA;AACIlB,2BAAGoK,mBAAH,CAAuByF,UAAvB,CAAkC,YAAlC,EAAgD3O,MAAhD;AACA;AACH;AACD;AACA;AACIlB,2BAAG+F,GAAH,CAAO,iDAAP;AACH;AAnBL;AAqBH,SAtBD,MAsBO;AACH/F,eAAG+F,GAAH,CAAO,yCAAP;AACH;AACJ,KA1BD;;AA4BA;;;;AAIA/F,OAAGoJ,OAAH,GAAapJ,GAAGoJ,OAAH,IAAc,EAA3B;AACApJ,OAAGoJ,OAAH,CAAWsG,IAAX,GAAkB;AACdO,oBAAY,CAAC,CADC;AAEdC,gBAAQ,CAFM;AAGdC,cAAM;AAHQ,KAAlB;AAKAnQ,OAAGoJ,OAAH,CAAWC,aAAX,GAA2B;AACvBC,kBAAU,CADa;AAEvBC,eAAO;AAFgB,KAA3B;AAIAvJ,OAAGmI,OAAH,CAAWiB,OAAX,GAAqBpJ,GAAGoJ,OAAxB;AAEC,CAr7BD;;AAu7BApJ,GAAGoQ,WAAH,CAAeC,QAAf,GAA0BrQ,GAAGoQ,WAAH,CAAejK,OAAzC;AACAnG,GAAGoQ,WAAH,CAAejK,OAAf,GAAyB,UAAUmK,GAAV,EAAeC,EAAf,EAAmB3K,MAAnB,EAA2B;AAChD;AACA,QAAI4K,WAAYF,IAAI,CAAJ,KAAUA,IAAI,CAAJ,EAAO7J,OAAP,CAAe,GAAf,MAAwB,CAAC,CAAnD;AACA,QAAI+J,QAAJ,EAAc;AACV,YAAIF,IAAI7J,OAAJ,CAAY,MAAZ,MAAwB,CAAC,CAA7B,EAAgC;AAC5B6J,gBAAIG,MAAJ,CAAW,CAAX,EAAc,CAAd,EAAiB,MAAjB;AACH;AACDzQ,WAAGC,WAAH,CAAekG,OAAf,CAAuBmK,GAAvB,EAA4BC,EAA5B,EAAgC3K,MAAhC;AACH,KALD,MAMK;AACD5F,WAAGoQ,WAAH,CAAeC,QAAf,CAAwBC,GAAxB,EAA6BC,EAA7B,EAAiC3K,MAAjC;AACH;AACJ,CAZD","file":"CCLoaderLayer.js","sourceRoot":"../../../../../../../assets/frameworks/cocos2d-html5/extensions/runtime","sourcesContent":["/****************************************************************************\n Copyright (c) 2014-2015 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n(function () {\n\nvar INT_MAX = Number.MAX_VALUE;\nvar GROUP_JSON_PATH = \"group.json\";\n\ncc.LoaderLayer = cc.Layer.extend({\n    _backgroundSprite: null,\n    _progressBackgroundSprite: null,\n    _progressBarSprite: null,\n    _logoSprite: null,\n    _titleSprite: null,\n    _groupname: null,\n    _callback: null,\n    _selector: null,\n    _preloadCount: 0,\n    _isPreloadFromFailed: false,\n    _progressOriginalWidth: 0,\n    _isLandScape: false,\n    _scaleFactor: null,\n\n    ctor: function (config) {\n        this._super();\n        if (config) {\n            cc.LoaderLayer.setConfig(config);\n        }\n    },\n    onEnter: function () {\n        this._super();\n        this.initView();\n        var config = cc.LoaderLayer._finalConfig;\n        if (config.onEnter) {\n            config.onEnter(this);\n        }\n    },\n    onExit: function () {\n        this._super();\n        var config = cc.LoaderLayer._finalConfig;\n        if (config.logo.action) {\n            config.logo.action.release();\n        }\n        if(config.title.action){\n            config.title.action.release();\n        }\n        if (config.onExit) {\n            config.onExit(this);\n        }\n    },\n    initView: function () {\n        var config = cc.LoaderLayer._finalConfig;\n        this._contentLayer = new cc.Layer();\n        this._isLandScape = cc.winSize.width > cc.winSize.height;\n        this._scaleFactor = !cc.LoaderLayer._useDefaultSource ? 1 : cc.winSize.width > cc.winSize.height ? cc.winSize.width / 720 : cc.winSize.width / 480;\n\n        //background\n        this.backgroundSprite = new cc.Sprite(config.background.res);\n        this.addChild(this.backgroundSprite);\n        this.backgroundSprite.x = 0, this.backgroundSprite.y = 0, this.backgroundSprite.anchorX = 0, this.backgroundSprite.anchorY = 0;\n        if (cc.LoaderLayer._useDefaultSource) {\n            this.backgroundSprite.scaleX = cc.winSize.width / this.backgroundSprite.width;\n            this.backgroundSprite.scaleY = cc.winSize.height / this.backgroundSprite.height;\n        }\n\n        //title\n        if (config.title.show) {\n            this.titleSprite = new cc.Sprite(config.title.res);\n            var defaultTitlePosition = cc.pAdd(cc.visibleRect.center, cc.p(0, this._scaleFactor < 1 ? 0 : this._isLandScape ? -80 : 30));\n            this.titleSprite.setPosition(config.title.position ? config.title.position : defaultTitlePosition);\n            this._contentLayer.addChild(this.titleSprite);\n            if (config.title.action) {\n                this.titleSprite.runAction(config.title.action);\n            }\n        }\n\n        //logo\n        if (config.logo.show) {\n            this.logoSprite = new cc.Sprite(config.logo.res);\n            var defaultLogoPosition = cc.pAdd(cc.visibleRect.top, cc.p(0, this._scaleFactor < 1 ? 0 : -this.logoSprite.height / 2 - (this._isLandScape ? 56 : 76)));\n            this.logoSprite.setPosition(config.logo.position ? config.logo.position : defaultLogoPosition);\n            this._contentLayer.addChild(this.logoSprite);\n            if (config.logo.action) {\n                this.logoSprite.runAction(config.logo.action);\n            }\n        }\n\n        //progressbar\n        if (config.progressBar.show) {\n            this.progressBarSprite = new cc.Sprite(config.progressBar.res);\n            this._progressOriginalWidth = this.progressBarSprite.width;\n            this.progressBackgroundSprite = new cc.Sprite(config.progressBar.barBackgroundRes);\n            this.progressBarSprite.anchorX = 0;\n            this.progressBarSprite.anchorY = 0;\n            if (cc.LoaderLayer._isDefaultProgress) {\n                this._barPoint = new cc.Sprite(config.progressBar.barPoint);\n                this.progressBarSprite.addChild(this._barPoint);\n            }\n            if (config.progressBar.barBackgroundRes == null) {\n                this.progressBackgroundSprite.setTextureRect(cc.rect(0, 0, this.progressBarSprite.width, this.progressBarSprite.height));\n            }\n            if (config.progressBar.offset == null) {\n                var deltaProgressWithX = (this.progressBackgroundSprite.width - this.progressBarSprite.width) / 2;\n                var deltaProgressWithY = (this.progressBackgroundSprite.height - this.progressBarSprite.height) / 2;\n                config.progressBar.offset = cc.p(deltaProgressWithX, deltaProgressWithY);\n            }\n            this.progressBarSprite.setPosition(config.progressBar.offset);\n            this.progressBackgroundSprite.addChild(this.progressBarSprite);\n            var defaultProgressPosition = cc.pAdd(cc.visibleRect.bottom, cc.p(0, this.progressBarSprite.height / 2 + this._isLandScape ? 60 : 80));\n            this.progressBackgroundSprite.setPosition(config.progressBar.position ? config.progressBar.position : defaultProgressPosition);\n            this._contentLayer.addChild(this.progressBackgroundSprite);\n            this._setProgress(0);\n        }\n\n        //tips\n        if (config.tips.show) {\n            this.tipsLabel = new cc.LabelTTF(\"100%\", \"Arial\", config.tips.fontSize);\n            this.tipsLabel.setColor(config.tips.color ? config.tips.color : cc.color(255, 255, 255));\n            this.tipsLabel.setPosition(config.tips.position ? config.tips.position : this.progressBackgroundSprite ? cc.p(this.progressBackgroundSprite.x, this.progressBackgroundSprite.y + this.progressBackgroundSprite.height / 2 + 20) : cc.pAdd(cc.visibleRect.bottom, cc.p(0, 100)));\n            this._contentLayer.addChild(this.tipsLabel);\n        }\n        this.addChild(this._contentLayer);\n        if (this._scaleFactor < 1) {\n            this._contentLayer.setScale(this._scaleFactor);\n            this._contentLayer.setPosition(cc.pAdd(this._contentLayer.getPosition(), cc.p(0, -50)));\n        }\n\n    },\n    _setProgress: function (percent) {\n        if (this.progressBarSprite) {\n            percent < 1 ? percent : 1;\n            var width = percent * this._progressOriginalWidth;\n            this.progressBarSprite.setTextureRect(cc.rect(0, 0, width, this.progressBarSprite.height));\n            if (cc.LoaderLayer._isDefaultProgress) {\n                this._barPoint.setPosition(cc.p(this.progressBarSprite.width, this.progressBarSprite.height / 2));\n            }\n        }\n    },\n    setTipsString: function (str) {\n        if (this.tipsLabel != null) {\n            this.tipsLabel.setString(str);\n        }\n    },\n    getProgressBar: function () {\n        return this.progressBarSprite;\n    },\n    getTipsLabel: function () {\n        return this.tipsLabel;\n    },\n    getLogoSprite: function () {\n        return this.logoSprite;\n    },\n    getTitleSprite: function () {\n        return this.titleSprite;\n    },\n    updateGroup: function (groupname, callback, target) {\n        this._groupname = groupname;\n        this._callback = callback;\n        this._selector = target;\n    },\n    _resetLoadingLabel: function () {\n        this.setTipsString(\"\");\n        this._setProgress(0);\n    },\n    _preloadSource: function () {\n        cc.log(\"cc.LoaderLayer is preloading resource group: \" + this._groupname);\n        this._resetLoadingLabel();\n        if (cc.sys.isNative) {\n            cc.Loader.preload(this._groupname, this._preload_native, this);\n        } else {\n            this._preload_html5();\n        }\n    },\n    _preload_html5: function () {\n        var res = \"\";\n        var groupIndex = [];\n        var config = cc.LoaderLayer._finalConfig;\n        var groups = cc.LoaderLayer.groups;\n        if (cc.isString(this._groupname)) {\n            if (this._groupname.indexOf(\".\") != -1) {\n                res = [this._groupname];\n            } else {\n                res = groups[this._groupname];\n            }\n        } else if (cc.isArray(this._groupname)) {\n            res = [];\n            for (var i = 0; i < this._groupname.length; i++) {\n                var group = groups[this._groupname[i]];\n                var files = group && group.files;\n                var preCount = i > 0 ? groupIndex[i - 1] : 0;\n                groupIndex.push(preCount + files ? files.length : 0);\n                res = res.concat(files);\n            }\n        }\n        var self = this;\n        //var progressFunction = self.config.progressCallback ? self.config.progressCallback : null;\n        cc.loader.load(res, function (result, count, loadedCount) {\n            var checkGroupName = function (loadedCount) {\n                for (var i = 0; i < groupIndex.length; i++) {\n                    if (groupIndex[i] >= loadedCount) {\n                        return self._groupname[i];\n                    }\n                }\n            };\n            var groupName = checkGroupName(loadedCount);\n            var status = {\n                groupName: groupName,\n                isCompleted: false,\n                percent: (loadedCount / count * 100) | 0,//(float),\n                stage: 1, //(1 downloadï¼Œ2 unzip)\n                isFailed: false\n            }\n            if (status.percent != 0) {\n                self._setProgress(status.percent / 100);\n            }\n            config.tips.tipsProgress(status, self);\n        }, function () {\n            self.removeFromParent();\n            self._preloadCount--;\n            if (self._callback) {\n                if (self._selector) {\n                    self._callback(self._selector, true);\n                } else {\n                    self._callback(true);\n                }\n            }\n        });\n    },\n    _preload_native: function (status) {\n        cc.log(JSON.stringify(status));\n        var config = cc.LoaderLayer._finalConfig;\n        if (status.percent) {\n            this._setProgress(status.percent / 100);\n        }\n        if (config.tips.tipsProgress) {\n            config.tips.tipsProgress(status, this);\n        }\n        if (status.isCompleted || status.isFailed) {\n            this._preloadCount--;\n\n            if (status.isCompleted) {\n                cc.log(\"preload finish!\");\n                this._isPreloadFromFailed = false;\n            }\n            if (status.isFailed) {\n                cc.log(\"preload failed!\");\n                this._isPreloadFromFailed = true;\n            }\n\n            // Remove loading layer from scene after loading was done.\n            if (this._preloadCount == 0 && !this._isPreloadFromFailed) {\n                this.removeFromParent();\n                if (cc.LoaderLayer._useDefaultSource) {\n                    var _config = cc.runtime.config.design_resolution || {width: 480, height: 720, policy: \"SHOW_ALL\"};\n                    cc.view.setDesignResolutionSize(_config.width, _config.height, cc.ResolutionPolicy[_config.policy]);\n                }\n            }\n\n            // Callback must be invoked after removeFromParent.\n            this._callback.call(this._target, status);\n        }\n    },\n    _addToScene: function () {\n        if (this._preloadCount == 0 && !this._isPreloadFromFailed) {\n            if (cc.sys.isNative && cc.LoaderLayer._useDefaultSource) {\n                var config = cc.runtime.config.design_resolution;\n                var isLandscape = false;\n                var isLargeThanResource = false;\n                if (config) {\n                    var orientation = cc.runtime.config.orientation;\n                    cc.log(\"_addToScene orientation is \" + orientation);\n                    if (orientation == \"landscape\") {\n                        isLandscape = true;\n                        isLargeThanResource = config.width > 720 || config.height > 480;\n                    } else {\n                        isLargeThanResource = config.width > 480 || config.height > 720;\n                    }\n                }\n                cc.log(\"isLargeThanResource is \" + isLargeThanResource);\n                cc.view.setDesignResolutionSize(isLargeThanResource ? config.width : isLandscape ? 720 : 480, isLargeThanResource ? config.height : isLandscape ? 480 : 720, cc.ResolutionPolicy[\"FIXED_HEIGHT\"]);\n            }\n            cc.director.getRunningScene().addChild(this, INT_MAX - 1);\n        }\n        this._preloadCount++;\n    }\n});\ncc.LoaderLayer._config = {//default setting for loaderlayer\n    background: {\n        res: \"res_engine/preload_bg.jpg\"\n    },\n    title: {\n        show: true,\n        res: \"res_engine/preload_title.png\",\n        position: null,\n        action: null\n    },\n    logo: {\n        res: \"res_engine/preload_logo.png\",\n        show: true,\n        position: null\n    },\n    progressBar: {\n        show: true,\n        res: \"res_engine/progress_bar.png\",\n        offset: null,\n        position: null,\n        barBackgroundRes: \"res_engine/progress_bg.png\",\n        barPoint: \"res_engine/progress_light.png\",\n        barShadow: \"res_engine/shadow.png\"\n    },\n    tips: {\n        show: true,\n        fontSize: 22,\n        position: null,\n        color: null,\n        tipsProgress: function (status, loaderlayer) {\n            if(loaderlayer.getTipsLabel()){\n                var statusStr = \"æ­£åœ¨\";\n                if (status.stage == cc.network.preloadstatus.DOWNLOAD) {\n                    statusStr += \"ä¸‹è½½\";\n                } else if (status.stage == cc.network.preloadstatus.UNZIP) {\n                    statusStr += \"è§£åŽ‹\";\n                }\n                if (status.groupName) {\n                    statusStr += status.groupName;\n                }\n                statusStr += \"è¿›åº¦:\" + status.percent.toFixed(2) + \"%\";\n                loaderlayer.getTipsLabel().setString(statusStr);\n            }\n        }\n    },\n    progressCallback: function (progress) {\n\n    },\n    onEnter: function (layer) {\n        cc.log(\"LoaderLayer onEnter\");\n    },\n    onExit: function (layer) {\n        cc.log(\"LoaderLayer onExit\");\n    }\n}\n\nvar res_engine_loaded = false;\n\ncc.LoaderLayer.preload = function (groupname, callback, target) {\n    var loaderLayer = new cc.LoaderLayer();\n    var preloadCb = function (status) {\n        if (status.isFailed) {\n            var tips, conirmfunc, cancelfunc;\n            switch (status.errorCode) {\n                case \"err_no_space\":\n                {\n                    tips = \"ç©ºé—´ä¸è¶³ï¼Œè¯·æ¸…ç†ç£ç›˜ç©ºé—´\";\n                    conirmfunc = function () {\n                        callPreload();\n                    };\n                    cancelfunc = function () {\n                        cc.director.end();\n                    };\n                    break;\n                }\n                case \"err_verify\":\n                {\n                    tips = \"æ ¡éªŒå¤±è´¥ï¼Œæ˜¯å¦é‡æ–°ä¸‹è½½ï¼Ÿ\";\n                    conirmfunc = function () {\n                        callPreload();\n                    }\n                    cancelfunc = function () {\n                        cc.director.end();\n                    }\n                    break;\n                }\n                case \"err_network\":\n                {\n                    tips = \"ç½‘ç»œå¼‚å¸¸æ˜¯å¦é‡æ–°ä¸‹è½½\";\n                    conirmfunc = function () {\n                        callPreload();\n                    }\n                    cancelfunc = function () {\n                        cc.director.end();\n                    }\n                    break;\n                }\n                default :\n                {\n                    conirmfunc = cancelfunc = function () {\n\n                    }\n                }\n            }\n            cc._NetworkErrorDialog._show(status.errorCode, tips, conirmfunc, cancelfunc);\n        } else {\n            if (callback) {\n                if (target) {\n                    callback.call(target, !status.isFailed);\n                } else {\n                    callback(!status.isFailed)\n                }\n            }\n        }\n    }\n    var callPreload = function () {\n        loaderLayer.updateGroup(groupname, preloadCb, target);\n        loaderLayer._addToScene();\n        loaderLayer._preloadSource();\n    };\n\n    if (res_engine_loaded) {\n        callPreload();\n        return;\n    }\n\n    if (!cc.director.getRunningScene()) {\n        cc.director.runScene(new cc.Scene());\n    }\n\n    // Res engine not loaded, load them\n    cc.loader.load([\n            GROUP_JSON_PATH,\n            cc.LoaderLayer._finalConfig.background.res,\n            cc.LoaderLayer._finalConfig.title.res,\n            cc.LoaderLayer._finalConfig.logo.res,\n            cc.LoaderLayer._finalConfig.progressBar.res,\n            cc.LoaderLayer._finalConfig.progressBar.barBackgroundRes,\n            cc.LoaderLayer._finalConfig.progressBar.barPoint,\n            cc.LoaderLayer._finalConfig.progressBar.barShadow,\n            cc.Dialog._finalConfig.background.res,\n            cc.Dialog._finalConfig.confirmBtn.normalRes,\n            cc.Dialog._finalConfig.confirmBtn.pressRes,\n            cc.Dialog._finalConfig.cancelBtn.normalRes,\n            cc.Dialog._finalConfig.cancelBtn.pressRes\n        ],\n        function (result, count, loadedCount) {\n            var percent = (loadedCount / count * 100) | 0;\n            percent = Math.min(percent, 100);\n            cc.log(\"Preloading engine resources... \" + percent + \"%\");\n        }, function () {\n            var groups = cc.loader.getRes(GROUP_JSON_PATH);\n            if (groups) {\n                cc.LoaderLayer.groups = groups;\n            }\n            else {\n                cc.warn(\"Group versions haven't been loaded, you can also set group data with 'cc.LoaderLayer.groups'\");\n            }\n            res_engine_loaded = true;\n            callPreload();\n        });\n};\n\ncc.LoaderLayer._useDefaultSource = true;\ncc.LoaderLayer._isDefaultProgress = true;\ncc.LoaderLayer._finalConfig = cc.LoaderLayer._config;\ncc.LoaderLayer.groups = {};\ncc.LoaderLayer.setUseDefaultSource = function (status) {\n    cc.LoaderLayer._useDefaultSource = status;\n};\ncc.LoaderLayer.setConfig = function (config) {\n    if(config.title && config.title.action){\n        config.title.action.retain();\n    }\n    if(config.logo && config.logo.action){\n        config.logo.action.retain();\n    }\n    this._initData(config);\n};\ncc.LoaderLayer._initData = function (uConfig) {\n    this._finalConfig = cc.clone(this._config);\n    var config = this._finalConfig;\n    if (uConfig != null) {\n        if (uConfig.background && uConfig.background.res) {\n            config.background.res = uConfig.background.res;\n        }\n        if (uConfig.title) {\n            var uTitle = uConfig.title;\n            var title = config.title;\n            title.show = typeof uTitle.show != \"undefined\" ? uTitle.show : title.show;\n            title.res = uTitle.res ? uTitle.res : title.res;\n            title.position = uTitle.position ? uTitle.position : title.position;\n            title.action = uTitle.action ? uTitle.action : title.action;\n            if (title.action) {\n                title.action = uTitle.action;\n                title.action.retain();\n            }\n        }\n        if (uConfig.logo) {\n            var uLogo = uConfig.logo;\n            var logo = config.logo;\n            logo.show = typeof uLogo.show != \"undefined\" ? uLogo.show : logo.show;\n            logo.res = uLogo.res ? uLogo.res : logo.res;\n            logo.position = uLogo.position ? uLogo.position : logo.position;\n            if (typeof uLogo.action != \"undefined\") {\n                logo.action = uLogo.action;\n                if (logo.action) {\n                    logo.action.retain();\n                }\n            }\n        }\n        if (uConfig.progressBar) {\n            var uProgress = uConfig.progressBar;\n            var progress = config.progressBar;\n            progress.show = typeof uProgress.show != \"undefined\" ? uProgress.show : progress.show;\n            if (uProgress.res) {\n                progress.res = uProgress.res;\n                this._isDefaultProgress = false;\n            }\n            progress.offset = uProgress.offset ? uProgress.offset : progress.offset;\n            progress.position = uProgress.position ? uProgress.position : progress.position;\n            progress.barBackgroundRes = uProgress.barBackgroundRes ? uProgress.barBackgroundRes : progress.barBackgroundRes;\n        }\n        if (uConfig.tips) {\n            var uTips = uConfig.tips;\n            var tips = config.tips;\n            tips.show = typeof uTips.show != \"undefined\" ? uTips.show : tips.show;\n            tips.res = uTips.res ? uTips.res : tips.res;\n            tips.offset = uTips.offset ? uTips.offset : tips.offset;\n            tips.fontSize = uTips.fontSize ? uTips.fontSize : tips.fontSize;\n            tips.position = uTips.position ? uTips.position : tips.position;\n            tips.color = uTips.color ? uTips.color : tips.color;\n            if (uConfig.tips.tipsProgress && typeof uConfig.tips.tipsProgress == \"function\") {\n                tips.tipsProgress = uConfig.tips.tipsProgress;\n            }\n        }\n        if (typeof uConfig.onEnter == \"function\") {\n            config.onEnter = uConfig.onEnter;\n        }\n        if (typeof uConfig.onExit == \"function\") {\n            config.onExit = uConfig.onExit;\n        }\n    }\n\n    if (typeof config.logo.action == \"undefined\" && this._useDefaultSource) {\n        config.logo.action = cc.sequence(\n            cc.spawn(cc.moveBy(0.4, cc.p(0, 40)).easing(cc.easeIn(0.5)), cc.scaleTo(0.4, 0.95, 1.05).easing(cc.easeIn(0.5))),\n            cc.delayTime(0.08),\n            cc.spawn(cc.moveBy(0.4, cc.p(0, -40)).easing(cc.easeOut(0.5)), cc.scaleTo(0.4, 1.05, 0.95).easing(cc.easeOut(0.5)))\n        ).repeatForever();\n        config.logo.action.retain();\n    }\n    if (!config.tips.color) {\n        config.tips.color = cc.color(255, 255, 255);\n    }\n};\n\ncc.Dialog = cc.Layer.extend({\n    _defaultConfig: null,\n    backgroundSprite: null,\n    _menuItemConfirm: null,\n    _menuItemCancel: null,\n    _messageLabel: null,\n    _eventListener: null,\n    _scaleFactor: null,\n\n    ctor: function (config) {\n        this._super();\n        this.setConfig(config);\n    },\n    setConfig: function (config) {\n        this.removeAllChildren();\n        if (config) {\n            cc.Dialog.setConfig(config);\n        }\n    },\n    initView: function () {\n        var useDefaultSource = cc.Dialog._useDefaultSource;\n        var winSize = cc.director.getWinSize();\n        this._scaleFactor = !useDefaultSource ? 1 : winSize.width > winSize.height ? winSize.width / 720 : winSize.width / 480;\n        var config = cc.Dialog._finalConfig;\n\n        //bg\n        this.backgroundSprite = new cc.Scale9Sprite(config.background.res);\n        this._setScale(this.backgroundSprite);\n        if (this._scaleFactor < 1) {\n            this.backgroundSprite.setScale(this._scaleFactor);\n        }\n        this.backgroundSprite.setPosition(config.position ? config.position : cc.p(winSize.width / 2, winSize.height / 2));\n\n        //menu\n        this.menuItemConfirm = this._createMenuItemSprite(config.confirmBtn, this._confirmCallback);\n        this.menuItemCancel = this._createMenuItemSprite(config.cancelBtn, this._cancelCallback);\n        this.menuItemCancel.setPosition(config.cancelBtn.position ? config.cancelBtn.position : cc.p(this.backgroundSprite.width / 2 - this.menuItemCancel.width / 2 - 20, this.menuItemCancel.height + 20));\n        this.menuItemConfirm.setPosition(config.confirmBtn.position ? config.confirmBtn.position : cc.p(this.backgroundSprite.width / 2 + this.menuItemConfirm.width / 2 + 20, this.menuItemConfirm.height + 20));\n        var menu = new cc.Menu(this.menuItemConfirm, this.menuItemCancel);\n        menu.setPosition(cc.p(0, 0));\n        this.backgroundSprite.addChild(menu);\n\n        //message\n        var fontSize = config.messageLabel.fontSize ? config.messageLabel.fontSize : this._scaleFactor > 1 ? 16 * this._scaleFactor : 16;\n        this.messageLabel = new cc.LabelTTF(config.messageLabel.text, \"Arial\", fontSize);\n        this.messageLabel.setDimensions(config.messageLabel.dimensions ? config.messageLabel.dimensions : cc.size(this.backgroundSprite.width - 30, this.backgroundSprite.height - this.menuItemConfirm.y - 10));\n        this.messageLabel.setColor(config.messageLabel.color ? config.messageLabel.color : cc.color(255, 255, 255));\n        this.messageLabel.setPosition(config.messageLabel.position ? config.messageLabel.position : cc.p(this.backgroundSprite.width / 2, this.backgroundSprite.height - this.messageLabel.height / 2 - 20));\n        this.backgroundSprite.addChild(this.messageLabel);\n        if (!config.action) {\n            var action = cc.sequence(cc.EaseIn.create(cc.scaleTo(0.1, this.backgroundSprite.scale + 0.02), 0.4), cc.EaseOut.create(cc.scaleTo(0.1, this.backgroundSprite.scale), 0.3));\n            this.backgroundSprite.runAction(action);\n        } else {\n            this.backgroundSprite.runAction(config.action);\n        }\n        this.addChild(this.backgroundSprite);\n\n    },\n    _createMenuItemSprite: function (res, callback) {\n        var spriteNormal = new cc.Scale9Sprite(res.normalRes);\n        var spritePress = new cc.Scale9Sprite(res.pressRes);\n        this._setScale(spriteNormal);\n        this._setScale(spritePress);\n        var fontSize = res.fontSize ? res.fontSize : this._scaleFactor > 1 ? 16 * this._scaleFactor : 16;\n        var menuLabel = new cc.LabelTTF(res.text, \"Arial\", fontSize);\n        menuLabel.setColor(res.textColor);\n        var menuItem = new cc.MenuItemSprite(spriteNormal, spritePress, callback, this);\n        menuLabel.setPosition(cc.p(menuItem.width / 2, menuItem.height / 2));\n        menuItem.addChild(menuLabel);\n        return menuItem;\n    },\n    _setScale: function (s9Sprite) {\n        if (this._scaleFactor > 1) {\n            s9Sprite.setContentSize(cc.size(this._scaleFactor * s9Sprite.width, this._scaleFactor * s9Sprite.height));\n        }\n    },\n    _confirmCallback: function () {\n        var config = cc.Dialog._finalConfig;\n        if (config.confirmBtn.callback) {\n            if (config.target) {\n                config.confirmBtn.callback.call(config.target, this);\n            } else {\n                config.confirmBtn.callback(this);\n            }\n        }\n        this.removeFromParent();\n    },\n    _cancelCallback: function () {\n        var config = cc.Dialog._finalConfig;\n        if (config.cancelBtn.callback) {\n            if (config.target) {\n                config.cancelBtn.callback.call(config.target, this);\n            } else {\n                config.cancelBtn.callback(this);\n            }\n        }\n        this.removeFromParent();\n    },\n    onEnter: function () {\n        this._super();\n        var config = cc.Dialog._finalConfig;\n        this.initView();\n        config.onEnter(this);\n        var self = this;\n        self._eventListener = cc.EventListener.create({\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\n            swallowTouches: true,\n            onTouchBegan: function (touch, event) {\n                return true;\n            }\n        });\n        cc.eventManager.addListener(self._eventListener, self);\n    },\n    onExit: function () {\n        this._super();\n        var config = cc.Dialog._finalConfig;\n        config.onExit(this);\n        this.removeAllChildren();\n        cc.Dialog._dialog = null;\n        cc.eventManager.removeListener(this._eventListener);\n    }\n});\n\ncc.Dialog._dialog = null;\ncc.Dialog._clearDialog = function () {\n    if (cc.Dialog._dialog != null) {\n        cc.Dialog._dialog.removeFromParent();\n        cc.Dialog._dialog = null;\n    }\n}\n\ncc.Dialog.show = function (tips, confirmCb, cancelCb) {\n    if (cc.Dialog._dialog != null) {\n        cc.log(\"other dialog is on the screen,this dialog can't show now\");\n        return;\n    }\n\n    var conf;\n    if (typeof tips == \"string\") {\n        conf = {\n            messageLabel: {\n                text: tips\n            },\n            confirmBtn: {\n                callback: confirmCb\n            },\n            cancelBtn: {\n                callback: cancelCb\n            }\n        }\n    } else if (typeof tips == \"object\") {\n        conf = tips;\n    } else {\n        cc.log(\"tips is invalid\");\n        return;\n    }\n\n    cc.Dialog._dialog = new cc.Dialog(conf);\n    if (cc.director.getRunningScene()) {\n        cc.director.getRunningScene().addChild(cc.Dialog._dialog, INT_MAX);\n    } else {\n        cc.log(\"Current scene is null we can't show dialog\");\n    }\n};\ncc.Dialog._useDefaultSource = true;\ncc.Dialog.setUseDefaultSource = function (status) {\n    cc.Dialog._useDefaultSource = status;\n}\ncc.Dialog._defaultConfig = {\n    position: null,\n    target: null,\n    action: null,\n    background: {\n        res: \"res_engine/dialog_bg.png\"\n    },\n    confirmBtn: {\n        normalRes: \"res_engine/dialog_confirm_normal.png\",\n        pressRes: \"res_engine/dialog_confirm_press.png\",\n        text: \"ç¡®å®š\",\n        textColor: null,\n        fontSize: null,\n        position: null,\n        callback: function () {\n            cc.log(\"this is confirm callback\");\n        }\n    },\n    cancelBtn: {\n        normalRes: \"res_engine/dialog_cancel_normal.png\",\n        pressRes: \"res_engine/dialog_cancel_press.png\",\n        text: \"å–æ¶ˆ\",\n        textColor: null,\n        position: null,\n        fontSize: null,\n        callback: function () {\n            cc.log(\"this is cancel callback\");\n        }\n    },\n    messageLabel: {\n        text: \"\",\n        color: null,\n        dimensions: null,\n        fontSize: null,\n        position: null\n    },\n    onEnter: function (dialog) {\n        cc.log(\"dialog call onEnter\");\n    },\n    onExit: function (dialog) {\n        cc.log(\"dialog call onExit\");\n    }\n};\ncc.Dialog._finalConfig = cc.Dialog._defaultConfig;\ncc.Dialog.setConfig = function (config) {\n    this._initData(config);\n};\ncc.Dialog._initData = function (uConfig) {\n    this._finalConfig = cc.clone(this._defaultConfig);\n    var config = this._finalConfig;\n    if (uConfig != null) {\n        if (uConfig.position) {\n            config.position = uConfig.position;\n        }\n        if (uConfig.action) {\n            config.action = uConfig.action;\n        }\n        if (uConfig.background && uConfig.background.res) {\n            config.background = uConfig.background;\n        }\n        if (uConfig.confirmBtn) {\n            var uConfirmBtn = uConfig.confirmBtn;\n            var confirmBtn = config.confirmBtn;\n            confirmBtn.normalRes = uConfirmBtn.normalRes ? uConfirmBtn.normalRes : confirmBtn.normalRes;\n            confirmBtn.pressRes = uConfirmBtn.pressRes ? uConfirmBtn.pressRes : confirmBtn.pressRes;\n            confirmBtn.text = typeof uConfirmBtn.text != \"undefined\" ? uConfirmBtn.text : confirmBtn.text;\n            confirmBtn.textColor = uConfirmBtn.textColor ? uConfirmBtn.textColor : confirmBtn.textColor;\n            confirmBtn.fontSize = uConfirmBtn.fontSize ? uConfirmBtn.fontSize : confirmBtn.fontSize;\n            confirmBtn.position = uConfirmBtn.position ? uConfirmBtn.position : confirmBtn.position;\n            confirmBtn.callback = uConfirmBtn.callback ? uConfirmBtn.callback : confirmBtn.callback;\n        }\n        if (uConfig.cancelBtn) {\n            var uCancelBtn = uConfig.cancelBtn;\n            var cancelBtn = config.cancelBtn;\n            cancelBtn.normalRes = uCancelBtn.normalRes ? uCancelBtn.normalRes : cancelBtn.normalRes;\n            cancelBtn.pressRes = uCancelBtn.pressRes ? uCancelBtn.pressRes : cancelBtn.pressRes;\n            cancelBtn.text = typeof uCancelBtn.text != \"undefined\" ? uCancelBtn.text : cancelBtn.text;\n            cancelBtn.textColor = uCancelBtn.textColor ? uCancelBtn.textColor : cancelBtn.textColor;\n            cancelBtn.fontSize = uCancelBtn.fontSize ? uCancelBtn.fontSize : cancelBtn.fontSize;\n            cancelBtn.position = uCancelBtn.position ? uCancelBtn.position : cancelBtn.position;\n            cancelBtn.callback = uCancelBtn.callback ? uCancelBtn.callback : cancelBtn.callback;\n        }\n        if (uConfig.messageLabel) {\n            var uMessageLabel = uConfig.messageLabel;\n            var messageLabel = config.messageLabel;\n            messageLabel.text = typeof uMessageLabel.text != \"undefined\" ? uMessageLabel.text : messageLabel.text;\n            messageLabel.color = uMessageLabel.color ? uMessageLabel.color : messageLabel.color;\n            messageLabel.fontSize = uMessageLabel.fontSize ? uMessageLabel.fontSize : messageLabel.fontSize;\n            messageLabel.position = uMessageLabel.position ? uMessageLabel.position : messageLabel.position;\n            messageLabel.dimensions = uMessageLabel.dimensions ? uMessageLabel.dimensions : messageLabel.dimensions;\n        }\n        if (uConfig.target) {\n            config.target = uConfig.target;\n        }\n        if (typeof uConfig.onEnter == \"function\") {\n            config.onEnter = uConfig.onEnter;\n        }\n        if (typeof uConfig.onExit == \"function\") {\n            config.onExit = uConfig.onExit;\n        }\n    }\n\n    if (!config.cancelBtn.textColor) {\n        config.cancelBtn.textColor = cc.color(255, 255, 255);\n    }\n    if (!config.confirmBtn.textColor) {\n        config.confirmBtn.textColor = cc.color(255, 255, 255);\n    }\n};\n\ncc._NetworkErrorDialog = function () {\n    cc.Dialog._clearDialog();\n    cc.Dialog._dialog = new cc.Dialog(cc._NetworkErrorDialog._config);\n    return cc.Dialog._dialog;\n}\ncc._NetworkErrorDialog._config = {\n    networkError: {},\n    spaceError: {},\n    verifyError: {}\n};\ncc._NetworkErrorDialog._show = function (type, tips, confirmCb, cancelCb) {\n    var networkDialog = cc._NetworkErrorDialog();\n    var config;\n    switch (type) {\n        case \"err_network\":\n        {\n            config = cc._NetworkErrorDialog._config.networkError;\n            break;\n        }\n        case \"err_no_space\":\n        {\n            config = cc._NetworkErrorDialog._config.spaceError;\n            break;\n        }\n        case \"err_verify\":\n        {\n            config = cc._NetworkErrorDialog._config.verifyError;\n            break;\n        }\n        default:\n        {\n            cc.log(\"type is not found\");\n            return;\n        }\n    }\n    if (!networkDialog.getParent()) {\n\n        config.confirmBtn = config.confirmBtn || {};\n        config.confirmBtn.callback = function () {\n            if (confirmCb)\n                confirmCb();\n        }\n\n        config.cancelBtn = config.cancelBtn || {};\n        config.cancelBtn.callback = function () {\n            if (cancelCb)\n                cancelCb();\n        }\n\n        config.messageLabel = config.messageLabel || {};\n        if (typeof config.messageLabel.text == \"undefined\") {\n            config.messageLabel.text = tips;\n        }\n\n        networkDialog.setConfig(config);\n        if (cc.director.getRunningScene()) {\n            cc.director.getRunningScene().addChild(networkDialog, INT_MAX);\n        } else {\n            cc.log(\"Current scene is null we can't show dialog\");\n        }\n    }\n}\n\ncc._NetworkErrorDialog._setConfig = function (key, config) {\n    if (key && config) {\n        switch (key) {\n            case \"err_network\":\n            {\n                cc._NetworkErrorDialog._config.networkError = config;\n                break;\n            }\n            case \"err_no_space\":\n            {\n                cc._NetworkErrorDialog._config.spaceError = config;\n                break;\n            }\n            case \"err_verify\":\n            {\n                cc._NetworkErrorDialog._config.verifyError = config;\n                break;\n            }\n        }\n    }\n}\n\ncc.runtime = cc.runtime || {};\n\ncc.runtime.setOption = function (promptype, config) {\n    if (config) {\n        switch (promptype) {\n            case \"network_error_dialog\":\n            {\n                cc._NetworkErrorDialog._setConfig(\"err_network\", config);\n                break;\n            }\n            case \"no_space_error_dialog\":\n            {\n                cc._NetworkErrorDialog._setConfig(\"err_no_space\", config);\n                break;\n            }\n            case \"verify_error_dialog\":\n            {\n                cc._NetworkErrorDialog._setConfig(\"err_verify\", config);\n                break;\n            }\n            default :\n            {\n                cc.log(\"promptype not found please check your promptype\");\n            }\n        }\n    } else {\n        cc.log(\"config is null please check your config\");\n    }\n}\n\n/**\n * only use in JSB get network type\n * @type {{}|*|cc.network}\n */\ncc.network = cc.network || {};\ncc.network.type = {\n    NO_NETWORK: -1,\n    MOBILE: 0,\n    WIFI: 1\n}\ncc.network.preloadstatus = {\n    DOWNLOAD: 1,\n    UNZIP: 2\n}\ncc.runtime.network = cc.network;\n\n})();\n\ncc.LoaderScene._preload = cc.LoaderScene.preload;\ncc.LoaderScene.preload = function (arr, cb, target) {\n    // No extension\n    var isGroups = (arr[0] && arr[0].indexOf('.') === -1);\n    if (isGroups) {\n        if (arr.indexOf('boot') === -1) {\n            arr.splice(0, 0, 'boot');\n        }\n        cc.LoaderLayer.preload(arr, cb, target);\n    }\n    else {\n        cc.LoaderScene._preload(arr, cb, target);\n    }\n}\n"]}