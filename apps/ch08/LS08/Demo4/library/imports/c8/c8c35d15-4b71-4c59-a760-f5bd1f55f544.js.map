{"version":3,"sources":["../../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/core/platform/assets/frameworks/cocos2d-html5/cocos2d/core/platform/CCEGLView.js"],"names":["cc","Touches","TouchesIntergerDict","DENSITYDPI_DEVICE","DENSITYDPI_HIGH","DENSITYDPI_MEDIUM","DENSITYDPI_LOW","__BrowserGetter","init","html","document","documentElement","availWidth","frame","window","innerWidth","clientWidth","availHeight","innerHeight","clientHeight","meta","adaptationType","sys","browserType","navigator","userAgent","indexOf","BROWSER_TYPE_MIUI","os","OS_IOS","BROWSER_TYPE_SAFARI","BROWSER_TYPE_CHROME","__defineGetter__","view","_targetDensityDPI","__resizeWithBrowserSize","resize","setDesignResolutionSize","_designResolutionSize","width","height","_resolutionPolicy","removeEventListener","addEventListener","_scissorRect","EGLView","Class","extend","_delegate","_frameSize","_originalDesignResolutionSize","_viewPortRect","_visibleRect","_retinaEnabled","_autoFullScreen","_devicePixelRatio","_viewName","_resizeCallback","_orientationChanging","_resizing","_scaleX","_originalScaleX","_scaleY","_originalScaleY","_isRotated","_orientation","_rpExactFit","_rpShowAll","_rpNoBorder","_rpFixedHeight","_rpFixedWidth","_initialized","_contentTranslateLeftTop","_frame","_frameZoomFactor","_isAdjustViewPort","ctor","_t","d","_strategyer","ContainerStrategy","_strategy","ContentStrategy","container","parentNode","body","size","_initFrameSize","w","_canvas","h","rect","left","top","visibleRect","ResolutionPolicy","EQUAL_TO_FRAME","EXACT_FIT","PROPORTION_TO_FRAME","SHOW_ALL","NO_BORDER","FIXED_HEIGHT","FIXED_WIDTH","isMobile","_orientationChange","_resizeEvent","prevFrameW","prevFrameH","prevRotated","containerStyle","game","style","margin","display","eventManager","dispatchCustomEvent","call","setTimeout","setTargetDensityDPI","densityDPI","_adjustViewportMeta","getTargetDensityDPI","resizeWithBrowserSize","enabled","setResizeCallback","callback","setOrientation","orientation","ORIENTATION_AUTO","designWidth","designHeight","setDocumentPixelWidth","_setViewportMeta","locFrameSize","isLandscape","ORIENTATION_LANDSCAPE","ORIENTATION_PORTRAIT","transform","transformOrigin","_adjustSizeKeepCanvasSize","metas","overwrite","vp","getElementById","head","removeChild","elems","getElementsByName","currentVP","content","key","pattern","createElement","id","name","RegExp","replace","test","substr","appendChild","_setScaleXYForRenderTexture","scaleFactor","contentScaleFactor","_resetScale","_adjustSizeToBrowser","initialize","adjustViewPort","enableRetina","isRetinaEnabled","enableAutoFullScreen","screen","autoFullScreen","isAutoFullScreenEnabled","isOpenGLReady","canvas","_renderContext","setFrameZoomFactor","zoomFactor","centerWindow","director","setProjection","getProjection","swapBuffers","setIMEKeyboardState","isOpen","setContentTranslateLeftTop","offsetLeft","offsetTop","getContentTranslateLeftTop","getCanvasSize","getFrameSize","setFrameSize","getVisibleSize","getVisibleSizeInPixel","getVisibleOrigin","p","x","y","getVisibleOriginInPixel","canSetContentScaleFactor","getResolutionPolicy","setResolutionPolicy","resolutionPolicy","_locPolicy","log","_LogInfos","EGLView_setDesignResolutionSize","policy","preApply","EGLView_setDesignResolutionSize_2","result","apply","scale","length","viewport","vb","rv","setOffset","_winSizeInPoints","postApply","winSize","_renderType","RENDER_TYPE_WEBGL","setGLDefaultValues","RENDER_TYPE_CANVAS","renderer","_allNeedDraw","getDesignResolutionSize","setRealPixelResolution","setViewPortInPoints","locFrameZoomFactor","locScaleX","locScaleY","setScissorInPoints","sx","Math","ceil","sy","sw","sh","boxArr","gl","getParameter","SCISSOR_BOX","scissor","isScissorEnabled","isEnabled","SCISSOR_TEST","getScissorRect","scaleXFactor","scaleYFactor","setViewName","viewName","getViewName","getViewPortRect","getScaleX","getScaleY","getDevicePixelRatio","convertToLocationInView","tx","ty","relatedPos","_convertMouseToLocationInView","point","_convertPointWithScale","_convertTouchesWithScale","touches","scaleX","scaleY","selTouch","selPoint","selPrePoint","i","_point","_prevPoint","_getInstance","_instance","designedResolution","_setupContainer","locCanvas","locContainer","OS_ANDROID","devicePixelRatio","min","resetCache","_fixContainer","insertBefore","firstChild","bs","overflow","contStyle","position","scrollTop","_result","_buildResult","containerW","containerH","contentW","contentH","abs","round","EqualToFrame","frameH","ProportionalToFrame","frameW","designW","designH","offx","offy","paddingLeft","paddingRight","paddingTop","paddingBottom","EqualToWindow","_super","ProportionalToWindow","OriginalContainer","ORIGINAL_CONTAINER","ExactFit","ShowAll","NoBorder","FixedHeight","FixedWidth","_containerStrategy","_contentStrategy","containerStg","contentStg","setContainerStrategy","setContentStrategy","UNKNOWN"],"mappings":"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","file":"CCEGLView.js","sourceRoot":"../../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/core/platform","sourcesContent":["/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @ignore\n */\ncc.Touches = [];\ncc.TouchesIntergerDict = {};\n\ncc.DENSITYDPI_DEVICE = \"device-dpi\";\ncc.DENSITYDPI_HIGH = \"high-dpi\";\ncc.DENSITYDPI_MEDIUM = \"medium-dpi\";\ncc.DENSITYDPI_LOW = \"low-dpi\";\n\nvar __BrowserGetter = {\n    init: function () {\n        this.html = document.documentElement;\n    },\n    availWidth: function (frame) {\n        if (!frame || frame === this.html)\n            return window.innerWidth;\n        else\n            return frame.clientWidth;\n    },\n    availHeight: function (frame) {\n        if (!frame || frame === this.html)\n            return window.innerHeight;\n        else\n            return frame.clientHeight;\n    },\n    meta: {\n        \"width\": \"device-width\"\n    },\n    adaptationType: cc.sys.browserType\n};\n\nif (window.navigator.userAgent.indexOf(\"OS 8_1_\") > -1) //this mistake like MIUI, so use of MIUI treatment method\n    __BrowserGetter.adaptationType = cc.sys.BROWSER_TYPE_MIUI;\n\nif (cc.sys.os === cc.sys.OS_IOS) // All browsers are WebView\n    __BrowserGetter.adaptationType = cc.sys.BROWSER_TYPE_SAFARI;\n\nswitch (__BrowserGetter.adaptationType) {\n    case cc.sys.BROWSER_TYPE_SAFARI:\n        __BrowserGetter.meta[\"minimal-ui\"] = \"true\";\n        break;\n    case cc.sys.BROWSER_TYPE_CHROME:\n        __BrowserGetter.__defineGetter__(\"target-densitydpi\", function () {\n            return cc.view._targetDensityDPI;\n        });\n        break;\n    case cc.sys.BROWSER_TYPE_MIUI:\n        __BrowserGetter.init = function (view) {\n            if (view.__resizeWithBrowserSize) return;\n            var resize = function () {\n                view.setDesignResolutionSize(\n                    view._designResolutionSize.width,\n                    view._designResolutionSize.height,\n                    view._resolutionPolicy\n                );\n                window.removeEventListener(\"resize\", resize, false);\n            };\n            window.addEventListener(\"resize\", resize, false);\n        };\n        break;\n}\n\nvar _scissorRect = null;\n\n/**\n * cc.view is the singleton object which represents the game window.<br/>\n * It's main task include: <br/>\n *  - Apply the design resolution policy<br/>\n *  - Provide interaction with the window, like resize event on web, retina display support, etc...<br/>\n *  - Manage the game view port which can be different with the window<br/>\n *  - Manage the content scale and translation<br/>\n * <br/>\n * Since the cc.view is a singleton, you don't need to call any constructor or create functions,<br/>\n * the standard way to use it is by calling:<br/>\n *  - cc.view.methodName(); <br/>\n * @class\n * @name cc.view\n * @extend cc.Class\n */\ncc.EGLView = cc.Class.extend(/** @lends cc.view# */{\n    _delegate: null,\n    // Size of parent node that contains cc.container and cc._canvas\n    _frameSize: null,\n    // resolution size, it is the size appropriate for the app resources.\n    _designResolutionSize: null,\n    _originalDesignResolutionSize: null,\n    // Viewport is the container's rect related to content's coordinates in pixel\n    _viewPortRect: null,\n    // The visible rect in content's coordinate in point\n    _visibleRect: null,\n    _retinaEnabled: false,\n    _autoFullScreen: false,\n    // The device's pixel ratio (for retina displays)\n    _devicePixelRatio: 1,\n    // the view name\n    _viewName: \"\",\n    // Custom callback for resize event\n    _resizeCallback: null,\n\n    _orientationChanging: true,\n    _resizing: false,\n\n    _scaleX: 1,\n    _originalScaleX: 1,\n    _scaleY: 1,\n    _originalScaleY: 1,\n\n    _isRotated: false,\n    _orientation: 3,\n\n    _resolutionPolicy: null,\n    _rpExactFit: null,\n    _rpShowAll: null,\n    _rpNoBorder: null,\n    _rpFixedHeight: null,\n    _rpFixedWidth: null,\n    _initialized: false,\n\n    _contentTranslateLeftTop: null,\n\n    // Parent node that contains cc.container and cc._canvas\n    _frame: null,\n    _frameZoomFactor: 1.0,\n    __resizeWithBrowserSize: false,\n    _isAdjustViewPort: true,\n    _targetDensityDPI: null,\n\n    /**\n     * Constructor of cc.EGLView\n     */\n    ctor: function () {\n        var _t = this, d = document, _strategyer = cc.ContainerStrategy, _strategy = cc.ContentStrategy;\n\n        __BrowserGetter.init(this);\n\n        _t._frame = (cc.container.parentNode === d.body) ? d.documentElement : cc.container.parentNode;\n        _t._frameSize = cc.size(0, 0);\n        _t._initFrameSize();\n\n        var w = cc._canvas.width, h = cc._canvas.height;\n        _t._designResolutionSize = cc.size(w, h);\n        _t._originalDesignResolutionSize = cc.size(w, h);\n        _t._viewPortRect = cc.rect(0, 0, w, h);\n        _t._visibleRect = cc.rect(0, 0, w, h);\n        _t._contentTranslateLeftTop = {left: 0, top: 0};\n        _t._viewName = \"Cocos2dHTML5\";\n\n        var sys = cc.sys;\n        cc.visibleRect && cc.visibleRect.init(_t._visibleRect);\n\n        // Setup system default resolution policies\n        _t._rpExactFit = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.EXACT_FIT);\n        _t._rpShowAll = new cc.ResolutionPolicy(_strategyer.PROPORTION_TO_FRAME, _strategy.SHOW_ALL);\n        _t._rpNoBorder = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.NO_BORDER);\n        _t._rpFixedHeight = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.FIXED_HEIGHT);\n        _t._rpFixedWidth = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.FIXED_WIDTH);\n\n        _t._targetDensityDPI = cc.DENSITYDPI_HIGH;\n\n        if (sys.isMobile) {\n            window.addEventListener('orientationchange', this._orientationChange);\n        } else {\n            this._orientationChanging = false;\n        }\n    },\n\n    // Resize helper functions\n    _resizeEvent: function () {\n        var view;\n        if (this.setDesignResolutionSize) {\n            view = this;\n        } else {\n            view = cc.view;\n        }\n        if (view._orientationChanging) {\n            return;\n        }\n\n        // Check frame size changed or not\n        var prevFrameW = view._frameSize.width, prevFrameH = view._frameSize.height, prevRotated = view._isRotated;\n        if (cc.sys.isMobile) {\n            var containerStyle = cc.game.container.style,\n                margin = containerStyle.margin;\n            containerStyle.margin = '0';\n            containerStyle.display = 'none';\n            view._initFrameSize();\n            containerStyle.margin = margin;\n            containerStyle.display = 'block';\n        }\n        else {\n            view._initFrameSize();\n        }\n        if (view._isRotated === prevRotated && view._frameSize.width === prevFrameW && view._frameSize.height === prevFrameH)\n            return;\n\n        // Frame size changed, do resize works\n        var width = view._originalDesignResolutionSize.width;\n        var height = view._originalDesignResolutionSize.height;\n        view._resizing = true;\n        if (width > 0) {\n            view.setDesignResolutionSize(width, height, view._resolutionPolicy);\n        }\n        view._resizing = false;\n\n        cc.eventManager.dispatchCustomEvent('canvas-resize');\n        if (view._resizeCallback) {\n            view._resizeCallback.call();\n        }\n    },\n\n    _orientationChange: function () {\n        cc.view._orientationChanging = true;\n        if (cc.sys.isMobile) {\n            cc.game.container.style.display = \"none\";\n        }\n        setTimeout(function () {\n            cc.view._orientationChanging = false;\n            cc.view._resizeEvent();\n        }, 300);\n    },\n\n    /**\n     * <p>\n     * Sets view's target-densitydpi for android mobile browser. it can be set to:           <br/>\n     *   1. cc.DENSITYDPI_DEVICE, value is \"device-dpi\"                                      <br/>\n     *   2. cc.DENSITYDPI_HIGH, value is \"high-dpi\"  (default value)                         <br/>\n     *   3. cc.DENSITYDPI_MEDIUM, value is \"medium-dpi\" (browser's default value)            <br/>\n     *   4. cc.DENSITYDPI_LOW, value is \"low-dpi\"                                            <br/>\n     *   5. Custom value, e.g: \"480\"                                                         <br/>\n     * </p>\n     * @param {String} densityDPI\n     */\n    setTargetDensityDPI: function (densityDPI) {\n        this._targetDensityDPI = densityDPI;\n        this._adjustViewportMeta();\n    },\n\n    /**\n     * Returns the current target-densitydpi value of cc.view.\n     * @returns {String}\n     */\n    getTargetDensityDPI: function () {\n        return this._targetDensityDPI;\n    },\n\n    /**\n     * Sets whether resize canvas automatically when browser's size changed.<br/>\n     * Useful only on web.\n     * @param {Boolean} enabled Whether enable automatic resize with browser's resize event\n     */\n    resizeWithBrowserSize: function (enabled) {\n        if (enabled) {\n            //enable\n            if (!this.__resizeWithBrowserSize) {\n                this.__resizeWithBrowserSize = true;\n                window.addEventListener('resize', this._resizeEvent);\n            }\n        } else {\n            //disable\n            if (this.__resizeWithBrowserSize) {\n                this.__resizeWithBrowserSize = false;\n                window.removeEventListener('resize', this._resizeEvent);\n            }\n        }\n    },\n\n    /**\n     * Sets the callback function for cc.view's resize action,<br/>\n     * this callback will be invoked before applying resolution policy, <br/>\n     * so you can do any additional modifications within the callback.<br/>\n     * Useful only on web.\n     * @param {Function|null} callback The callback function\n     */\n    setResizeCallback: function (callback) {\n        if (typeof callback === 'function' || callback == null) {\n            this._resizeCallback = callback;\n        }\n    },\n\n    /**\n     * Sets the orientation of the game, it can be landscape, portrait or auto.\n     * When set it to landscape or portrait, and screen w/h ratio doesn't fit,\n     * cc.view will automatically rotate the game canvas using CSS.\n     * Note that this function doesn't have any effect in native,\n     * in native, you need to set the application orientation in native project settings\n     * @param {Number} orientation - Possible values: cc.ORIENTATION_LANDSCAPE | cc.ORIENTATION_PORTRAIT | cc.ORIENTATION_AUTO\n     */\n    setOrientation: function (orientation) {\n        orientation = orientation & cc.ORIENTATION_AUTO;\n        if (orientation && this._orientation !== orientation) {\n            this._orientation = orientation;\n            if (this._resolutionPolicy) {\n                var designWidth = this._originalDesignResolutionSize.width;\n                var designHeight = this._originalDesignResolutionSize.height;\n                this.setDesignResolutionSize(designWidth, designHeight, this._resolutionPolicy);\n            }\n        }\n    },\n\n    setDocumentPixelWidth: function (width) {\n        // Set viewport's width\n        this._setViewportMeta({\"width\": width}, true);\n\n        // Set body width to the exact pixel resolution\n        document.documentElement.style.width = width + 'px';\n        document.body.style.width = \"100%\";\n\n        // Reset the resolution size and policy\n        this.setDesignResolutionSize(this._designResolutionSize.width, this._designResolutionSize.height, this._resolutionPolicy);\n    },\n\n    _initFrameSize: function () {\n        var locFrameSize = this._frameSize;\n        var w = __BrowserGetter.availWidth(this._frame);\n        var h = __BrowserGetter.availHeight(this._frame);\n        var isLandscape = w >= h;\n\n        if (!cc.sys.isMobile ||\n            (isLandscape && this._orientation & cc.ORIENTATION_LANDSCAPE) ||\n            (!isLandscape && this._orientation & cc.ORIENTATION_PORTRAIT)) {\n            locFrameSize.width = w;\n            locFrameSize.height = h;\n            cc.container.style['-webkit-transform'] = 'rotate(0deg)';\n            cc.container.style.transform = 'rotate(0deg)';\n            this._isRotated = false;\n        }\n        else {\n            locFrameSize.width = h;\n            locFrameSize.height = w;\n            cc.container.style['-webkit-transform'] = 'rotate(90deg)';\n            cc.container.style.transform = 'rotate(90deg)';\n            cc.container.style['-webkit-transform-origin'] = '0px 0px 0px';\n            cc.container.style.transformOrigin = '0px 0px 0px';\n            this._isRotated = true;\n        }\n    },\n\n    // hack\n    _adjustSizeKeepCanvasSize: function () {\n        var designWidth = this._originalDesignResolutionSize.width;\n        var designHeight = this._originalDesignResolutionSize.height;\n        if (designWidth > 0)\n            this.setDesignResolutionSize(designWidth, designHeight, this._resolutionPolicy);\n    },\n\n    _setViewportMeta: function (metas, overwrite) {\n        var vp = document.getElementById(\"cocosMetaElement\");\n        if (vp && overwrite) {\n            document.head.removeChild(vp);\n        }\n\n        var elems = document.getElementsByName(\"viewport\"),\n            currentVP = elems ? elems[0] : null,\n            content, key, pattern;\n\n        content = currentVP ? currentVP.content : \"\";\n        vp = vp || document.createElement(\"meta\");\n        vp.id = \"cocosMetaElement\";\n        vp.name = \"viewport\";\n        vp.content = \"\";\n\n        for (key in metas) {\n            if (content.indexOf(key) == -1) {\n                content += \",\" + key + \"=\" + metas[key];\n            }\n            else if (overwrite) {\n                pattern = new RegExp(key + \"\\s*=\\s*[^,]+\");\n                content.replace(pattern, key + \"=\" + metas[key]);\n            }\n        }\n        if (/^,/.test(content))\n            content = content.substr(1);\n\n        vp.content = content;\n        // For adopting certain android devices which don't support second viewport\n        if (currentVP)\n            currentVP.content = content;\n\n        document.head.appendChild(vp);\n    },\n\n    _adjustViewportMeta: function () {\n        if (this._isAdjustViewPort) {\n            this._setViewportMeta(__BrowserGetter.meta, false);\n            // Only adjust viewport once\n            this._isAdjustViewPort = false;\n        }\n    },\n\n    // RenderTexture hacker\n    _setScaleXYForRenderTexture: function () {\n        //hack for RenderTexture on canvas mode when adapting multiple resolution resources\n        var scaleFactor = cc.contentScaleFactor();\n        this._scaleX = scaleFactor;\n        this._scaleY = scaleFactor;\n    },\n\n    // Other helper functions\n    _resetScale: function () {\n        this._scaleX = this._originalScaleX;\n        this._scaleY = this._originalScaleY;\n    },\n\n    // Useless, just make sure the compatibility temporarily, should be removed\n    _adjustSizeToBrowser: function () {\n    },\n\n    initialize: function () {\n        this._initialized = true;\n    },\n\n    /**\n     * Sets whether the engine modify the \"viewport\" meta in your web page.<br/>\n     * It's enabled by default, we strongly suggest you not to disable it.<br/>\n     * And even when it's enabled, you can still set your own \"viewport\" meta, it won't be overridden<br/>\n     * Only useful on web\n     * @param {Boolean} enabled Enable automatic modification to \"viewport\" meta\n     */\n    adjustViewPort: function (enabled) {\n        this._isAdjustViewPort = enabled;\n    },\n\n    /**\n     * Retina support is enabled by default for Apple device but disabled for other devices,<br/>\n     * it takes effect only when you called setDesignResolutionPolicy<br/>\n     * Only useful on web\n     * @param {Boolean} enabled  Enable or disable retina display\n     */\n    enableRetina: function (enabled) {\n        this._retinaEnabled = !!enabled;\n    },\n\n    /**\n     * Check whether retina display is enabled.<br/>\n     * Only useful on web\n     * @return {Boolean}\n     */\n    isRetinaEnabled: function () {\n        return this._retinaEnabled;\n    },\n\n    /**\n     * If enabled, the application will try automatically to enter full screen mode on mobile devices<br/>\n     * You can pass true as parameter to enable it and disable it by passing false.<br/>\n     * Only useful on web\n     * @param {Boolean} enabled  Enable or disable auto full screen on mobile devices\n     */\n    enableAutoFullScreen: function (enabled) {\n        if (enabled && enabled !== this._autoFullScreen && cc.sys.isMobile && this._frame === document.documentElement) {\n            // Automatically full screen when user touches on mobile version\n            this._autoFullScreen = true;\n            cc.screen.autoFullScreen(this._frame);\n        }\n        else {\n            this._autoFullScreen = false;\n        }\n    },\n\n    /**\n     * Check whether auto full screen is enabled.<br/>\n     * Only useful on web\n     * @return {Boolean} Auto full screen enabled or not\n     */\n    isAutoFullScreenEnabled: function () {\n        return this._autoFullScreen;\n    },\n\n    /**\n     * Get whether render system is ready(no matter opengl or canvas),<br/>\n     * this name is for the compatibility with cocos2d-x, subclass must implement this method.\n     * @return {Boolean}\n     */\n    isOpenGLReady: function () {\n        return (cc.game.canvas && cc._renderContext);\n    },\n\n    /*\n     * Set zoom factor for frame. This method is for debugging big resolution (e.g.new ipad) app on desktop.\n     * @param {Number} zoomFactor\n     */\n    setFrameZoomFactor: function (zoomFactor) {\n        this._frameZoomFactor = zoomFactor;\n        this.centerWindow();\n        cc.director.setProjection(cc.director.getProjection());\n    },\n\n    /**\n     * Exchanges the front and back buffers, subclass must implement this method.\n     */\n    swapBuffers: function () {\n    },\n\n    /**\n     * Open or close IME keyboard , subclass must implement this method.\n     * @param {Boolean} isOpen\n     */\n    setIMEKeyboardState: function (isOpen) {\n    },\n\n    /**\n     * Sets the resolution translate on EGLView\n     * @param {Number} offsetLeft\n     * @param {Number} offsetTop\n     */\n    setContentTranslateLeftTop: function (offsetLeft, offsetTop) {\n        this._contentTranslateLeftTop = {left: offsetLeft, top: offsetTop};\n    },\n\n    /**\n     * Returns the resolution translate on EGLView\n     * @return {cc.Size|Object}\n     */\n    getContentTranslateLeftTop: function () {\n        return this._contentTranslateLeftTop;\n    },\n\n    /**\n     * Returns the canvas size of the view.<br/>\n     * On native platforms, it returns the screen size since the view is a fullscreen view.<br/>\n     * On web, it returns the size of the canvas element.\n     * @return {cc.Size}\n     */\n    getCanvasSize: function () {\n        return cc.size(cc._canvas.width, cc._canvas.height);\n    },\n\n    /**\n     * Returns the frame size of the view.<br/>\n     * On native platforms, it returns the screen size since the view is a fullscreen view.<br/>\n     * On web, it returns the size of the canvas's outer DOM element.\n     * @return {cc.Size}\n     */\n    getFrameSize: function () {\n        return cc.size(this._frameSize.width, this._frameSize.height);\n    },\n\n    /**\n     * On native, it sets the frame size of view.<br/>\n     * On web, it sets the size of the canvas's outer DOM element.\n     * @param {Number} width\n     * @param {Number} height\n     */\n    setFrameSize: function (width, height) {\n        this._frameSize.width = width;\n        this._frameSize.height = height;\n        this._frame.style.width = width + \"px\";\n        this._frame.style.height = height + \"px\";\n        this._resizeEvent();\n        cc.director.setProjection(cc.director.getProjection());\n    },\n\n    /**\n     * Returns the visible area size of the view port.\n     * @return {cc.Size}\n     */\n    getVisibleSize: function () {\n        return cc.size(this._visibleRect.width, this._visibleRect.height);\n    },\n\n    /**\n     * Returns the visible area size of the view port.\n     * @return {cc.Size}\n     */\n    getVisibleSizeInPixel: function () {\n        return cc.size( this._visibleRect.width * this._scaleX,\n                        this._visibleRect.height * this._scaleY );\n    },\n\n    /**\n     * Returns the visible origin of the view port.\n     * @return {cc.Point}\n     */\n    getVisibleOrigin: function () {\n        return cc.p(this._visibleRect.x, this._visibleRect.y);\n    },\n\n    /**\n     * Returns the visible origin of the view port.\n     * @return {cc.Point}\n     */\n    getVisibleOriginInPixel: function () {\n        return cc.p(this._visibleRect.x * this._scaleX, \n                    this._visibleRect.y * this._scaleY);\n    },\n\n    /**\n     * Returns whether developer can set content's scale factor.\n     * @return {Boolean}\n     */\n    canSetContentScaleFactor: function () {\n        return true;\n    },\n\n    /**\n     * Returns the current resolution policy\n     * @see cc.ResolutionPolicy\n     * @return {cc.ResolutionPolicy}\n     */\n    getResolutionPolicy: function () {\n        return this._resolutionPolicy;\n    },\n\n    /**\n     * Sets the current resolution policy\n     * @see cc.ResolutionPolicy\n     * @param {cc.ResolutionPolicy|Number} resolutionPolicy\n     */\n    setResolutionPolicy: function (resolutionPolicy) {\n        var _t = this;\n        if (resolutionPolicy instanceof cc.ResolutionPolicy) {\n            _t._resolutionPolicy = resolutionPolicy;\n        }\n        // Ensure compatibility with JSB\n        else {\n            var _locPolicy = cc.ResolutionPolicy;\n            if (resolutionPolicy === _locPolicy.EXACT_FIT)\n                _t._resolutionPolicy = _t._rpExactFit;\n            if (resolutionPolicy === _locPolicy.SHOW_ALL)\n                _t._resolutionPolicy = _t._rpShowAll;\n            if (resolutionPolicy === _locPolicy.NO_BORDER)\n                _t._resolutionPolicy = _t._rpNoBorder;\n            if (resolutionPolicy === _locPolicy.FIXED_HEIGHT)\n                _t._resolutionPolicy = _t._rpFixedHeight;\n            if (resolutionPolicy === _locPolicy.FIXED_WIDTH)\n                _t._resolutionPolicy = _t._rpFixedWidth;\n        }\n    },\n\n    /**\n     * Sets the resolution policy with designed view size in points.<br/>\n     * The resolution policy include: <br/>\n     * [1] ResolutionExactFit       Fill screen by stretch-to-fit: if the design resolution ratio of width to height is different from the screen resolution ratio, your game view will be stretched.<br/>\n     * [2] ResolutionNoBorder       Full screen without black border: if the design resolution ratio of width to height is different from the screen resolution ratio, two areas of your game view will be cut.<br/>\n     * [3] ResolutionShowAll        Full screen with black border: if the design resolution ratio of width to height is different from the screen resolution ratio, two black borders will be shown.<br/>\n     * [4] ResolutionFixedHeight    Scale the content's height to screen's height and proportionally scale its width<br/>\n     * [5] ResolutionFixedWidth     Scale the content's width to screen's width and proportionally scale its height<br/>\n     * [cc.ResolutionPolicy]        [Web only feature] Custom resolution policy, constructed by cc.ResolutionPolicy<br/>\n     * @param {Number} width Design resolution width.\n     * @param {Number} height Design resolution height.\n     * @param {cc.ResolutionPolicy|Number} resolutionPolicy The resolution policy desired\n     */\n    setDesignResolutionSize: function (width, height, resolutionPolicy) {\n        // Defensive code\n        if (!(width > 0 || height > 0)) {\n            cc.log(cc._LogInfos.EGLView_setDesignResolutionSize);\n            return;\n        }\n\n        this.setResolutionPolicy(resolutionPolicy);\n        var policy = this._resolutionPolicy;\n        if (policy) {\n            policy.preApply(this);\n        }\n\n        // Reinit frame size\n        if (cc.sys.isMobile)\n            this._adjustViewportMeta();\n\n        // If resizing, then frame size is already initialized, this logic should be improved\n        if (!this._resizing)\n            this._initFrameSize();\n\n        if (!policy) {\n            cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2);\n            return;\n        }\n\n        this._originalDesignResolutionSize.width = this._designResolutionSize.width = width;\n        this._originalDesignResolutionSize.height = this._designResolutionSize.height = height;\n\n        var result = policy.apply(this, this._designResolutionSize);\n\n        if (result.scale && result.scale.length === 2) {\n            this._scaleX = result.scale[0];\n            this._scaleY = result.scale[1];\n        }\n\n        if (result.viewport) {\n            var vp = this._viewPortRect,\n                vb = this._visibleRect,\n                rv = result.viewport;\n\n            vp.x = rv.x;\n            vp.y = rv.y;\n            vp.width = rv.width;\n            vp.height = rv.height;\n\n            vb.x = -vp.x / this._scaleX;\n            vb.y = -vp.y / this._scaleY;\n            vb.width = cc._canvas.width / this._scaleX;\n            vb.height = cc._canvas.height / this._scaleY;\n            cc._renderContext.setOffset && cc._renderContext.setOffset(vp.x, -vp.y);\n        }\n\n        // reset director's member variables to fit visible rect\n        var director = cc.director;\n        director._winSizeInPoints.width = this._designResolutionSize.width;\n        director._winSizeInPoints.height = this._designResolutionSize.height;\n        policy.postApply(this);\n        cc.winSize.width = director._winSizeInPoints.width;\n        cc.winSize.height = director._winSizeInPoints.height;\n\n        if (cc._renderType === cc.game.RENDER_TYPE_WEBGL) {\n            // reset director's member variables to fit visible rect\n            director.setGLDefaultValues();\n        }\n        else if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {\n            cc.renderer._allNeedDraw = true;\n        }\n\n        this._originalScaleX = this._scaleX;\n        this._originalScaleY = this._scaleY;\n        cc.visibleRect && cc.visibleRect.init(this._visibleRect);\n    },\n\n    /**\n     * Returns the designed size for the view.\n     * Default resolution size is the same as 'getFrameSize'.\n     * @return {cc.Size}\n     */\n    getDesignResolutionSize: function () {\n        return cc.size(this._designResolutionSize.width, this._designResolutionSize.height);\n    },\n\n    /**\n     * Sets the document body to desired pixel resolution and fit the game content to it.\n     * This function is very useful for adaptation in mobile browsers.\n     * In some HD android devices, the resolution is very high, but its browser performance may not be very good.\n     * In this case, enabling retina display is very costy and not suggested, and if retina is disabled, the image may be blurry.\n     * But this API can be helpful to set a desired pixel resolution which is in between.\n     * This API will do the following:\n     *     1. Set viewport's width to the desired width in pixel\n     *     2. Set body width to the exact pixel resolution\n     *     3. The resolution policy will be reset with designed view size in points.\n     * @param {Number} width Design resolution width.\n     * @param {Number} height Design resolution height.\n     * @param {cc.ResolutionPolicy|Number} resolutionPolicy The resolution policy desired\n     */\n    setRealPixelResolution: function (width, height, resolutionPolicy) {\n        // Set viewport's width\n        this._setViewportMeta({\"width\": width}, true);\n\n        // Set body width to the exact pixel resolution\n        document.documentElement.style.width = width + \"px\";\n        document.body.style.width = width + \"px\";\n        document.body.style.left = \"0px\";\n        document.body.style.top = \"0px\";\n\n        // Reset the resolution size and policy\n        this.setDesignResolutionSize(width, height, resolutionPolicy);\n    },\n\n    /**\n     * Sets view port rectangle with points.\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} w width\n     * @param {Number} h height\n     */\n    setViewPortInPoints: function (x, y, w, h) {\n        var locFrameZoomFactor = this._frameZoomFactor, locScaleX = this._scaleX, locScaleY = this._scaleY;\n        cc._renderContext.viewport((x * locScaleX * locFrameZoomFactor + this._viewPortRect.x * locFrameZoomFactor),\n            (y * locScaleY * locFrameZoomFactor + this._viewPortRect.y * locFrameZoomFactor),\n            (w * locScaleX * locFrameZoomFactor),\n            (h * locScaleY * locFrameZoomFactor));\n    },\n\n    /**\n     * Sets Scissor rectangle with points.\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} w\n     * @param {Number} h\n     */\n    setScissorInPoints: function (x, y, w, h) {\n        var locFrameZoomFactor = this._frameZoomFactor, locScaleX = this._scaleX, locScaleY = this._scaleY;\n        var sx = Math.ceil(x * locScaleX * locFrameZoomFactor + this._viewPortRect.x * locFrameZoomFactor);\n        var sy = Math.ceil(y * locScaleY * locFrameZoomFactor + this._viewPortRect.y * locFrameZoomFactor);\n        var sw = Math.ceil(w * locScaleX * locFrameZoomFactor);\n        var sh = Math.ceil(h * locScaleY * locFrameZoomFactor);\n\n        if (!_scissorRect) {\n            var boxArr = gl.getParameter(gl.SCISSOR_BOX);\n            _scissorRect = cc.rect(boxArr[0], boxArr[1], boxArr[2], boxArr[3]);\n        }\n\n        if (_scissorRect.x != sx || _scissorRect.y != sy || _scissorRect.width != sw || _scissorRect.height != sh) {\n            _scissorRect.x = sx;\n            _scissorRect.y = sy;\n            _scissorRect.width = sw;\n            _scissorRect.height = sh;\n            cc._renderContext.scissor(sx, sy, sw, sh);\n        }\n    },\n\n    /**\n     * Returns whether GL_SCISSOR_TEST is enable\n     * @return {Boolean}\n     */\n    isScissorEnabled: function () {\n        return cc._renderContext.isEnabled(gl.SCISSOR_TEST);\n    },\n\n    /**\n     * Returns the current scissor rectangle\n     * @return {cc.Rect}\n     */\n    getScissorRect: function () {\n        if (!_scissorRect) {\n            var boxArr = gl.getParameter(gl.SCISSOR_BOX);\n            _scissorRect = cc.rect(boxArr[0], boxArr[1], boxArr[2], boxArr[3]);\n        }\n        var scaleXFactor = 1 / this._scaleX;\n        var scaleYFactor = 1 / this._scaleY;\n        return cc.rect(\n            (_scissorRect.x - this._viewPortRect.x) * scaleXFactor,\n            (_scissorRect.y - this._viewPortRect.y) * scaleYFactor,\n            _scissorRect.width * scaleXFactor,\n            _scissorRect.height * scaleYFactor\n        );\n    },\n\n    /**\n     * Sets the name of the view\n     * @param {String} viewName\n     */\n    setViewName: function (viewName) {\n        if (viewName != null && viewName.length > 0) {\n            this._viewName = viewName;\n        }\n    },\n\n    /**\n     * Returns the name of the view\n     * @return {String}\n     */\n    getViewName: function () {\n        return this._viewName;\n    },\n\n    /**\n     * Returns the view port rectangle.\n     * @return {cc.Rect}\n     */\n    getViewPortRect: function () {\n        return this._viewPortRect;\n    },\n\n    /**\n     * Returns scale factor of the horizontal direction (X axis).\n     * @return {Number}\n     */\n    getScaleX: function () {\n        return this._scaleX;\n    },\n\n    /**\n     * Returns scale factor of the vertical direction (Y axis).\n     * @return {Number}\n     */\n    getScaleY: function () {\n        return this._scaleY;\n    },\n\n    /**\n     * Returns device pixel ratio for retina display.\n     * @return {Number}\n     */\n    getDevicePixelRatio: function () {\n        return this._devicePixelRatio;\n    },\n\n    /**\n     * Returns the real location in view for a translation based on a related position\n     * @param {Number} tx The X axis translation\n     * @param {Number} ty The Y axis translation\n     * @param {Object} relatedPos The related position object including \"left\", \"top\", \"width\", \"height\" informations\n     * @return {cc.Point}\n     */\n    convertToLocationInView: function (tx, ty, relatedPos) {\n        var x = this._devicePixelRatio * (tx - relatedPos.left);\n        var y = this._devicePixelRatio * (relatedPos.top + relatedPos.height - ty);\n        return this._isRotated ? {x: this._viewPortRect.width - y, y: x} : {x: x, y: y};\n    },\n\n    _convertMouseToLocationInView: function (point, relatedPos) {\n        var viewport = this._viewPortRect, _t = this;\n        point.x = ((_t._devicePixelRatio * (point.x - relatedPos.left)) - viewport.x) / _t._scaleX;\n        point.y = (_t._devicePixelRatio * (relatedPos.top + relatedPos.height - point.y) - viewport.y) / _t._scaleY;\n    },\n\n    _convertPointWithScale: function (point) {\n        var viewport = this._viewPortRect;\n        point.x = (point.x - viewport.x) / this._scaleX;\n        point.y = (point.y - viewport.y) / this._scaleY;\n    },\n\n    _convertTouchesWithScale: function (touches) {\n        var viewport = this._viewPortRect, scaleX = this._scaleX, scaleY = this._scaleY,\n            selTouch, selPoint, selPrePoint;\n        for (var i = 0; i < touches.length; i++) {\n            selTouch = touches[i];\n            selPoint = selTouch._point;\n            selPrePoint = selTouch._prevPoint;\n\n            selPoint.x = (selPoint.x - viewport.x) / scaleX;\n            selPoint.y = (selPoint.y - viewport.y) / scaleY;\n            selPrePoint.x = (selPrePoint.x - viewport.x) / scaleX;\n            selPrePoint.y = (selPrePoint.y - viewport.y) / scaleY;\n        }\n    }\n});\n\n/**\n * @function\n * @return {cc.EGLView}\n * @private\n */\ncc.EGLView._getInstance = function () {\n    if (!this._instance) {\n        this._instance = this._instance || new cc.EGLView();\n        this._instance.initialize();\n    }\n    return this._instance;\n};\n\n/**\n * <p>cc.ContainerStrategy class is the root strategy class of container's scale strategy,\n * it controls the behavior of how to scale the cc.container and cc._canvas object</p>\n *\n * @class\n * @extends cc.Class\n */\ncc.ContainerStrategy = cc.Class.extend(/** @lends cc.ContainerStrategy# */{\n    /**\n     * Manipulation before appling the strategy\n     * @param {cc.view} The target view\n     */\n    preApply: function (view) {\n    },\n\n    /**\n     * Function to apply this strategy\n     * @param {cc.view} view\n     * @param {cc.Size} designedResolution\n     */\n    apply: function (view, designedResolution) {\n    },\n\n    /**\n     * Manipulation after applying the strategy\n     * @param {cc.view} view  The target view\n     */\n    postApply: function (view) {\n\n    },\n\n    _setupContainer: function (view, w, h) {\n        var locCanvas = cc.game.canvas, locContainer = cc.game.container;\n        if (cc.sys.os === cc.sys.OS_ANDROID) {\n            document.body.style.width = (view._isRotated ? h : w) + 'px';\n            document.body.style.height = (view._isRotated ? w : h) + 'px';\n        }\n\n        // Setup style\n        locContainer.style.width = locCanvas.style.width = w + 'px';\n        locContainer.style.height = locCanvas.style.height = h + 'px';\n        // Setup pixel ratio for retina display\n        var devicePixelRatio = view._devicePixelRatio = 1;\n        if (view.isRetinaEnabled())\n            devicePixelRatio = view._devicePixelRatio = Math.min(2, window.devicePixelRatio || 1);\n        // Setup canvas\n        locCanvas.width = w * devicePixelRatio;\n        locCanvas.height = h * devicePixelRatio;\n        cc._renderContext.resetCache && cc._renderContext.resetCache();\n    },\n\n    _fixContainer: function () {\n        // Add container to document body\n        document.body.insertBefore(cc.container, document.body.firstChild);\n        // Set body's width height to window's size, and forbid overflow, so that game will be centered\n        var bs = document.body.style;\n        bs.width = window.innerWidth + \"px\";\n        bs.height = window.innerHeight + \"px\";\n        bs.overflow = \"hidden\";\n        // Body size solution doesn't work on all mobile browser so this is the aleternative: fixed container\n        var contStyle = cc.container.style;\n        contStyle.position = \"fixed\";\n        contStyle.left = contStyle.top = \"0px\";\n        // Reposition body\n        document.body.scrollTop = 0;\n    }\n});\n\n/**\n * <p>cc.ContentStrategy class is the root strategy class of content's scale strategy,\n * it controls the behavior of how to scale the scene and setup the viewport for the game</p>\n *\n * @class\n * @extends cc.Class\n */\ncc.ContentStrategy = cc.Class.extend(/** @lends cc.ContentStrategy# */{\n\n    _result: {\n        scale: [1, 1],\n        viewport: null\n    },\n\n    _buildResult: function (containerW, containerH, contentW, contentH, scaleX, scaleY) {\n        // Makes content fit better the canvas\n        Math.abs(containerW - contentW) < 2 && (contentW = containerW);\n        Math.abs(containerH - contentH) < 2 && (contentH = containerH);\n\n        var viewport = cc.rect(Math.round((containerW - contentW) / 2),\n                               Math.round((containerH - contentH) / 2),\n                               contentW, contentH);\n\n        // Translate the content\n        if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {\n            //TODO: modify something for setTransform\n            //cc._renderContext.translate(viewport.x, viewport.y + contentH);\n        }\n\n        this._result.scale = [scaleX, scaleY];\n        this._result.viewport = viewport;\n        return this._result;\n    },\n\n    /**\n     * Manipulation before applying the strategy\n     * @param {cc.view} view The target view\n     */\n    preApply: function (view) {\n    },\n\n    /**\n     * Function to apply this strategy\n     * The return value is {scale: [scaleX, scaleY], viewport: {cc.Rect}},\n     * The target view can then apply these value to itself, it's preferred not to modify directly its private variables\n     * @param {cc.view} view\n     * @param {cc.Size} designedResolution\n     * @return {object} scaleAndViewportRect\n     */\n    apply: function (view, designedResolution) {\n        return {\"scale\": [1, 1]};\n    },\n\n    /**\n     * Manipulation after applying the strategy\n     * @param {cc.view} view The target view\n     */\n    postApply: function (view) {\n    }\n});\n\n(function () {\n\n// Container scale strategys\n    /**\n     * @class\n     * @extends cc.ContainerStrategy\n     */\n    var EqualToFrame = cc.ContainerStrategy.extend({\n        apply: function (view) {\n            var frameH = view._frameSize.height, containerStyle = cc.container.style;\n            this._setupContainer(view, view._frameSize.width, view._frameSize.height);\n            // Setup container's margin and padding\n            if (view._isRotated) {\n                containerStyle.margin = '0 0 0 ' + frameH + 'px';\n            }\n            else {\n                containerStyle.margin = '0px';\n            }\n        }\n    });\n\n    /**\n     * @class\n     * @extends cc.ContainerStrategy\n     */\n    var ProportionalToFrame = cc.ContainerStrategy.extend({\n        apply: function (view, designedResolution) {\n            var frameW = view._frameSize.width, frameH = view._frameSize.height, containerStyle = cc.container.style,\n                designW = designedResolution.width, designH = designedResolution.height,\n                scaleX = frameW / designW, scaleY = frameH / designH,\n                containerW, containerH;\n\n            scaleX < scaleY ? (containerW = frameW, containerH = designH * scaleX) : (containerW = designW * scaleY, containerH = frameH);\n\n            // Adjust container size with integer value\n            var offx = Math.round((frameW - containerW) / 2);\n            var offy = Math.round((frameH - containerH) / 2);\n            containerW = frameW - 2 * offx;\n            containerH = frameH - 2 * offy;\n\n            this._setupContainer(view, containerW, containerH);\n            // Setup container's margin and padding\n            if (view._isRotated) {\n                containerStyle.margin = '0 0 0 ' + frameH + 'px';\n            }\n            else {\n                containerStyle.margin = '0px';\n            }\n            containerStyle.paddingLeft = offx + \"px\";\n            containerStyle.paddingRight = offx + \"px\";\n            containerStyle.paddingTop = offy + \"px\";\n            containerStyle.paddingBottom = offy + \"px\";\n        }\n    });\n\n    /**\n     * @class\n     * @extends EqualToFrame\n     */\n    var EqualToWindow = EqualToFrame.extend({\n        preApply: function (view) {\n            this._super(view);\n            view._frame = document.documentElement;\n        },\n\n        apply: function (view) {\n            this._super(view);\n            this._fixContainer();\n        }\n    });\n\n    /**\n     * @class\n     * @extends ProportionalToFrame\n     */\n    var ProportionalToWindow = ProportionalToFrame.extend({\n        preApply: function (view) {\n            this._super(view);\n            view._frame = document.documentElement;\n        },\n\n        apply: function (view, designedResolution) {\n            this._super(view, designedResolution);\n            this._fixContainer();\n        }\n    });\n\n    /**\n     * @class\n     * @extends cc.ContainerStrategy\n     */\n    var OriginalContainer = cc.ContainerStrategy.extend({\n        apply: function (view) {\n            this._setupContainer(view, cc._canvas.width, cc._canvas.height);\n        }\n    });\n\n// #NOT STABLE on Android# Alias: Strategy that makes the container's size equals to the window's size\n//    cc.ContainerStrategy.EQUAL_TO_WINDOW = new EqualToWindow();\n// #NOT STABLE on Android# Alias: Strategy that scale proportionally the container's size to window's size\n//    cc.ContainerStrategy.PROPORTION_TO_WINDOW = new ProportionalToWindow();\n// Alias: Strategy that makes the container's size equals to the frame's size\n    cc.ContainerStrategy.EQUAL_TO_FRAME = new EqualToFrame();\n// Alias: Strategy that scale proportionally the container's size to frame's size\n    cc.ContainerStrategy.PROPORTION_TO_FRAME = new ProportionalToFrame();\n// Alias: Strategy that keeps the original container's size\n    cc.ContainerStrategy.ORIGINAL_CONTAINER = new OriginalContainer();\n\n// Content scale strategys\n    var ExactFit = cc.ContentStrategy.extend({\n        apply: function (view, designedResolution) {\n            var containerW = cc._canvas.width, containerH = cc._canvas.height,\n                scaleX = containerW / designedResolution.width, scaleY = containerH / designedResolution.height;\n\n            return this._buildResult(containerW, containerH, containerW, containerH, scaleX, scaleY);\n        }\n    });\n\n    var ShowAll = cc.ContentStrategy.extend({\n        apply: function (view, designedResolution) {\n            var containerW = cc._canvas.width, containerH = cc._canvas.height,\n                designW = designedResolution.width, designH = designedResolution.height,\n                scaleX = containerW / designW, scaleY = containerH / designH, scale = 0,\n                contentW, contentH;\n\n            scaleX < scaleY ? (scale = scaleX, contentW = containerW, contentH = designH * scale)\n                : (scale = scaleY, contentW = designW * scale, contentH = containerH);\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        }\n    });\n\n    var NoBorder = cc.ContentStrategy.extend({\n        apply: function (view, designedResolution) {\n            var containerW = cc._canvas.width, containerH = cc._canvas.height,\n                designW = designedResolution.width, designH = designedResolution.height,\n                scaleX = containerW / designW, scaleY = containerH / designH, scale,\n                contentW, contentH;\n\n            scaleX < scaleY ? (scale = scaleY, contentW = designW * scale, contentH = containerH)\n                : (scale = scaleX, contentW = containerW, contentH = designH * scale);\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        }\n    });\n\n    var FixedHeight = cc.ContentStrategy.extend({\n        apply: function (view, designedResolution) {\n            var containerW = cc._canvas.width, containerH = cc._canvas.height,\n                designH = designedResolution.height, scale = containerH / designH,\n                contentW = containerW, contentH = containerH;\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        },\n\n        postApply: function (view) {\n            cc.director._winSizeInPoints = view.getVisibleSize();\n        }\n    });\n\n    var FixedWidth = cc.ContentStrategy.extend({\n        apply: function (view, designedResolution) {\n            var containerW = cc._canvas.width, containerH = cc._canvas.height,\n                designW = designedResolution.width, scale = containerW / designW,\n                contentW = containerW, contentH = containerH;\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        },\n\n        postApply: function (view) {\n            cc.director._winSizeInPoints = view.getVisibleSize();\n        }\n    });\n\n// Alias: Strategy to scale the content's size to container's size, non proportional\n    cc.ContentStrategy.EXACT_FIT = new ExactFit();\n// Alias: Strategy to scale the content's size proportionally to maximum size and keeps the whole content area to be visible\n    cc.ContentStrategy.SHOW_ALL = new ShowAll();\n// Alias: Strategy to scale the content's size proportionally to fill the whole container area\n    cc.ContentStrategy.NO_BORDER = new NoBorder();\n// Alias: Strategy to scale the content's height to container's height and proportionally scale its width\n    cc.ContentStrategy.FIXED_HEIGHT = new FixedHeight();\n// Alias: Strategy to scale the content's width to container's width and proportionally scale its height\n    cc.ContentStrategy.FIXED_WIDTH = new FixedWidth();\n\n})();\n\n/**\n * <p>cc.ResolutionPolicy class is the root strategy class of scale strategy,\n * its main task is to maintain the compatibility with Cocos2d-x</p>\n *\n * @class\n * @extends cc.Class\n * @param {cc.ContainerStrategy} containerStg The container strategy\n * @param {cc.ContentStrategy} contentStg The content strategy\n */\ncc.ResolutionPolicy = cc.Class.extend(/** @lends cc.ResolutionPolicy# */{\n    _containerStrategy: null,\n    _contentStrategy: null,\n\n    /**\n     * Constructor of cc.ResolutionPolicy\n     * @param {cc.ContainerStrategy} containerStg\n     * @param {cc.ContentStrategy} contentStg\n     */\n    ctor: function (containerStg, contentStg) {\n        this.setContainerStrategy(containerStg);\n        this.setContentStrategy(contentStg);\n    },\n\n    /**\n     * Manipulation before applying the resolution policy\n     * @param {cc.view} view The target view\n     */\n    preApply: function (view) {\n        this._containerStrategy.preApply(view);\n        this._contentStrategy.preApply(view);\n    },\n\n    /**\n     * Function to apply this resolution policy\n     * The return value is {scale: [scaleX, scaleY], viewport: {cc.Rect}},\n     * The target view can then apply these value to itself, it's preferred not to modify directly its private variables\n     * @param {cc.view} view The target view\n     * @param {cc.Size} designedResolution The user defined design resolution\n     * @return {object} An object contains the scale X/Y values and the viewport rect\n     */\n    apply: function (view, designedResolution) {\n        this._containerStrategy.apply(view, designedResolution);\n        return this._contentStrategy.apply(view, designedResolution);\n    },\n\n    /**\n     * Manipulation after appyling the strategy\n     * @param {cc.view} view The target view\n     */\n    postApply: function (view) {\n        this._containerStrategy.postApply(view);\n        this._contentStrategy.postApply(view);\n    },\n\n    /**\n     * Setup the container's scale strategy\n     * @param {cc.ContainerStrategy} containerStg\n     */\n    setContainerStrategy: function (containerStg) {\n        if (containerStg instanceof cc.ContainerStrategy)\n            this._containerStrategy = containerStg;\n    },\n\n    /**\n     * Setup the content's scale strategy\n     * @param {cc.ContentStrategy} contentStg\n     */\n    setContentStrategy: function (contentStg) {\n        if (contentStg instanceof cc.ContentStrategy)\n            this._contentStrategy = contentStg;\n    }\n});\n\n/**\n * @memberOf cc.ResolutionPolicy#\n * @name EXACT_FIT\n * @constant\n * @type Number\n * @static\n * The entire application is visible in the specified area without trying to preserve the original aspect ratio.<br/>\n * Distortion can occur, and the application may appear stretched or compressed.\n */\ncc.ResolutionPolicy.EXACT_FIT = 0;\n\n/**\n * @memberOf cc.ResolutionPolicy#\n * @name NO_BORDER\n * @constant\n * @type Number\n * @static\n * The entire application fills the specified area, without distortion but possibly with some cropping,<br/>\n * while maintaining the original aspect ratio of the application.\n */\ncc.ResolutionPolicy.NO_BORDER = 1;\n\n/**\n * @memberOf cc.ResolutionPolicy#\n * @name SHOW_ALL\n * @constant\n * @type Number\n * @static\n * The entire application is visible in the specified area without distortion while maintaining the original<br/>\n * aspect ratio of the application. Borders can appear on two sides of the application.\n */\ncc.ResolutionPolicy.SHOW_ALL = 2;\n\n/**\n * @memberOf cc.ResolutionPolicy#\n * @name FIXED_HEIGHT\n * @constant\n * @type Number\n * @static\n * The application takes the height of the design resolution size and modifies the width of the internal<br/>\n * canvas so that it fits the aspect ratio of the device<br/>\n * no distortion will occur however you must make sure your application works on different<br/>\n * aspect ratios\n */\ncc.ResolutionPolicy.FIXED_HEIGHT = 3;\n\n/**\n * @memberOf cc.ResolutionPolicy#\n * @name FIXED_WIDTH\n * @constant\n * @type Number\n * @static\n * The application takes the width of the design resolution size and modifies the height of the internal<br/>\n * canvas so that it fits the aspect ratio of the device<br/>\n * no distortion will occur however you must make sure your application works on different<br/>\n * aspect ratios\n */\ncc.ResolutionPolicy.FIXED_WIDTH = 4;\n\n/**\n * @memberOf cc.ResolutionPolicy#\n * @name UNKNOWN\n * @constant\n * @type Number\n * @static\n * Unknow policy\n */\ncc.ResolutionPolicy.UNKNOWN = 5;\n"]}