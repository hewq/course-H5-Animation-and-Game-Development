{"version":3,"sources":["../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/particle/assets/frameworks/cocos2d-html5/cocos2d/particle/CCPNGReader.js"],"names":["cc","PNGReader","Class","extend","ctor","data","chunkSize","colors","delayDen","delayNum","frame","i","index","key","section","ccshort","text","_i","_j","_ref","pos","palette","imgData","transparency","animation","readUInt32","_results","push","String","fromCharCode","call","join","width","height","bits","colorType","compressionMethod","filterMethod","interlaceMethod","numFrames","numPlays","Infinity","frames","read","xOffset","yOffset","readUInt16","delay","disposeOp","blendOp","indexed","length","grayscale","rgb","indexOf","apply","slice","hasAlphaChannel","pixelBitlength","colorSpace","Uint8Array","Array","Error","bytes","b1","b2","b3","b4","decodePixels","ccbyte","c","col","left","p","pa","paeth","pb","pc","pixelBytes","pixels","row","scanlineLength","upper","upperLeft","_k","_l","_m","inflate","Zlib","Inflate","verify","decompress","Math","floor","abs","copyToImageData","imageData","alpha","input","j","k","v","_decodedPalette","decodePalette","ret","_ref1","render","canvas","ctx","getContext","createImageData","putImageData"],"mappings":"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","file":"CCPNGReader.js","sourceRoot":"../../../../../../../assets/frameworks/cocos2d-html5/cocos2d/particle","sourcesContent":["/****************************************************************************\n Copyright (c) 2011 Devon Govett\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2014 Chukong Technologies Inc.\n\n http://www.cocos2d-x.org\n\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * A png file reader\n * @name cc.tiffReader\n */\ncc.PNGReader = cc.Class.extend({\n    ctor:function(data){\n        var chunkSize, colors, delayDen, delayNum, frame, i, index, key, section, ccshort, text, _i, _j, _ref;\n        this.data = data;\n        this.pos = 8;\n        this.palette = [];\n        this.imgData = [];\n        this.transparency = {};\n        this.animation = null;\n        this.text = {};\n        frame = null;\n        while (true) {\n            chunkSize = this.readUInt32();\n            section = ((function() {\n                var _i, _results;\n                _results = [];\n                for (i = _i = 0; _i < 4; i = ++_i) {\n                    _results.push(String.fromCharCode(this.data[this.pos++]));\n                }\n                return _results;\n            }).call(this)).join('');\n            switch (section) {\n                case 'IHDR':\n                    this.width = this.readUInt32();\n                    this.height = this.readUInt32();\n                    this.bits = this.data[this.pos++];\n                    this.colorType = this.data[this.pos++];\n                    this.compressionMethod = this.data[this.pos++];\n                    this.filterMethod = this.data[this.pos++];\n                    this.interlaceMethod = this.data[this.pos++];\n                    break;\n                case 'acTL':\n                    this.animation = {\n                        numFrames: this.readUInt32(),\n                        numPlays: this.readUInt32() || Infinity,\n                        frames: []\n                    };\n                    break;\n                case 'PLTE':\n                    this.palette = this.read(chunkSize);\n                    break;\n                case 'fcTL':\n                    if (frame) {\n                        this.animation.frames.push(frame);\n                    }\n                    this.pos += 4;\n                    frame = {\n                        width: this.readUInt32(),\n                        height: this.readUInt32(),\n                        xOffset: this.readUInt32(),\n                        yOffset: this.readUInt32()\n                    };\n                    delayNum = this.readUInt16();\n                    delayDen = this.readUInt16() || 100;\n                    frame.delay = 1000 * delayNum / delayDen;\n                    frame.disposeOp = this.data[this.pos++];\n                    frame.blendOp = this.data[this.pos++];\n                    frame.data = [];\n                    break;\n                case 'IDAT':\n                case 'fdAT':\n                    if (section === 'fdAT') {\n                        this.pos += 4;\n                        chunkSize -= 4;\n                    }\n                    data = (frame != null ? frame.data : void 0) || this.imgData;\n                    for (i = _i = 0; 0 <= chunkSize ? _i < chunkSize : _i > chunkSize; i = 0 <= chunkSize ? ++_i : --_i) {\n                        data.push(this.data[this.pos++]);\n                    }\n                    break;\n                case 'tRNS':\n                    this.transparency = {};\n                    switch (this.colorType) {\n                        case 3:\n                            this.transparency.indexed = this.read(chunkSize);\n                            ccshort = 255 - this.transparency.indexed.length;\n                            if (ccshort > 0) {\n                                for (i = _j = 0; 0 <= ccshort ? _j < ccshort : _j > ccshort; i = 0 <= ccshort ? ++_j : --_j) {\n                                    this.transparency.indexed.push(255);\n                                }\n                            }\n                            break;\n                        case 0:\n                            this.transparency.grayscale = this.read(chunkSize)[0];\n                            break;\n                        case 2:\n                            this.transparency.rgb = this.read(chunkSize);\n                    }\n                    break;\n                case 'tEXt':\n                    text = this.read(chunkSize);\n                    index = text.indexOf(0);\n                    key = String.fromCharCode.apply(String, text.slice(0, index));\n                    this.text[key] = String.fromCharCode.apply(String, text.slice(index + 1));\n                    break;\n                case 'IEND':\n                    if (frame) {\n                        this.animation.frames.push(frame);\n                    }\n                    this.colors = (function() {\n                        switch (this.colorType) {\n                            case 0:\n                            case 3:\n                            case 4:\n                                return 1;\n                            case 2:\n                            case 6:\n                                return 3;\n                        }\n                    }).call(this);\n                    this.hasAlphaChannel = (_ref = this.colorType) === 4 || _ref === 6;\n                    colors = this.colors + (this.hasAlphaChannel ? 1 : 0);\n                    this.pixelBitlength = this.bits * colors;\n                    this.colorSpace = (function() {\n                        switch (this.colors) {\n                            case 1:\n                                return 'DeviceGray';\n                            case 3:\n                                return 'DeviceRGB';\n                        }\n                    }).call(this);\n                    if(Uint8Array != Array)\n                        this.imgData = new Uint8Array(this.imgData);\n                    return;\n                default:\n                    this.pos += chunkSize;\n            }\n            this.pos += 4;\n            if (this.pos > this.data.length) {\n                throw new Error(\"Incomplete or corrupt PNG file\");\n            }\n        }\n    },\n    read:function(bytes){\n        var i, _i, _results;\n        _results = [];\n        for (i = _i = 0; 0 <= bytes ? _i < bytes : _i > bytes; i = 0 <= bytes ? ++_i : --_i) {\n            _results.push(this.data[this.pos++]);\n        }\n        return _results;\n    },\n    readUInt32:function(){\n        var b1, b2, b3, b4;\n        b1 = this.data[this.pos++] << 24;\n        b2 = this.data[this.pos++] << 16;\n        b3 = this.data[this.pos++] << 8;\n        b4 = this.data[this.pos++];\n        return b1 | b2 | b3 | b4;\n    },\n    readUInt16:function(){\n        var b1, b2;\n        b1 = this.data[this.pos++] << 8;\n        b2 = this.data[this.pos++];\n        return b1 | b2;\n    },\n    decodePixels:function(data){\n        var ccbyte, c, col, i, left, length, p, pa, paeth, pb, pc, pixelBytes, pixels, pos, row, scanlineLength, upper, upperLeft, _i, _j, _k, _l, _m;\n        if (data == null) {\n            data = this.imgData;\n        }\n        if (data.length === 0) {\n            return new Uint8Array(0);\n        }\n        var inflate = new Zlib.Inflate(data,{index:0, verify:false});\n        data = inflate.decompress();\n\n        pixelBytes = this.pixelBitlength / 8;\n        scanlineLength = pixelBytes * this.width;\n        pixels = new Uint8Array(scanlineLength * this.height);\n        length = data.length;\n        row = 0;\n        pos = 0;\n        c = 0;\n        while (pos < length) {\n            switch (data[pos++]) {\n                case 0:\n                    for (i = _i = 0; _i < scanlineLength; i = _i += 1) {\n                        pixels[c++] = data[pos++];\n                    }\n                    break;\n                case 1:\n                    for (i = _j = 0; _j < scanlineLength; i = _j += 1) {\n                        ccbyte = data[pos++];\n                        left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n                        pixels[c++] = (ccbyte + left) % 256;\n                    }\n                    break;\n                case 2:\n                    for (i = _k = 0; _k < scanlineLength; i = _k += 1) {\n                        ccbyte = data[pos++];\n                        col = (i - (i % pixelBytes)) / pixelBytes;\n                        upper = row && pixels[(row - 1) * scanlineLength + col * pixelBytes + (i % pixelBytes)];\n                        pixels[c++] = (upper + ccbyte) % 256;\n                    }\n                    break;\n                case 3:\n                    for (i = _l = 0; _l < scanlineLength; i = _l += 1) {\n                        ccbyte = data[pos++];\n                        col = (i - (i % pixelBytes)) / pixelBytes;\n                        left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n                        upper = row && pixels[(row - 1) * scanlineLength + col * pixelBytes + (i % pixelBytes)];\n                        pixels[c++] = (ccbyte + Math.floor((left + upper) / 2)) % 256;\n                    }\n                    break;\n                case 4:\n                    for (i = _m = 0; _m < scanlineLength; i = _m += 1) {\n                        ccbyte = data[pos++];\n                        col = (i - (i % pixelBytes)) / pixelBytes;\n                        left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n                        if (row === 0) {\n                            upper = upperLeft = 0;\n                        } else {\n                            upper = pixels[(row - 1) * scanlineLength + col * pixelBytes + (i % pixelBytes)];\n                            upperLeft = col && pixels[(row - 1) * scanlineLength + (col - 1) * pixelBytes + (i % pixelBytes)];\n                        }\n                        p = left + upper - upperLeft;\n                        pa = Math.abs(p - left);\n                        pb = Math.abs(p - upper);\n                        pc = Math.abs(p - upperLeft);\n                        if (pa <= pb && pa <= pc) {\n                            paeth = left;\n                        } else if (pb <= pc) {\n                            paeth = upper;\n                        } else {\n                            paeth = upperLeft;\n                        }\n                        pixels[c++] = (ccbyte + paeth) % 256;\n                    }\n                    break;\n                default:\n                    throw new Error(\"Invalid filter algorithm: \" + data[pos - 1]);\n            }\n            row++;\n        }\n        return pixels;\n    },\n    copyToImageData:function(imageData,pixels){\n        var alpha, colors, data, i, input, j, k, length, palette, v, _ref;\n        colors = this.colors;\n        palette = null;\n        alpha = this.hasAlphaChannel;\n        if (this.palette.length) {\n            palette = (_ref = this._decodedPalette) != null ? _ref : this._decodedPalette = this.decodePalette();\n            colors = 4;\n            alpha = true;\n        }\n        data = imageData.data || imageData;\n        length = data.length;\n        input = palette || pixels;\n        i = j = 0;\n        if (colors === 1) {\n            while (i < length) {\n                k = palette ? pixels[i / 4] * 4 : j;\n                v = input[k++];\n                data[i++] = v;\n                data[i++] = v;\n                data[i++] = v;\n                data[i++] = alpha ? input[k++] : 255;\n                j = k;\n            }\n        } else {\n            while (i < length) {\n                k = palette ? pixels[i / 4] * 4 : j;\n                data[i++] = input[k++];\n                data[i++] = input[k++];\n                data[i++] = input[k++];\n                data[i++] = alpha ? input[k++] : 255;\n                j = k;\n            }\n        }\n    },\n    decodePalette:function(){\n        var c, i, palette, pos, ret, transparency, _i, _ref, _ref1;\n        palette = this.palette;\n        transparency = this.transparency.indexed || [];\n        ret = new Uint8Array((transparency.length || 0) + palette.length);\n        pos = 0;\n        c = 0;\n        for (i = _i = 0, _ref = palette.length; _i < _ref; i = _i += 3) {\n            ret[pos++] = palette[i];\n            ret[pos++] = palette[i + 1];\n            ret[pos++] = palette[i + 2];\n            ret[pos++] = (_ref1 = transparency[c++]) != null ? _ref1 : 255;\n        }\n        return ret;\n    },\n    render: function (canvas) {\n        var ctx, data;\n        canvas.width = this.width;\n        canvas.height = this.height;\n        ctx = canvas.getContext(\"2d\");\n        data = ctx.createImageData(this.width, this.height);\n        this.copyToImageData(data, this.decodePixels());\n        return ctx.putImageData(data, 0, 0);\n\n    }\n});\n\n"]}